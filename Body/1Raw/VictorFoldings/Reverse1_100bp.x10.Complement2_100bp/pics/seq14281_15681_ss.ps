%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Jun 17 13:34:07 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
ACCUCCAUCCUAACCACGACACCCACUUUCUCAUACUACCCCACCACCAACACCAUUUGAAAUUAUCACAUCCUUCGACUUAUUAAAUACUUCCUCUCCCxxxxxxxxxxUGUUUCGUAUUAUAAAGCGGGUGAUUCGGUUAGUGAAAUAACUGAGGAUCGGCGUCUGGAGGAGUAAGAUUGGACUUAGCCUCCUGUUGGUCAUUCGAUG\
) } def
/len { sequence length } bind def

/coor [
[233.17117310 277.20523071]
[244.66217041 267.51943970]
[236.81040955 254.73858643]
[228.95866394 241.95774841]
[221.10690308 229.17691040]
[213.25514221 216.39605713]
[205.40339661 203.61521912]
[195.74258423 192.14051819]
[184.48648071 182.22587585]
[173.15689087 172.39529419]
[161.75442505 162.64932251]
[150.35197449 152.90336609]
[138.94950867 143.15739441]
[127.54704285 133.41142273]
[116.14458466 123.66545868]
[102.18415833 128.56451416]
[87.64118195 125.84494781]
[76.39450073 116.23213196]
[71.44377899 102.28994751]
[74.10945129 87.73699951]
[62.70698929 77.99103546]
[51.30452728 68.24507141]
[39.90206528 58.49910355]
[28.49960327 48.75313950]
[12.98204136 45.66835785]
[8.33438969 31.51743317]
[-3.06807280 21.77146912]
[-14.47053528 12.02550316]
[-25.87299728 2.27953696]
[-40.88354111 5.74215794]
[-54.89103317 -0.22806677]
[-62.60586929 -13.14879894]
[-61.24935532 -27.95750809]
[-72.65181732 -37.70347595]
[-84.05428314 -47.44944000]
[-95.45674133 -57.19540405]
[-106.05200958 -46.56699371]
[-117.42978668 -36.78083038]
[-129.52330017 -27.89435005]
[-142.26159668 -19.95969963]
[-155.56990051 -13.02344418]
[-169.37013245 -7.12628841]
[-183.58129883 -2.30283928]
[-198.11999512 1.41859615]
[-212.90089417 4.01617908]
[-227.83728027 5.47466564]
[-242.84149170 5.78549671]
[-257.82546997 4.94684839]
[-272.70126343 2.96364188]
[-287.38162231 -0.15248422]
[-301.78033447 -4.38324308]
[-315.81295776 -9.70380592]
[-329.39712524 -16.08295059]
[-342.45309448 -23.48324013]
[-354.90426636 -31.86124802]
[-366.67758179 -41.16780472]
[-377.70391846 -51.34829712]
[-387.91857910 -62.34298325]
[-397.26165771 -74.08733368]
[-405.67828369 -86.51244354]
[-413.11907959 -99.54537201]
[-419.54037476 -113.10965729]
[-424.90447998 -127.12568665]
[-429.17990112 -141.51121521]
[-432.34161377 -156.18180847]
[-434.37097168 -171.05139160]
[-435.25616455 -186.03268433]
[-434.99191284 -201.03778076]
[-433.57980347 -215.97862244]
[-431.02813721 -230.76753235]
[-427.35183716 -245.31770325]
[-422.57254028 -259.54376221]
[-416.71826172 -273.36224365]
[-409.82336426 -286.69201660]
[-401.92828369 -299.45489502]
[-393.07940674 -311.57595825]
[-383.32861328 -322.98403931]
[-372.73315430 -333.61227417]
[-361.35519409 -343.39819336]
[-349.26150513 -352.28445435]
[-336.52307129 -360.21887207]
[-323.21463013 -367.15487671]
[-309.41427612 -373.05175781]
[-295.20303345 -377.87493896]
[-280.66427612 -381.59609985]
[-265.88330078 -384.19342041]
[-250.94688416 -385.65161133]
[-235.94268799 -385.96215820]
[-220.95872498 -385.12322998]
[-206.08296204 -383.13973999]
[-191.40266418 -380.02334595]
[-177.00401306 -375.79229736]
[-162.97149658 -370.47146606]
[-149.38746643 -364.09207153]
[-136.33163452 -356.69152832]
[-123.88062286 -348.31329346]
[-112.10749054 -339.00650024]
[-101.08133698 -328.82580566]
[-90.86686707 -317.83093262]
[-81.52402496 -306.08639526]
[-73.10763550 -293.66113281]
[-65.66709137 -280.62805176]
[-59.24605942 -267.06365967]
[-53.88221741 -253.04751587]
[-49.60704803 -238.66191101]
[-46.44563675 -223.99125671]
[-44.41653442 -209.12164307]
[-43.53165054 -194.14031982]
[-43.79618073 -179.13523865]
[-45.20856857 -164.19442749]
[-47.76052856 -149.40556335]
[-51.43708420 -134.85545349]
[-56.21665573 -120.62947845]
[-62.07119751 -106.81111908]
[-68.96635437 -93.48146820]
[-76.86165619 -80.71875000]
[-85.71077728 -68.59786987]
[-74.30831909 -58.85190201]
[-62.90585327 -49.10593796]
[-51.50339127 -39.35997009]
[-37.08648682 -43.00564194]
[-23.12213707 -37.39664078]
[-15.04376793 -24.48953629]
[-16.12703323 -9.12292576]
[-4.72456980 0.62304014]
[6.67789268 10.36900616]
[18.08035469 20.11497116]
[32.78233719 22.50265694]
[38.24556732 37.35067749]
[49.64802933 47.09664154]
[61.05049133 56.84260559]
[72.45295715 66.58856964]
[83.85541534 76.33454132]
[97.81584167 71.43549347]
[112.35881805 74.15505219]
[123.60549927 83.76786804]
[128.55621338 97.71005249]
[125.89054871 112.26300049]
[137.29301453 122.00896454]
[148.69546509 131.75492859]
[160.09793091 141.50090027]
[171.50039673 151.24685669]
[182.90286255 160.99282837]
[191.45959473 164.18972778]
[194.40113831 170.96977234]
[205.65724182 180.88442993]
[200.15179443 166.93128967]
[198.74305725 151.99758911]
[201.54211426 137.26104736]
[208.32823181 123.88388062]
[218.56620789 112.92105103]
[231.44865417 105.23712921]
[245.95959473 101.43810272]
[260.95465088 101.82358551]
[275.25122070 106.36317444]
[287.72183228 114.69885254]
[297.38302612 126.17323303]
[303.47283936 139.88140869]
[305.51104736 154.74229431]
[303.33685303 169.58389282]
[297.12176514 183.23573303]
[287.35592651 194.62117004]
[274.80950928 202.84231567]
[260.47195435 207.25079346]
[245.47401428 207.49896240]
[230.99845886 203.56723022]
[218.18423462 195.76347351]
[226.03599548 208.54431152]
[233.88774109 221.32514954]
[241.73950195 234.10598755]
[249.59126282 246.88684082]
[257.44302368 259.66769409]
[271.27685547 253.79547119]
[285.83139038 250.05078125]
[300.78152466 248.51725769]
[315.79321289 249.22915649]
[330.53109741 252.17059326]
[344.66595459 257.27584839]
[357.88198853 264.43084717]
[369.88394165 273.47576904]
[380.40371704 284.20852661]
[389.20626831 296.38934326]
[396.09494019 309.74612427]
[400.91586304 323.98046875]
[403.56134033 338.77438354]
[403.97222900 353.79730225]
[402.13937378 368.71368408]
[398.10372925 383.19027710]
[391.95541382 396.90362549]
[383.83184814 409.54739380]
[373.91448975 420.83914185]
[362.42486572 430.52658081]
[349.61968994 438.39328003]
[335.78500366 444.26351929]
[321.22991943 448.00613403]
[306.27960205 449.53753662]
[291.26800537 448.82348633]
[276.53051758 445.87994385]
[262.39639282 440.77270508]
[249.18138123 433.61581421]
[237.18070984 424.56918335]
[226.66247559 413.83493042]
[217.86166382 401.65283203]
[210.97488403 388.29507446]
[206.15599060 374.06005859]
[203.51263428 359.26577759]
[203.10388184 344.24276733]
[204.93885803 329.32666016]
[208.97657776 314.85064697]
[215.12681580 301.13818359]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[2 172]
[3 171]
[4 170]
[5 169]
[6 168]
[7 167]
[8 146]
[9 145]
[10 143]
[11 142]
[12 141]
[13 140]
[14 139]
[15 138]
[20 133]
[21 132]
[22 131]
[23 130]
[24 129]
[26 127]
[27 126]
[28 125]
[29 124]
[33 120]
[34 119]
[35 118]
[36 117]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
