%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Jun 17 13:34:15 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
AGGAGGAGGCCGCCCCAGCUUCUUCCACCACAACUCCAACGCCAGACAAUCAUCAUAUCACUACGGUCGUCGAUCCUGACCCUCUCUAUCCUCUUCAUCCxxxxxxxxxxCUCCCAGAAUGAGAAAAUCAUAUUUAUCAUGGCAAUUGAAGGUUAAUUGAUCAAAACUGUUGUAAGUUUUUUCUCAUUAUUUGAAGCGGAAUUAAAAUUA\
) } def
/len { sequence length } bind def

/coor [
[79.32389832 373.21932983]
[67.33670044 364.04275513]
[58.27075577 351.97164917]
[52.79881668 337.90182495]
[51.32693863 322.87728882]
[53.96434021 308.01303101]
[60.51531219 294.41201782]
[70.49372864 283.08355713]
[83.15912628 274.86831665]
[97.57164764 270.37591553]
[97.12504578 255.38255310]
[96.67843628 240.38920593]
[96.23183441 225.39585876]
[85.24849701 215.40075684]
[84.58199310 200.20172119]
[95.14023590 188.74916077]
[94.69363403 173.75581360]
[80.36833191 171.29289246]
[66.80157471 166.07528687]
[54.51757050 158.30461121]
[43.99095154 148.28109741]
[35.62845993 136.39207458]
[29.75321007 123.09690094]
[26.59221458 108.90928650]
[26.26761246 94.37742615]
[28.79194450 80.06282043]
[34.06767273 66.51856232]
[41.89095306 54.26799011]
[51.95949936 43.78444672]
[63.88427353 35.47300720]
[77.20452118 29.65481949]
[91.40555573 26.55468941]
[91.18222809 11.55635071]
[90.95890045 -3.44198632]
[90.73557281 -18.44032288]
[80.92776489 -34.02519989]
[90.06644440 -49.00690079]
[89.61984253 -64.00025177]
[89.17323303 -78.99359894]
[88.72663116 -93.98695374]
[85.51335907 -108.63874054]
[79.64439392 -122.44291687]
[73.77543640 -136.24710083]
[67.90647125 -150.05126953]
[53.74640656 -145.08624268]
[39.29465103 -141.04821777]
[24.61182213 -137.95413208]
[9.75950336 -135.81694031]
[-5.20000601 -134.64562988]
[-20.20396233 -134.44509888]
[-35.18943405 -135.21620178]
[-50.09356308 -136.95568848]
[-64.85383606 -139.65628052]
[-79.40834808 -143.30664062]
[-93.69604492 -147.89146423]
[-107.65700531 -153.39151001]
[-121.23266602 -159.78372192]
[-134.36608887 -167.04127502]
[-147.00219727 -175.13372803]
[-159.08796692 -184.02716064]
[-170.57272339 -193.68424988]
[-181.40827942 -204.06448364]
[-191.54920959 -215.12434387]
[-200.95295715 -226.81744385]
[-209.58010864 -239.09471130]
[-217.39443970 -251.90466309]
[-224.36320496 -265.19357300]
[-230.45715332 -278.90573120]
[-235.65074158 -292.98355103]
[-239.92218018 -307.36804199]
[-243.25354004 -321.99887085]
[-245.63087463 -336.81463623]
[-247.04418945 -351.75323486]
[-247.48756409 -366.75198364]
[-246.95913696 -381.74798584]
[-245.46113586 -396.67831421]
[-242.99981689 -411.48037720]
[-239.58554077 -426.09207153]
[-235.23260498 -440.45208740]
[-229.95927429 -454.50027466]
[-223.78765869 -468.17761230]
[-216.74365234 -481.42678833]
[-208.85679626 -494.19223022]
[-200.16017151 -506.42037964]
[-190.69026184 -518.05993652]
[-180.48677063 -529.06213379]
[-169.59251404 -539.38079834]
[-158.05319214 -548.97259521]
[-145.91717529 -557.79730225]
[-133.23538208 -565.81799316]
[-120.06101990 -573.00097656]
[-106.44932556 -579.31610107]
[-92.45740509 -584.73687744]
[-78.14393616 -589.24060059]
[-63.56895447 -592.80834961]
[-48.79360199 -595.42517090]
[-33.87984848 -597.08013916]
[-18.89024734 -597.76623535]
[-3.88766956 -597.48065186]
[11.06495762 -596.22448730]
[25.90491676 -594.00311279]
[40.56996536 -590.82580566]
[54.99858856 -586.70593262]
[69.13027191 -581.66064453]
[82.90573883 -575.71124268]
[96.26721191 -568.88262939]
[109.15864563 -561.20349121]
[121.52597046 -552.70593262]
[133.31730652 -543.42565918]
[144.48321533 -533.40161133]
[154.97683716 -522.67584229]
[164.75418091 -511.29327393]
[173.77421570 -499.30169678]
[181.99913025 -486.75140381]
[189.39440918 -473.69503784]
[195.92903137 -460.18734741]
[201.57560730 -446.28500366]
[206.31044006 -432.04632568]
[210.11366272 -417.53100586]
[212.96934509 -402.79995728]
[214.86549377 -387.91494751]
[215.79414368 -372.93841553]
[215.75143433 -357.93316650]
[214.73751831 -342.96218872]
[212.75665283 -328.08819580]
[209.81713867 -313.37365723]
[205.93133545 -298.88021851]
[201.11550903 -284.66873169]
[195.38986206 -270.79873657]
[188.77844238 -257.32849121]
[181.30894470 -244.31443787]
[173.01271057 -231.81118774]
[163.92453003 -219.87117004]
[154.08255005 -208.54446411]
[143.52801514 -197.87858582]
[132.30522156 -187.91827393]
[120.46124268 -178.70530701]
[108.04573059 -170.27832031]
[95.11078644 -162.67265320]
[81.71064758 -155.92022705]
[87.57961273 -142.11605835]
[93.44857025 -128.31187439]
[99.31753540 -114.50769806]
[100.16352844 -129.48382568]
[104.39485931 -143.87464905]
[111.78955078 -156.92526245]
[121.95970154 -167.95104980]
[134.37179565 -176.37364197]
[148.37472534 -181.75117493]
[163.23393250 -183.80155945]
[178.16992188 -182.41726685]
[192.39916992 -177.67088318]
[205.17527771 -169.81140137]
[215.82798767 -159.25112915]
[223.79852295 -146.54400635]
[228.66873169 -132.35665894]
[230.18315125 -117.43330383]
[228.26234436 -102.55679321]
[223.00704956 -88.50753021]
[214.69296265 -76.02249908]
[203.75622559 -65.75663757]
[190.77055359 -58.24848938]
[176.41716003 -53.89189911]
[161.44897461 -52.91541290]
[146.65121460 -55.37025452]
[132.80014038 -61.12764740]
[120.62233734 -69.88557434]
[110.75663757 -81.18460083]
[103.71997833 -94.43355560]
[104.16658783 -79.44020844]
[104.61318970 -64.44686127]
[105.05979919 -49.45351028]
[113.64624786 -40.93297958]
[114.14102936 -28.44542694]
[105.73390961 -18.66365051]
[105.95723724 -3.66531396]
[106.18056488 11.33302307]
[106.40389252 26.33136177]
[121.53682709 29.25932312]
[135.73402405 35.26084900]
[148.37864685 44.07518005]
[158.92127991 55.31934738]
[166.90390015 68.50481415]
[171.97966003 83.05869293]
[173.92800903 98.34864807]
[172.66432190 113.71034241]
[168.24349976 128.47634888]
[160.85760498 142.00511169]
[150.82756042 153.70881653]
[138.58914185 163.07896423]
[124.67408752 169.70845032]
[109.68698120 173.30921936]
[110.13359070 188.30256653]
[121.35478973 199.10638428]
[121.59412384 214.31813049]
[111.22518158 224.94924927]
[111.67179108 239.94259644]
[112.11839294 254.93594360]
[112.56500244 269.92929077]
[127.21936035 273.55590820]
[140.35128784 281.00271606]
[150.98629761 291.71716309]
[158.33518982 304.90414429]
[161.85266113 319.58508301]
[161.27766418 334.67056274]
[156.65287781 349.04116821]
[148.32148743 361.63046265]
[136.90174866 371.50427246]
[123.24106598 377.92987061]
[108.35316467 380.43045044]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[10 199]
[11 198]
[12 197]
[13 196]
[16 193]
[17 192]
[32 178]
[33 177]
[34 176]
[35 175]
[37 172]
[38 171]
[39 170]
[40 169]
[41 143]
[42 142]
[43 141]
[44 140]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
