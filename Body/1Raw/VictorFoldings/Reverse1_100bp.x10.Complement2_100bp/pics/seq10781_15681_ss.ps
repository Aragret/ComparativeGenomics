%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Jun 17 13:35:39 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
UUAUCAUCUCCCUACUACGAUUAUUAAUCCGACACCCACCAACACAACUAAGUUUAAUACACAAAAAACCUUUCAGUACAGUCACCAUCAUUAUAUUAACxxxxxxxxxxUGUUUCGUAUUAUAAAGCGGGUGAUUCGGUUAGUGAAAUAACUGAGGAUCGGCGUCUGGAGGAGUAAGAUUGGACUUAGCCUCCUGUUGGUCAUUCGAUG\
) } def
/len { sequence length } bind def

/coor [
[-15.79252815 755.39093018]
[-21.43086815 769.31347656]
[-28.80334091 782.40069580]
[-37.78888321 794.43762207]
[-48.23994827 805.22668457]
[-59.98491669 814.59069824]
[-72.83092499 822.37579346]
[-86.56703186 828.45428467]
[-100.96767426 832.72625732]
[-115.79638672 835.12158203]
[-130.80966187 835.60095215]
[-145.76098633 834.15643311]
[-160.40481567 830.81182861]
[-174.50070190 825.62200928]
[-187.81718445 818.67218018]
[-200.13557434 810.07653809]
[-211.25361633 799.97613525]
[-220.98872375 788.53692627]
[-229.18104553 775.94671631]
[-235.69606018 762.41217041]
[-240.42677307 748.15563965]
[-243.29550171 733.41119385]
[-244.25515747 718.42095947]
[-243.28996277 703.43109131]
[-240.41578674 688.68768311]
[-235.67979431 674.43292236]
[-229.15979004 660.90081787]
[-220.96281433 648.31359863]
[-211.22348022 636.87792969]
[-200.10171509 626.78167725]
[-187.78013611 618.19061279]
[-174.46109009 611.24572754]
[-160.36328125 606.06109619]
[-145.71821594 602.72186279]
[-130.76637268 601.28289795]
[-115.75326538 601.76782227]
[-100.92543793 604.16864014]
[-86.52637482 608.44592285]
[-80.45254517 594.73065186]
[-74.37870789 581.01538086]
[-68.30487061 567.30010986]
[-62.23104095 553.58483887]
[-56.15720749 539.86956787]
[-50.08337021 526.15435791]
[-59.64432907 511.30645752]
[-58.36715317 493.53512573]
[-46.57493973 479.96960449]
[-28.84683800 476.16537476]
[-23.18405151 462.27536011]
[-17.52126503 448.38531494]
[-11.85847855 434.49530029]
[-6.19569206 420.60528564]
[-0.53290540 406.71524048]
[5.12988138 392.82522583]
[10.79266739 378.93518066]
[16.45545387 365.04516602]
[22.11824036 351.15515137]
[27.78102684 337.26510620]
[16.38962173 328.56552124]
[7.63419247 317.20166016]
[2.11782885 303.94595337]
[0.22317606 289.70159912]
[2.08589721 275.44076538]
[7.58497953 262.13851929]
[16.35057640 250.70593262]
[27.78887558 241.92785645]
[41.12231827 236.40893555]
[55.44247055 234.53196716]
[69.77188873 236.43144226]
[75.64085388 222.62727356]
[79.50515747 208.13357544]
[81.28762054 193.23985291]
[83.07009125 178.34614563]
[84.85255432 163.45242310]
[86.63501740 148.55870056]
[80.46493530 135.00218201]
[89.78730774 122.21922302]
[91.56977081 107.32550812]
[93.24131012 92.41893005]
[86.98169708 77.88869476]
[96.00109100 66.03543091]
[97.33932495 51.09524918]
[98.45497131 36.13679504]
[99.57061768 21.17834282]
[100.68627167 6.21988869]
[101.80191803 -8.73856449]
[91.76558685 -20.65115356]
[93.11009979 -35.80525970]
[104.52878571 -45.29995728]
[97.83932495 -59.63737869]
[106.50180054 -71.75392914]
[107.61745453 -86.71237946]
[108.73310089 -101.67082977]
[109.84874725 -116.62928772]
[110.96440125 -131.58773804]
[96.59769440 -136.13685608]
[83.66765594 -143.87705994]
[72.87158203 -154.39094543]
[64.79169464 -167.11148071]
[59.86372757 -181.35267639]
[58.35344696 -196.34654236]
[60.34229660 -211.28445435]
[65.72301483 -225.36083984]
[74.20543671 -237.81657410]
[85.33210754 -247.97993469]
[98.50298309 -255.30281067]
[113.00778198 -259.39031982]
[128.06427002 -260.02200317]
[142.86045837 -257.16381836]
[156.59843445 -250.96987915]
[168.53730774 -241.77421570]
[178.03321838 -230.07276917]
[184.57409668 -216.49655151]
[187.80718994 -201.77772522]
[187.55812073 -186.71005249]
[183.84034729 -172.10610962]
[176.85433960 -158.75349426]
[166.97686768 -147.37226868]
[154.74060059 -138.57621765]
[140.80543518 -132.83970642]
[125.92285156 -130.47209167]
[124.80720520 -115.51363373]
[123.69155121 -100.55518341]
[122.57590485 -85.59673309]
[121.46025848 -70.63827515]
[128.22952271 -57.37078094]
[119.48723602 -44.18430710]
[129.37112427 -33.10079575]
[128.45278931 -17.91490555]
[116.76037598 -7.62291622]
[115.64472198 7.33553743]
[114.52907562 22.29399109]
[113.41342926 37.25244522]
[112.29777527 52.21089935]
[114.68019867 56.35011292]
[114.48768616 62.02989960]
[110.91969299 67.59595490]
[117.29093170 81.05911255]
[108.15991211 93.97945404]
[110.52009583 101.68672943]
[106.46348572 109.10797119]
[104.68102264 124.00168610]
[110.72360992 138.62350464]
[101.52873993 150.34117126]
[99.74626923 165.23489380]
[97.96380615 180.12860107]
[96.18134308 195.02232361]
[94.39887238 209.91604614]
[102.84149170 197.51756287]
[114.52598572 188.11157227]
[128.44152832 182.51179504]
[143.38429260 181.20265198]
[158.06156921 184.29739380]
[171.20364380 191.52830505]
[181.67356873 202.26983643]
[188.56561279 215.59272766]
[191.28355408 230.34443665]
[189.59222412 245.24877930]
[183.63798523 259.01638794]
[173.93589783 270.45620728]
[161.32531738 278.57861328]
[146.89718628 282.68090820]
[131.89965820 282.40820312]
[117.63019562 277.78411865]
[105.32323456 269.20864868]
[96.04345703 257.42367554]
[90.59364319 243.44869995]
[89.44503021 228.49623108]
[83.57606506 242.30039978]
[95.76663208 252.23666382]
[104.65903473 265.19073486]
[109.54084015 280.11032104]
[110.02500153 295.78631592]
[106.08055115 310.95062256]
[98.03439331 324.37893677]
[86.54427338 334.98947144]
[72.54499054 341.93005371]
[57.17235947 344.64675903]
[41.67105484 342.92788696]
[36.00826645 356.81793213]
[30.34548187 370.70794678]
[24.68269539 384.59799194]
[19.01990891 398.48800659]
[13.35712147 412.37802124]
[7.69433498 426.26806641]
[2.03154826 440.15808105]
[-3.63123822 454.04812622]
[-9.29402447 467.93814087]
[-14.95681190 481.82815552]
[-7.02305651 491.48855591]
[-3.96714926 503.53555298]
[-6.30953264 515.66784668]
[-13.54543304 525.59472656]
[-24.25207710 531.46844482]
[-36.36810684 532.22814941]
[-42.44194031 545.94342041]
[-48.51577377 559.65869141]
[-54.58960724 573.37396240]
[-60.66344070 587.08923340]
[-66.73727417 600.80450439]
[-72.81111145 614.51977539]
[-59.96658325 622.30737305]
[-48.22340393 631.67358398]
[-37.77439499 642.46459961]
[-28.79114723 654.50329590]
[-21.42117119 667.59191895]
[-15.78548622 681.51550293]
[-11.97663689 696.04553223]
[-10.05716896 710.94329834]
[-10.05860138 725.96423340]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[38 201]
[39 200]
[40 199]
[41 198]
[42 197]
[43 196]
[44 195]
[48 189]
[49 188]
[50 187]
[51 186]
[52 185]
[53 184]
[54 183]
[55 182]
[56 181]
[57 180]
[58 179]
[69 169]
[70 168]
[71 148]
[72 147]
[73 146]
[74 145]
[75 144]
[77 142]
[78 141]
[79 139]
[81 137]
[82 134]
[83 133]
[84 132]
[85 131]
[86 130]
[89 127]
[91 125]
[92 124]
[93 123]
[94 122]
[95 121]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
