%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Jun 17 13:31:28 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
AGGAGGAGGCCGCCCCAGCUUCUUCCACCACAACUCCAACGCCAGACAAUCAUCAUAUCACUACGGUCGUCGAUCCUGACCCUCUCUAUCCUCUUCAUCCxxxxxxxxxxCGCUACAUUGUGCUCUUUCGUGUAUGGUUCCGGUGGUGUGUGGUGGACAGGUUUUUCCGGAAGCUAUGCCCUAUUAGGAUAAAUAAUGGAGUCUUCAAAA\
) } def
/len { sequence length } bind def

/coor [
[156.79534912 483.75592041]
[160.14260864 469.09631348]
[165.91934204 455.21331787]
[173.95938110 442.50640869]
[184.03135681 431.34115601]
[195.84552002 422.03878784]
[209.06192017 414.86700439]
[204.23591614 400.66455078]
[199.40992737 386.46206665]
[195.59790039 383.58499146]
[193.55278015 378.28268433]
[194.65852356 371.76434326]
[190.25752258 357.42449951]
[178.14134216 353.03955078]
[170.65119934 342.31671143]
[170.70530701 329.04238892]
[178.50796509 318.06362915]
[174.32095337 303.65985107]
[170.13394165 289.25607300]
[165.94692993 274.85229492]
[161.75991821 260.44851685]
[157.57292175 246.04472351]
[153.38591003 231.64094543]
[148.03471375 217.62791443]
[141.55522156 204.09957886]
[135.07572937 190.57122803]
[128.59623718 177.04287720]
[122.11673737 163.51454163]
[115.63723755 149.98619080]
[109.15774536 136.45783997]
[102.67824554 122.92949677]
[96.19875336 109.40115356]
[90.15337372 104.06955719]
[89.72517395 95.62281036]
[76.92275238 86.32719421]
[78.62368774 71.53002930]
[72.34632874 57.90671158]
[66.06896210 44.28339386]
[53.26654053 34.98777771]
[54.96747589 20.19061089]
[48.69011307 6.56729555]
[42.11008835 -6.91243887]
[35.23067474 -20.24186707]
[28.35126305 -33.57129669]
[15.14653683 -42.28598785]
[16.18504715 -57.14434433]
[9.30563450 -70.47377014]
[2.42622161 -83.80319977]
[-11.38644314 -77.93613434]
[-25.59893417 -73.11769867]
[-40.13176727 -69.37483978]
[-54.90366745 -66.72849274]
[-69.83202362 -65.19346619]
[-84.83335876 -64.77832794]
[-99.82376099 -65.48541260]
[-114.71940613 -67.31075287]
[-129.43699646 -70.24415588]
[-143.89421082 -74.26920319]
[-158.01020813 -79.36339569]
[-171.70605469 -85.49823761]
[-184.90513611 -92.63942719]
[-197.53363037 -100.74701691]
[-209.52095032 -109.77566528]
[-220.80001831 -119.67489624]
[-231.30778503 -130.38932800]
[-240.98547363 -141.85905457]
[-249.77896118 -154.01992798]
[-257.63906860 -166.80393982]
[-264.52182007 -180.13958740]
[-270.38879395 -193.95231628]
[-275.20709229 -208.16484070]
[-278.94982910 -222.69770813]
[-281.59603882 -237.46963501]
[-283.13095093 -252.39801025]
[-283.54592896 -267.39935303]
[-282.83871460 -282.38973999]
[-281.01324463 -297.28536987]
[-278.07971191 -312.00292969]
[-274.05453491 -326.46011353]
[-268.96023560 -340.57608032]
[-262.82525635 -354.27185059]
[-255.68395996 -367.47085571]
[-247.57626343 -380.09930420]
[-238.54750061 -392.08654785]
[-228.64817810 -403.36550903]
[-217.93363953 -413.87319946]
[-206.46383667 -423.55078125]
[-194.30288696 -432.34414673]
[-181.51879883 -440.20413208]
[-168.18309021 -447.08679199]
[-154.37031555 -452.95361328]
[-140.15774536 -457.77182007]
[-125.62484741 -461.51440430]
[-110.85289764 -464.16049194]
[-95.92451477 -465.69525146]
[-80.92317200 -466.11013794]
[-65.93278503 -465.40280151]
[-51.03716660 -463.57717896]
[-36.31962967 -460.64352417]
[-21.86248398 -456.61822510]
[-7.74657393 -451.52377319]
[5.94915390 -445.38870239]
[19.14810753 -438.24728394]
[31.77647209 -430.13946533]
[43.76362228 -421.11059570]
[55.04252243 -411.21118164]
[65.55009460 -400.49655151]
[75.22757721 -389.02664185]
[84.02085114 -376.86563110]
[91.88072968 -364.08148193]
[98.76326752 -350.74569702]
[104.62997437 -336.93289185]
[109.44803619 -322.72027588]
[113.19050598 -308.18731689]
[115.83645630 -293.41537476]
[117.37109375 -278.48696899]
[117.78583527 -263.48562622]
[117.07835388 -248.49523926]
[115.25261688 -233.59963989]
[112.31883240 -218.88212585]
[108.29339600 -204.42501831]
[103.19882965 -190.30914307]
[97.06362915 -176.61347961]
[89.92208862 -163.41458130]
[81.81417084 -150.78628540]
[72.78519440 -138.79922485]
[62.88567352 -127.52040863]
[52.17095947 -117.01293182]
[40.70097351 -107.33554840]
[28.53986931 -98.54238129]
[15.75565052 -90.68261719]
[22.63506317 -77.35318756]
[29.51447678 -64.02375793]
[42.22713852 -56.26247787]
[41.68069077 -40.45071030]
[48.56010437 -27.12128067]
[55.43951797 -13.79185104]
[58.66925812 -12.37724972]
[61.37429047 -9.32800961]
[62.79378128 -4.90779018]
[62.31343079 0.28993490]
[68.59078979 13.91325092]
[80.94421387 22.23443985]
[79.69228363 38.00603485]
[85.96964264 51.62935257]
[92.24700165 65.25267029]
[104.60042572 73.57385254]
[103.34848785 89.34545135]
[109.72709656 102.92166138]
[116.20658875 116.45000458]
[122.68608856 129.97834778]
[129.16558838 143.50669861]
[135.64508057 157.03503418]
[142.12457275 170.56338501]
[148.60406494 184.09173584]
[155.08357239 197.62007141]
[161.56306458 211.14842224]
[163.83995056 196.32223511]
[172.67166138 184.19784546]
[186.08518982 177.48388672]
[201.08390808 177.68025208]
[214.31706238 184.74308777]
[222.82833862 197.09454346]
[224.71627808 211.97525024]
[219.55914307 226.06083679]
[208.50901794 236.20455933]
[194.03454590 240.14025879]
[179.36935425 236.98869324]
[167.78968811 227.45393372]
[171.97669983 241.85771179]
[176.16371155 256.26150513]
[180.35072327 270.66528320]
[184.53773499 285.06906128]
[188.72474670 299.47283936]
[192.91175842 313.87661743]
[208.39430237 322.01971436]
[213.10453796 338.51602173]
[204.59736633 353.02349854]
[208.99836731 367.36334229]
[213.61238098 381.63607788]
[218.43838501 395.83853149]
[223.26437378 410.04098511]
[238.11410522 407.67590332]
[253.14993286 407.85464478]
[267.93923950 410.57202148]
[282.05651855 415.74987793]
[295.09561157 423.23925781]
[306.68130493 432.82464600]
[316.48028564 444.23025513]
[324.21060181 457.12792969]
[329.64987183 471.14657593]
[332.64157104 485.88284302]
[333.09960938 500.91275024]
[331.01083374 515.80383301]
[326.43533325 530.12768555]
[319.50476074 543.47216797]
[310.41851807 555.45336914]
[299.43801880 565.72644043]
[286.87921143 573.99591064]
[273.10342407 580.02386475]
[258.50704956 583.63677979]
[243.50999451 584.73077393]
[228.54380798 583.27441406]
[214.03906250 579.30944824]
[200.41311646 572.95007324]
[188.05799866 564.37927246]
[177.32919312 553.84356689]
[168.53540039 541.64617920]
[161.92961121 528.13793945]
[157.70190430 513.70764160]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[7 182]
[8 181]
[9 180]
[12 179]
[13 178]
[17 175]
[18 174]
[19 173]
[20 172]
[21 171]
[22 170]
[23 169]
[24 157]
[25 156]
[26 155]
[27 154]
[28 153]
[29 152]
[30 151]
[31 150]
[32 149]
[34 148]
[36 146]
[37 145]
[38 144]
[40 142]
[41 141]
[42 137]
[43 136]
[44 135]
[46 133]
[47 132]
[48 131]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
