%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Jun 17 13:35:27 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
UGACGACACUAAUCCUGCCUAGUCUGCUUCUCCCCGCAAACCAUAACCCAAUACCGUCCCCCAAAAUAUAACUAUUAACAACACUACUUUAACUACCGGGxxxxxxxxxxGAUGACCCUCUUGAGAGACACGAUCAUUGGUGCAAGAGGACUAGUUUAUAGUGAGAGGAUGAAUGUCCUGAGUUGUAUGAUCAGUGUCGGGAUAUGAGGG\
) } def
/len { sequence length } bind def

/coor [
[149.14486694 438.89855957]
[154.26799011 424.61157227]
[164.20916748 413.14257812]
[177.62394714 406.04272461]
[175.84147644 391.14898682]
[174.05902100 376.25527954]
[172.27655029 361.36157227]
[170.49407959 346.46783447]
[168.71162415 331.57412720]
[166.92915344 316.68041992]
[157.73428345 304.96273804]
[163.77687073 290.34091187]
[161.99440002 275.44720459]
[160.21194458 260.55349731]
[151.01705933 248.83583069]
[157.05964661 234.21400452]
[155.27719116 219.32029724]
[153.49472046 204.42657471]
[148.45780945 190.29754639]
[140.41662598 177.63502502]
[132.37545776 164.97248840]
[124.33428955 152.30996704]
[116.29311371 139.64744568]
[108.25193787 126.98491669]
[100.21076965 114.32239532]
[87.90818024 107.67875671]
[87.12670898 93.71878052]
[79.08553314 81.05625153]
[71.04436493 68.39373016]
[66.72800446 82.75927734]
[53.58378220 89.98627472]
[39.14130402 85.93476105]
[31.67387390 72.92562866]
[35.45917892 58.41110229]
[48.32881927 50.70575714]
[62.90971756 54.22301483]
[56.03030396 40.89358521]
[49.15089035 27.56415749]
[46.26376343 42.28368378]
[35.95405197 53.17908859]
[21.41633224 56.87431335]
[7.15527248 52.22434616]
[-2.41018081 40.67003632]
[-4.31606817 25.79160690]
[2.02817082 12.19930649]
[14.65670395 4.10485506]
[29.65644264 4.01640558]
[42.37972641 11.96155834]
[37.34281158 -2.16747117]
[32.30589676 -16.29650116]
[27.26898003 -30.42552948]
[22.23206329 -44.55456161]
[6.29227209 -51.76166534]
[0.60851419 -67.94837952]
[8.23709774 -82.93649292]
[2.99037957 -96.98896790]
[-2.25633860 -111.04143524]
[-16.71182632 -107.00253296]
[-31.45776176 -104.20410156]
[-46.38790131 -102.66630554]
[-61.39466476 -102.40022278]
[-76.36993408 -103.40777588]
[-91.20581055 -105.68169403]
[-105.79538727 -109.20560455]
[-120.03356171 -113.95410919]
[-133.81773376 -119.89300537]
[-147.04858398 -126.97949219]
[-159.63079834 -135.16250610]
[-171.47370911 -144.38310242]
[-182.49198914 -154.57484436]
[-192.60623169 -165.66427612]
[-201.74359131 -177.57153320]
[-209.83822632 -190.21078491]
[-216.83180237 -203.49099731]
[-222.67391968 -217.31645203]
[-227.32252502 -231.58755493]
[-230.74407959 -246.20147705]
[-232.91395569 -261.05291748]
[-233.81651306 -276.03488159]
[-233.44525146 -291.03942871]
[-231.80284119 -305.95840454]
[-228.90112305 -320.68438721]
[-224.76100159 -335.11120605]
[-219.41229248 -349.13494873]
[-212.89356995 -362.65454102]
[-205.25175476 -375.57263184]
[-196.54194641 -387.79608154]
[-186.82687378 -399.23684692]
[-176.17655945 -409.81250000]
[-164.66772461 -419.44683838]
[-152.38328552 -428.07046509]
[-139.41177368 -435.62118530]
[-125.84663391 -442.04464722]
[-111.78561401 -447.29455566]
[-97.33002472 -451.33309937]
[-82.58401489 -454.13113403]
[-67.65383911 -455.66854858]
[-52.64706039 -455.93426514]
[-37.67181778 -454.92633057]
[-22.83600426 -452.65200806]
[-8.24651432 -449.12771606]
[5.99153423 -444.37884521]
[19.77555275 -438.43960571]
[33.00622559 -431.35278320]
[45.58822632 -423.16943359]
[57.43089294 -413.94851685]
[68.44890594 -403.75650024]
[78.56287384 -392.66680908]
[87.69992828 -380.75930786]
[95.79422760 -368.11984253]
[102.78746033 -354.83947754]
[108.62922668 -341.01385498]
[113.27745056 -326.74264526]
[116.69863892 -312.12863159]
[118.86813354 -297.27713013]
[119.77030182 -282.29513550]
[119.39865112 -267.29061890]
[117.75585938 -252.37165833]
[114.85375977 -237.64578247]
[110.71326447 -223.21905518]
[105.36419678 -209.19546509]
[98.84511566 -195.67601013]
[91.20297241 -182.75813293]
[82.49284363 -170.53491211]
[72.77748108 -159.09437561]
[62.12688828 -148.51899719]
[50.61780167 -138.88496399]
[38.33314514 -130.26167297]
[25.36143494 -122.71126556]
[11.79613304 -116.28815460]
[17.04285049 -102.23567963]
[22.28956985 -88.18321228]
[34.64526367 -84.52721405]
[42.76037216 -74.26918793]
[43.49645996 -61.01518250]
[36.36109161 -49.59147644]
[41.39801025 -35.46244812]
[46.43492508 -21.33341599]
[51.47183990 -7.20438719]
[56.50875854 6.92464209]
[62.48031998 20.68474579]
[69.35973358 34.01417542]
[76.23914337 47.34360504]
[83.70688629 60.35255432]
[91.74806213 73.01508331]
[99.78923035 85.67760468]
[112.09181976 92.32124329]
[112.87329102 106.28121948]
[120.91446686 118.94374847]
[128.95564270 131.60627747]
[136.99681091 144.26879883]
[145.03797913 156.93132019]
[153.07916260 169.59384155]
[161.12033081 182.25637817]
[159.53834534 167.34002686]
[160.85655212 152.39805603]
[165.02568054 137.98908997]
[171.88986206 124.65180969]
[181.19245911 112.88483429]
[192.58569336 103.12808228]
[205.64363098 95.74633026]
[219.87806702 91.01553345]
[234.75688171 89.11256409]
[249.72377014 90.10856628]
[264.21920776 93.96630096]
[277.70129395 100.54154205]
[289.66592407 109.58847809]
[299.66586304 120.76887512]
[307.32723999 133.66474915]
[312.36358643 147.79397583]
[314.58666992 162.62832642]
[313.91333008 177.61320496]
[310.36877441 192.18840027]
[304.08551025 205.80899048]
[295.29846191 217.96577454]
[284.33609009 228.20425415]
[271.60824585 236.14166260]
[257.59082031 241.48124695]
[242.80780029 244.02339172]
[227.81188965 243.67304993]
[213.16371155 240.44331360]
[199.41091919 234.45495605]
[187.06765747 225.93182373]
[176.59538269 215.19258118]
[168.38844299 202.64410400]
[170.17089844 217.53782654]
[171.95336914 232.43154907]
[181.27574158 245.21450806]
[175.10565186 258.77102661]
[176.88812256 273.66473389]
[178.67059326 288.55847168]
[187.99295044 301.34143066]
[181.82287598 314.89794922]
[183.60533142 329.79165649]
[185.38780212 344.68536377]
[187.17027283 359.57910156]
[188.95272827 374.47280884]
[190.73519897 389.36651611]
[192.51766968 404.26025391]
[207.22900391 407.99401855]
[219.59585571 416.79318237]
[227.94570923 429.46774292]
[231.14932251 444.30355835]
[228.77340698 459.29418945]
[221.13932800 472.41232300]
[209.27949524 481.88378906]
[194.79786682 486.42770386]
[179.65296936 485.42947388]
[165.89302063 479.02413940]
[155.37893677 468.07797241]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[4 199]
[5 198]
[6 197]
[7 196]
[8 195]
[9 194]
[10 193]
[12 191]
[13 190]
[14 189]
[16 187]
[17 186]
[18 185]
[19 154]
[20 153]
[21 152]
[22 151]
[23 150]
[24 149]
[25 148]
[27 146]
[28 145]
[29 144]
[36 143]
[37 142]
[38 141]
[48 140]
[49 139]
[50 138]
[51 137]
[52 136]
[55 132]
[56 131]
[57 130]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
