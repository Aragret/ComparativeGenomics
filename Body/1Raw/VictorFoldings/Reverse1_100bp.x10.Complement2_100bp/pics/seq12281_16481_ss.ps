%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Jun 17 13:33:11 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
AUCCCUUCAGUCCCAAUCCCACCAAUAUCAUCACACGUACCAAUAAUGAAAAUAAACCUCAACGUGGUUUUAAAAACCCCGGAUUCUGGUUACCUAUCGAxxxxxxxxxxUCACUUGACAUAGGCUGUAGACCAAGGAUGAAGUCCCAGUAUUUCGGAUUUAUCGGGUGUGCAAGGGGAAUUUAUUCUGUAGUGCUACCUAGUGUCCAGA\
) } def
/len { sequence length } bind def

/coor [
[146.41886902 272.06088257]
[156.97889709 261.35873413]
[169.15649414 252.54081726]
[162.47628784 239.11044312]
[155.79609680 225.68005371]
[149.11590576 212.24967957]
[142.43571472 198.81930542]
[135.65571594 185.43904114]
[128.77630615 172.10960388]
[114.55300140 167.83955383]
[107.38642120 154.41961670]
[111.96166992 139.52987671]
[105.08226013 126.20043945]
[98.20285034 112.87100983]
[90.92961884 99.75231934]
[83.26902008 86.85598755]
[75.60842133 73.95966339]
[67.94783020 61.06333542]
[60.28722763 48.16701126]
[48.41572952 47.53130341]
[38.42739868 41.30762863]
[32.74241638 31.14028549]
[32.67213821 19.61159134]
[38.11834717 9.58637333]
[30.84511948 -3.53232098]
[23.57188988 -16.65101433]
[16.29866028 -29.76970863]
[8.25748634 -42.43223572]
[-0.52311647 -54.59368896]
[-9.30371952 -66.75514221]
[-18.08432198 -78.91660309]
[-26.86492538 -91.07805634]
[-39.52886200 -83.03083801]
[-52.64728165 -75.74797821]
[-66.17410278 -69.25505829]
[-80.06181335 -63.57487488]
[-94.26163483 -58.72739029]
[-108.72367859 -54.72962570]
[-123.39716339 -51.59562683]
[-138.23052979 -49.33639908]
[-153.17169189 -47.95988083]
[-168.16815186 -47.47090530]
[-183.16723633 -47.87118912]
[-198.11627197 -49.15933228]
[-212.96273804 -51.33080292]
[-227.65449524 -54.37797546]
[-242.13993835 -58.29014969]
[-256.36816406 -63.05358124]
[-270.28921509 -68.65154266]
[-283.85421753 -75.06436157]
[-297.01547241 -82.26951599]
[-309.72677612 -90.24170685]
[-321.94345093 -98.95291901]
[-333.62265015 -108.37255859]
[-344.72329712 -118.46754456]
[-355.20642090 -129.20240784]
[-365.03515625 -140.53944397]
[-374.17504883 -152.43882751]
[-382.59396362 -164.85877991]
[-390.26229858 -177.75564575]
[-397.15316772 -191.08415222]
[-403.24234009 -204.79747009]
[-408.50842285 -218.84742737]
[-412.93292236 -233.18467712]
[-416.50030518 -247.75885010]
[-419.19802856 -262.51876831]
[-421.01666260 -277.41259766]
[-421.94973755 -292.38796997]
[-421.99404907 -307.39233398]
[-421.14938354 -322.37298584]
[-419.41876221 -337.27728271]
[-416.80822754 -352.05285645]
[-413.32696533 -366.64785767]
[-408.98718262 -381.01098633]
[-403.80413818 -395.09179688]
[-397.79605103 -408.84082031]
[-390.98403931 -422.20977783]
[-383.39196777 -435.15170288]
[-375.04653931 -447.62115479]
[-365.97708130 -459.57431030]
[-356.21542358 -470.96917725]
[-345.79589844 -481.76574707]
[-334.75503540 -491.92608643]
[-323.13168335 -501.41455078]
[-310.96664429 -510.19772339]
[-298.30261230 -518.24481201]
[-285.18414307 -525.52758789]
[-271.65725708 -532.02038574]
[-257.76950073 -537.70043945]
[-243.56964111 -542.54779053]
[-229.10755920 -546.54547119]
[-214.43405151 -549.67932129]
[-199.60066223 -551.93841553]
[-184.65950012 -553.31481934]
[-169.66302490 -553.80364990]
[-154.66394043 -553.40325928]
[-139.71492004 -552.11499023]
[-124.86846924 -549.94335938]
[-110.17673492 -546.89605713]
[-95.69133759 -542.98376465]
[-81.46314240 -538.22021484]
[-67.54213715 -532.62213135]
[-53.97721100 -526.20916748]
[-40.81601715 -519.00390625]
[-28.10478592 -511.03161621]
[-15.88816261 -502.32028198]
[-4.20906210 -492.90054321]
[6.89149427 -482.80548096]
[17.37451363 -472.07052612]
[27.20317650 -460.73339844]
[36.34295654 -448.83392334]
[44.76174927 -436.41390991]
[52.42998505 -423.51696777]
[59.32072830 -410.18838501]
[65.40977478 -396.47503662]
[70.67573547 -382.42501831]
[75.10012054 -368.08773804]
[78.66737366 -353.51351929]
[81.36498260 -338.75357056]
[83.18345642 -323.85974121]
[84.11641693 -308.88436890]
[84.16058350 -293.87997437]
[83.31580353 -278.89935303]
[81.58503723 -263.99508667]
[78.97438049 -249.21951294]
[75.49298096 -234.62455750]
[71.15308380 -220.26147461]
[65.96993256 -206.18070984]
[59.96172333 -192.43173218]
[53.14956665 -179.06282043]
[45.55738831 -166.12097168]
[37.21186066 -153.65159607]
[28.14229202 -141.69853210]
[18.38054466 -130.30374146]
[7.96090508 -119.50725555]
[-3.08002734 -109.34700012]
[-14.70347023 -99.85865784]
[-5.92286730 -87.69720459]
[2.85773611 -75.53575134]
[11.63833904 -63.37429428]
[20.41894341 -51.21283722]
[21.81589317 -66.14764404]
[31.63763428 -77.48490143]
[46.22089767 -80.99609375]
[60.12648392 -75.37162781]
[68.16796112 -62.70929718]
[67.34604645 -47.73183060]
[57.96730423 -36.02545929]
[43.52976608 -31.95636749]
[29.41735458 -37.04293823]
[36.69058228 -23.92424393]
[43.96381378 -10.80555058]
[51.23704147 2.31314373]
[69.10620117 6.28918362]
[78.55650330 22.33925056]
[73.18355560 40.50641251]
[80.84415436 53.40274048]
[88.50475311 66.29906464]
[96.16535187 79.19538879]
[103.82594299 92.09172058]
[106.70513153 93.09160614]
[109.28414154 95.16121674]
[111.16605377 98.19136810]
[111.99985504 101.92781830]
[111.53227997 105.99160004]
[118.41168976 119.32102966]
[125.29109955 132.65045166]
[140.07827759 137.54713440]
[146.86509705 151.16307068]
[142.10572815 165.23019409]
[148.98515320 178.55961609]
[155.70181274 184.75028992]
[155.86608887 192.13911438]
[162.54627991 205.56948853]
[169.22647095 218.99986267]
[175.90667725 232.43023682]
[182.58686829 245.86061096]
[196.96621704 241.46926880]
[211.87228394 239.50473022]
[226.89837646 240.02059937]
[241.63461304 243.00279236]
[255.67893982 248.36994934]
[268.64825439 255.97567749]
[280.18872070 265.61245728]
[289.98550415 277.01739502]
[297.77136230 289.87936401]
[303.33386230 303.84750366]
[306.52130127 318.54067993]
[307.24667358 333.55813599]
[305.49020386 348.49014282]
[301.29983521 362.92935181]
[294.78985596 376.48184204]
[286.13784790 388.77789307]
[275.57989502 399.48208618]
[263.40399170 408.30236816]
[249.94233704 414.99810791]
[235.56213379 419.38668823]
[220.65570068 421.34835815]
[205.62969971 420.82958984]
[190.89404297 417.84457397]
[176.85073853 412.47470093]
[163.88288879 404.86648560]
[152.34428406 395.22747803]
[142.54969788 383.82064819]
[134.76632690 370.95718384]
[129.20649719 356.98797607]
[126.02191162 342.29415894]
[125.29943085 327.27658081]
[127.05876923 312.34490967]
[131.25193787 297.90652466]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[3 177]
[4 176]
[5 175]
[6 174]
[7 173]
[8 171]
[9 170]
[12 167]
[13 166]
[14 165]
[15 160]
[16 159]
[17 158]
[18 157]
[19 156]
[24 153]
[25 152]
[26 151]
[27 150]
[28 141]
[29 140]
[30 139]
[31 138]
[32 137]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
