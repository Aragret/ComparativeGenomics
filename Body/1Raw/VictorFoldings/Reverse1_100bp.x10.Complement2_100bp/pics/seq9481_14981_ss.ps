%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Jun 17 13:30:00 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
UAAAUCGCCCCACUACGGACAACCCCCGGUCACGGGAGGAUUAACCCCCCAUCCCCGAUCCGACCUCACCAUUUUCCGAGUCUUUUUAGGACGCUUCUUUxxxxxxxxxxAGGCGAUGGAAGUGCGGUUACCGCGGAGUUAUAAGAAAUAGACGGAGAAGGAUGUGUAGCCCGCUCCGGAUAUAAUGCCUAGUAAAGAGAUGAGUCUUUG\
) } def
/len { sequence length } bind def

/coor [
[82.71435547 687.19409180]
[72.47640991 676.15917969]
[64.66963196 663.28906250]
[59.61372375 649.11083984]
[57.51570892 634.20501709]
[58.46150589 619.18200684]
[62.41238022 604.65704346]
[69.20655060 591.22485352]
[78.56579590 579.43542480]
[90.10686493 569.77166748]
[103.35715485 562.62921143]
[117.77407837 558.30053711]
[116.43584442 543.36035156]
[115.09761047 528.42016602]
[113.75937653 513.47998047]
[110.03166199 507.09832764]
[112.51412964 498.30767822]
[111.39848328 483.34924316]
[107.76619720 476.91275024]
[110.37927246 468.16006470]
[109.48645782 453.18664551]
[93.82018280 446.04479980]
[83.87786865 431.87921143]
[82.47235870 414.54055786]
[90.08077240 398.79818726]
[104.68830109 389.02816772]
[103.35006714 374.08798218]
[102.01183319 359.14779663]
[100.67359924 344.20761108]
[89.72711945 337.41024780]
[84.61809540 325.36947632]
[87.41802979 312.39370728]
[97.32374573 303.26730347]
[96.20809937 288.30883789]
[95.09245300 273.35040283]
[93.97679901 258.39193726]
[83.32908630 244.44227600]
[91.46231079 227.92161560]
[82.62039185 215.93537903]
[89.09564209 201.49995422]
[80.86525726 214.04031372]
[67.20522308 220.23736572]
[52.34825134 218.17088318]
[40.89793396 208.48118591]
[36.40228271 194.17073059]
[40.25431824 179.67376709]
[51.26044464 169.48234558]
[66.01029968 166.75437927]
[79.93347931 172.33515930]
[88.71581268 184.49566650]
[89.38559723 169.51063538]
[90.05538177 154.52558899]
[90.72517395 139.54055786]
[91.39495850 124.55551910]
[80.42797089 117.14514160]
[74.52552032 105.29821777]
[75.21495056 92.08029938]
[82.31786346 80.91172028]
[93.99627686 74.68250275]
[94.88909912 59.70909882]
[95.78191376 44.73569489]
[96.67472839 29.76228714]
[88.71276855 19.61487007]
[89.76465607 7.16186666]
[98.72300720 -0.96675861]
[99.83865356 -15.92521191]
[97.81522369 -19.76704597]
[97.18313599 -23.66127014]
[97.78801727 -27.16405869]
[99.34721375 -29.92730522]
[101.49210358 -31.73218155]
[103.49611664 -46.59770966]
[105.50012970 -61.46323776]
[107.50414276 -76.32876587]
[108.61979675 -91.28721619]
[108.84312439 -106.28556061]
[109.06645203 -121.28389740]
[109.28977966 -136.28222656]
[99.95033264 -152.15222168]
[109.53102875 -166.85517883]
[109.53102875 -181.85517883]
[98.98667908 -171.18669128]
[84.06388092 -169.66677856]
[71.58514404 -177.99029541]
[67.25557709 -192.35188293]
[73.05459595 -206.18557739]
[86.33097839 -213.16682434]
[101.01492310 -210.10388184]
[110.39374542 -198.39533997]
[111.95426941 -213.31394958]
[105.69465637 -227.84417725]
[114.71405029 -239.69744873]
[116.27457428 -254.61604309]
[117.83509827 -269.53466797]
[110.33419037 -280.02746582]
[111.94107819 -292.42108154]
[121.25345612 -300.14160156]
[123.03591919 -315.03530884]
[124.81838989 -329.92901611]
[110.92772675 -335.86419678]
[99.27275085 -345.47348022]
[90.79826355 -357.97787476]
[86.19126129 -372.36370850]
[85.82521057 -387.46478271]
[89.72978973 -402.05694580]
[97.58847046 -414.95724487]
[108.76418304 -425.11993408]
[122.35095978 -431.72113037]
[137.24739075 -434.22576904]
[152.24588013 -432.43075562]
[166.13056946 -426.48162842]
[177.77587891 -416.86065674]
[186.23780823 -404.34777832]
[190.83035278 -389.95730591]
[191.18122864 -374.85586548]
[187.26199341 -360.26763916]
[179.39035034 -347.37524414]
[168.20443726 -337.22378540]
[154.61103821 -330.63623047]
[139.71209717 -328.14654541]
[137.92964172 -313.25283813]
[136.14717102 -298.35913086]
[143.91281128 -282.62185669]
[132.75369263 -267.97412109]
[131.19317627 -253.05552673]
[129.63265991 -238.13691711]
[136.00389099 -224.67376709]
[126.87287140 -211.75341797]
[125.31235504 -196.83482361]
[124.53102875 -181.85517883]
[124.53102875 -166.85517883]
[132.85998535 -158.08277893]
[132.98274231 -145.58602905]
[124.28811646 -136.05889893]
[124.06478882 -121.06056976]
[123.84146118 -106.06223297]
[123.61813354 -91.06388855]
[133.66018677 -102.20648193]
[148.30946350 -105.43118286]
[162.10214233 -99.53526306]
[169.89390564 -86.71775818]
[168.77861023 -71.75927734]
[159.17224121 -60.23896790]
[144.65773010 -56.45361710]
[130.64862061 -61.81506348]
[122.36967468 -74.32475281]
[120.36566162 -59.45922470]
[118.36164856 -44.59369659]
[116.35763550 -29.72816849]
[114.79711151 -14.80956364]
[113.68145752 0.14889008]
[122.14205933 15.52371216]
[111.64813232 30.65510368]
[110.75531769 45.62850952]
[109.86250305 60.60191345]
[108.96968842 75.57531738]
[121.71628571 85.66741180]
[125.98429108 101.35531616]
[120.10736084 116.51406860]
[106.37999725 125.22530365]
[105.71021271 140.21034241]
[105.04042816 155.19537354]
[104.37063599 170.18041992]
[103.70085144 185.16545105]
[104.03582764 200.16171265]
[112.97346497 213.21656799]
[106.40248871 226.58337402]
[115.78163910 235.43743896]
[116.58868408 247.90870667]
[108.93525696 257.27627563]
[110.05090332 272.23474121]
[111.16654968 287.19320679]
[112.28220367 302.15164185]
[125.74447632 313.32244873]
[126.93898773 330.43640137]
[115.61378479 342.86935425]
[116.95201874 357.80953979]
[118.29025269 372.74972534]
[119.62848663 387.68991089]
[131.80732727 391.98590088]
[141.42185974 400.53787231]
[147.06726074 412.04891968]
[147.93661499 424.79345703]
[143.93600464 436.87579346]
[135.69329834 446.51211548]
[124.45986176 452.29385376]
[125.35267639 467.26724243]
[126.35693359 482.23358154]
[127.47258759 497.19204712]
[128.69955444 512.14178467]
[130.03779602 527.08197021]
[131.37602234 542.02215576]
[132.71426392 556.96234131]
[147.67097473 558.65991211]
[161.97969055 563.33380127]
[175.05447388 570.79266357]
[186.35993958 580.73107910]
[195.43312073 592.74200439]
[201.90248108 606.33361816]
[205.50309753 620.94940186]
[206.08753967 635.99078369]
[203.63186646 650.84185791]
[198.23664856 664.89447021]
[190.12278748 677.57318115]
[179.62257385 688.35888672]
[167.16595459 696.80975342]
[153.26304626 702.57983398]
[138.48315430 705.43286133]
[123.43150330 705.25195312]
[108.72445679 702.04455566]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[12 193]
[13 192]
[14 191]
[15 190]
[17 189]
[18 188]
[20 187]
[21 186]
[26 179]
[27 178]
[28 177]
[29 176]
[33 173]
[34 172]
[35 171]
[36 170]
[38 167]
[40 165]
[50 164]
[51 163]
[52 162]
[53 161]
[54 160]
[59 156]
[60 155]
[61 154]
[62 153]
[65 151]
[66 150]
[71 149]
[72 148]
[73 147]
[74 146]
[75 137]
[76 136]
[77 135]
[78 134]
[80 131]
[81 130]
[89 129]
[90 128]
[92 126]
[93 125]
[94 124]
[97 122]
[98 121]
[99 120]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
