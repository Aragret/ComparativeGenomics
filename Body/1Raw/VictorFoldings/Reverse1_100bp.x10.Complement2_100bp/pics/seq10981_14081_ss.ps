%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Jun 17 13:31:10 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
AUUAAUUCCUCUAAACAUCCCUCUAAUCAUAUCUCUCCAUCUCAAAAAAAGCACUAUCACCAAGUGACCUAUUCACCGCAACCGAACGGUACUAACACUCxxxxxxxxxxGUAUUAAUUUGAAAUGAAGGAGAGAAAGAAGAAGGGUGAGUAGGAUUGGGAUGAGGAUUAGUGUAUUGGAUAAGGGGGCUCGUUAGAGUUAAUGUUAUAU\
) } def
/len { sequence length } bind def

/coor [
[171.24534607 403.45559692]
[175.61149597 389.08569336]
[181.67794800 375.34686279]
[189.35623169 362.43945312]
[198.53439331 350.55169678]
[209.07856750 339.85693359]
[220.83500671 330.51116943]
[212.98324585 317.73031616]
[205.13148499 304.94949341]
[197.27973938 292.16864014]
[191.30844116 305.92886353]
[176.86781311 309.98693848]
[164.60292053 301.35137939]
[163.55500793 286.38803101]
[174.49655151 276.12728882]
[189.36045837 278.13211060]
[182.48104858 264.80267334]
[175.60163879 251.47325134]
[168.72222900 238.14382935]
[161.84280396 224.81439209]
[154.96339417 211.48497009]
[147.78802490 198.31248474]
[140.32029724 185.30354309]
[132.85255432 172.29458618]
[125.38481140 159.28562927]
[112.33826447 152.09974670]
[112.17813873 136.27934265]
[104.71039581 123.27039337]
[97.24265289 110.26144409]
[88.92070770 97.78164673]
[74.37741852 91.55242920]
[72.75877380 76.74603271]
[63.61996841 64.85140228]
[54.48116684 52.95677185]
[45.34236526 41.06213760]
[36.20356369 29.16750526]
[27.06476021 17.27287102]
[17.92595673 5.37823915]
[3.38266444 -0.85098267]
[1.76401937 -15.65737534]
[-7.37478304 -27.55200768]
[-16.77693367 -39.23958969]
[-26.43774414 -50.71429062]
[-36.09855652 -62.18898773]
[-45.75936508 -73.66368866]
[-55.42017746 -85.13838959]
[-67.69033051 -76.49404144]
[-80.65817261 -68.93650055]
[-94.22770691 -62.52172470]
[-108.29844666 -57.29721069]
[-122.76623535 -53.30163574]
[-137.52394104 -50.56458282]
[-152.46231079 -49.10631561]
[-167.47074890 -48.93762970]
[-182.43811035 -50.05978012]
[-197.25361633 -52.46445084]
[-211.80755615 -56.13384247]
[-225.99217224 -61.04079056]
[-239.70243835 -67.14895630]
[-252.83686829 -74.41312408]
[-265.29821777 -82.77951050]
[-276.99420166 -92.18617249]
[-287.83825684 -102.56346130]
[-297.75006104 -113.83454895]
[-306.65625000 -125.91599274]
[-314.49090576 -138.71832275]
[-321.19595337 -152.14678955]
[-326.72183228 -166.10192871]
[-331.02758789 -180.48045349]
[-334.08132935 -195.17590332]
[-335.86047363 -210.07946777]
[-336.35186768 -225.08079529]
[-335.55181885 -240.06883240]
[-333.46627808 -254.93261719]
[-330.11068726 -269.56207275]
[-325.50985718 -283.84893799]
[-319.69793701 -297.68737793]
[-312.71786499 -310.97497559]
[-304.62136841 -323.61334229]
[-295.46838379 -335.50891113]
[-285.32666016 -346.57357788]
[-274.27130127 -356.72546387]
[-262.38418579 -365.88937378]
[-249.75326538 -373.99749756]
[-236.47209167 -380.98977661]
[-222.63899231 -386.81442261]
[-208.35636902 -391.42837524]
[-193.72999573 -394.79739380]
[-178.86813354 -396.89660645]
[-163.88084412 -397.71044922]
[-148.87905884 -397.23284912]
[-133.97387695 -395.46740723]
[-119.27562714 -392.42715454]
[-104.89315033 -388.13464355]
[-90.93292999 -382.62161255]
[-77.49831390 -375.92886353]
[-64.68878174 -368.10601807]
[-52.59915924 -359.21093750]
[-41.31896210 -349.30947876]
[-30.93170738 -338.47497559]
[-21.51429939 -326.78762817]
[-13.13646221 -314.33398438]
[-5.86022234 -301.20623779]
[0.26054791 -287.50158691]
[5.18053150 -273.32150269]
[8.86330223 -258.77093506]
[11.28159332 -243.95765686]
[12.41750050 -228.99131775]
[12.26261425 -213.98274231]
[10.81807995 -199.04304504]
[8.09459400 -184.28282166]
[4.11232042 -169.81137085]
[-1.09925783 -155.73582458]
[-7.50155497 -142.16040039]
[-15.04716969 -129.18562317]
[-23.68023491 -116.90752411]
[-33.33683777 -105.41702271]
[-43.94547653 -94.79920197]
[-34.28466415 -83.32450104]
[-24.62385559 -71.84980011]
[-14.96304417 -60.37509918]
[-5.30223417 -48.90039825]
[-1.83939302 -48.23626709]
[1.47381258 -45.86187744]
[3.83705759 -41.86583328]
[4.51984978 -36.69081116]
[13.65865231 -24.79617691]
[27.54827690 -19.41773987]
[29.82059097 -3.76056337]
[38.95939255 8.13406944]
[48.09819412 20.02870178]
[57.23699570 31.92333603]
[66.37580109 43.81796646]
[75.51460266 55.71260071]
[84.65340424 67.60723114]
[98.54302979 72.98567200]
[100.81534576 88.64284515]
[101.04055786 73.64453888]
[109.24982452 61.09033966]
[122.89940643 54.87030029]
[137.75984192 56.91177368]
[149.22645569 66.58218384]
[153.74618530 80.88504791]
[149.91856384 95.38847351]
[138.92959595 105.59841156]
[124.18436432 108.35119629]
[110.25160217 102.79370117]
[117.71934509 115.80265808]
[125.18708801 128.81161499]
[138.76777649 136.92797852]
[138.39375305 151.81788635]
[145.86149597 164.82684326]
[153.32923889 177.83580017]
[160.79698181 190.84474182]
[165.31192017 193.46437073]
[168.09249878 197.18212891]
[169.01084900 201.15348816]
[168.29283142 204.60556030]
[175.17224121 217.93498230]
[182.05165100 231.26440430]
[188.93106079 244.59384155]
[195.81047058 257.92327881]
[202.68989563 271.25268555]
[210.06057739 284.31689453]
[217.91233826 297.09771729]
[225.76408386 309.87857056]
[233.61584473 322.65942383]
[247.26635742 316.39672852]
[261.57223511 311.82516479]
[276.32485962 309.01135254]
[291.30908203 307.99630737]
[306.30639648 308.79486084]
[321.09811401 311.39538574]
[335.46850586 315.75991821]
[349.20800781 321.82482910]
[362.11627197 329.50164795]
[374.00506592 338.67846680]
[384.70098877 349.22146606]
[394.04809570 360.97683716]
[401.91006470 373.77322388]
[408.17221069 387.42395020]
[412.74325562 401.73001099]
[415.55651855 416.48272705]
[416.57098389 431.46697998]
[415.77188110 446.46429443]
[413.17080688 461.25588989]
[408.80575562 475.62612915]
[402.74032593 489.36541748]
[395.06298828 502.27340698]
[385.88574219 514.16186523]
[375.34234619 524.85736084]
[363.58660889 534.20404053]
[350.78994751 542.06549072]
[337.13897705 548.32714844]
[322.83276367 552.89764404]
[308.07992554 555.71038818]
[293.09564209 556.72430420]
[278.09835815 555.92462158]
[263.30685425 553.32299805]
[248.93678284 548.95739746]
[235.19772339 542.89147949]
[222.29002380 535.21368408]
[210.40193176 526.03594971]
[199.70678711 515.49218750]
[190.36056519 503.73608398]
[182.49957275 490.93911743]
[176.23843384 477.28790283]
[171.66845703 462.98153687]
[168.85629272 448.22857666]
[167.84294128 433.24426270]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[7 167]
[8 166]
[9 165]
[10 164]
[16 163]
[17 162]
[18 161]
[19 160]
[20 159]
[21 158]
[22 154]
[23 153]
[24 152]
[25 151]
[27 149]
[28 148]
[29 147]
[30 137]
[32 135]
[33 134]
[34 133]
[35 132]
[36 131]
[37 130]
[38 129]
[40 127]
[41 126]
[42 122]
[43 121]
[44 120]
[45 119]
[46 118]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
