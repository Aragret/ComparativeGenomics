%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Jun 17 13:32:16 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
AGGUCCAAAUACCUCCCAAGAAGAUGAUAAUCCUGAAAAGCGAAGCUUCGCUUCCGAAGAGUUUAGUACUUUUAAUAAUUAUAAUGACGACAAUCUCUUUxxxxxxxxxxUUUCGGGUAUUUUUAUUUUUUAAUAUUGUUUGGGACUCUUGGUUUUACUUGCUUUUAGACAAGCGAAGUAAGUAACGGGGGUGUUAGGAUCCGGAUGGGC\
) } def
/len { sequence length } bind def

/coor [
[107.87782288 354.65457153]
[120.35486603 345.69808960]
[118.79434204 330.77947998]
[117.12280273 315.87289429]
[115.34033203 300.97918701]
[113.55786896 286.08547974]
[104.36299896 274.36779785]
[110.40558624 259.74597168]
[108.62311554 244.85226440]
[106.84065247 229.95854187]
[105.05818939 215.06483459]
[103.27571869 200.17111206]
[101.49325562 185.27738953]
[97.57718658 179.00952148]
[99.79682922 170.14888000]
[98.23630524 155.23027039]
[96.67578125 140.31166077]
[83.13040924 136.76272583]
[71.60673523 128.80804443]
[63.48577881 117.40093231]
[59.74077606 103.90845490]
[60.82054520 89.94757080]
[66.59567261 77.19139862]
[76.37406921 67.16867065]
[88.98384857 61.08052826]
[83.28973389 74.95774078]
[73.80464172 86.57811737]
[61.34914780 94.93637848]
[47.00075912 99.30945587]
[32.00076294 99.31902313]
[17.64680481 94.96426392]
[5.18064976 86.62191010]
[-4.31925774 75.01364136]
[-10.03108025 61.14371109]
[-11.46068764 46.21199036]
[-8.48440456 31.51023102]
[-1.35970902 18.31027985]
[9.29704094 7.75406408]
[22.56393051 0.75480294]
[37.29323959 -2.08199763]
[52.21073532 -0.51092643]
[66.02590942 5.33210373]
[77.54360962 14.94161129]
[85.76743317 27.48627853]
[89.98546600 41.87738419]
[92.87073517 27.15749168]
[95.75600433 12.43760014]
[98.64128113 -2.28229141]
[101.52655029 -17.00218201]
[104.41182709 -31.72207451]
[107.29709625 -46.44196701]
[110.18237305 -61.16185760]
[113.06764221 -75.88174438]
[113.96045685 -90.85515594]
[112.84481049 -105.81360626]
[109.08579254 -114.13872528]
[111.82559967 -121.00278473]
[110.93278503 -135.97619629]
[110.03996277 -150.94960022]
[109.14714813 -165.92300415]
[108.25433350 -180.89640808]
[107.36151886 -195.86981201]
[92.35618591 -196.09831238]
[77.40988922 -197.44752502]
[62.60620880 -199.90989685]
[48.02794266 -203.47167969]
[33.75661087 -208.11294556]
[19.87203217 -213.80773926]
[6.45185089 -220.52421570]
[-6.42887831 -228.22479248]
[-18.69812202 -236.86643982]
[-30.28726387 -246.40080261]
[-41.13149261 -256.77456665]
[-51.17015839 -267.92971802]
[-60.34712601 -279.80386353]
[-68.61107635 -292.33059692]
[-75.91577911 -305.43988037]
[-82.22039795 -319.05841064]
[-87.48966980 -333.10998535]
[-91.69412231 -347.51605225]
[-94.81024933 -362.19604492]
[-96.82061768 -377.06787109]
[-97.71398163 -392.04830933]
[-97.48535919 -407.05364990]
[-96.13601685 -421.99993896]
[-93.67350006 -436.80358887]
[-90.11158752 -451.38183594]
[-85.47019196 -465.65310669]
[-79.77528381 -479.53762817]
[-73.05869293 -492.95776367]
[-65.35799408 -505.83843994]
[-56.71624756 -518.10760498]
[-47.18178558 -529.69665527]
[-36.80792999 -540.54077148]
[-25.65269279 -550.57934570]
[-13.77846050 -559.75622559]
[-1.25163960 -568.02008057]
[11.85771370 -575.32464600]
[25.47628593 -581.62915039]
[39.52791595 -586.89831543]
[53.93402100 -591.10260010]
[68.61403656 -594.21862793]
[83.48586273 -596.22882080]
[98.46632385 -597.12207031]
[113.47164917 -596.89331055]
[128.41792297 -595.54382324]
[143.22155762 -593.08123779]
[157.79977417 -589.51916504]
[172.07101440 -584.87762451]
[185.95549011 -579.18261719]
[199.37556458 -572.46588135]
[212.25614929 -564.76507568]
[224.52523804 -556.12322998]
[236.11421204 -546.58868408]
[246.95826721 -536.21472168]
[256.99673462 -525.05938721]
[266.17349243 -513.18505859]
[274.43722534 -500.65820312]
[281.74169922 -487.54876709]
[288.04608154 -473.93014526]
[293.31509399 -459.87847900]
[297.51928711 -445.47232056]
[300.63516235 -430.79229736]
[302.64526367 -415.92044067]
[303.53836060 -400.93997192]
[303.30947876 -385.93463135]
[301.95986938 -370.98837280]
[299.49710083 -356.18475342]
[295.93493652 -341.60659790]
[291.29327393 -327.33538818]
[285.59811401 -313.45095825]
[278.88128662 -300.03094482]
[271.18035889 -287.15042114]
[262.53842163 -274.88140869]
[253.00373840 -263.29251099]
[242.62969971 -252.44857788]
[231.47427368 -242.41020203]
[219.59988403 -233.23355103]
[207.07292175 -224.96992493]
[193.96343994 -217.66557312]
[180.34475708 -211.36131287]
[166.29302979 -206.09240723]
[151.88685608 -201.88833618]
[137.20678711 -198.77259827]
[122.33492279 -196.76263428]
[123.22773743 -181.78923035]
[124.12055969 -166.81581116]
[125.01337433 -151.84240723]
[125.90618896 -136.86900330]
[126.79900360 -121.89559937]
[127.80326080 -106.92925262]
[128.91891479 -91.97080231]
[134.91758728 -105.71910858]
[144.82402039 -116.98243713]
[157.69398499 -124.68724823]
[172.30079651 -128.09916687]
[187.25221252 -126.89299774]
[201.12318420 -121.18369293]
[212.59161377 -111.51543427]
[220.56439209 -98.80973053]
[224.28161621 -84.27761841]
[223.38896179 -69.30420685]
[217.97154236 -55.31665421]
[208.54570007 -43.64817429]
[196.00984192 -35.41093063]
[181.55880737 -31.39004517]
[166.56997681 -31.96876144]
[152.47198486 -37.09191895]
[140.60856628 -46.27121353]
[132.11047363 -58.63173294]
[127.78753662 -72.99647522]
[124.90225983 -58.27658463]
[122.01699066 -43.55669403]
[119.13171387 -28.83680153]
[116.24644470 -14.11690998]
[113.36117554 0.60298133]
[110.47589874 15.32287312]
[107.59062958 30.04276466]
[104.70535278 44.76265717]
[103.92403412 59.74229431]
[119.05580902 64.32147217]
[131.27648926 74.35116577]
[138.71913147 88.29915619]
[140.24676514 104.03466034]
[135.62602234 119.15379333]
[125.56278229 131.34684753]
[111.59438324 138.75114441]
[113.15490723 153.66975403]
[114.71543121 168.58834839]
[116.38697052 183.49493408]
[118.16944122 198.38864136]
[119.95190430 213.28236389]
[121.73436737 228.17608643]
[123.51683807 243.06979370]
[125.29930115 257.96350098]
[134.62167358 270.74645996]
[128.45158386 284.30300903]
[130.23405457 299.19671631]
[132.01652527 314.09042358]
[136.14352417 322.23941040]
[133.71295166 329.21896362]
[135.27346802 344.13754272]
[149.33389282 350.31817627]
[158.40733337 362.71044922]
[160.05305481 377.98089600]
[153.82839966 392.02188110]
[141.40774536 401.05642700]
[126.13220215 402.65429688]
[112.11080170 396.38565063]
[103.11523438 383.93673706]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[2 202]
[3 201]
[4 199]
[5 198]
[6 197]
[8 195]
[9 194]
[10 193]
[11 192]
[12 191]
[13 190]
[15 189]
[16 188]
[17 187]
[25 180]
[45 179]
[46 178]
[47 177]
[48 176]
[49 175]
[50 174]
[51 173]
[52 172]
[53 171]
[54 152]
[55 151]
[57 150]
[58 149]
[59 148]
[60 147]
[61 146]
[62 145]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
