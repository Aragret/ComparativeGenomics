%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Jun 17 13:35:12 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
UCGAGUACGCGGCUUAUUAUCCAUAUCACAAGGUUACAGAAACACCAAACAUCUCUUAUCAGUUGCCAGCCGCUUGUAGUCACCCCCACUCCAUUUUACCxxxxxxxxxxUCUCCGAAUGCUGGGGAAUAAAUGGCUCUUUCGAGUGUUCUUGACGAUUGAGUACGGGGGUACAGAUUGUUGUACCGAAAGAGUUGAAAAUUUCCUAUUG\
) } def
/len { sequence length } bind def

/coor [
[-0.50178403 579.94415283]
[-8.58602047 592.59289551]
[-17.83600044 604.41583252]
[-28.16795349 615.30603027]
[-39.48830795 625.16473389]
[-51.69454193 633.90270996]
[-64.67611694 641.44085693]
[-78.31546021 647.71087646]
[-92.48905182 652.65600586]
[-107.06852722 656.23138428]
[-121.92185974 658.40472412]
[-136.91452026 659.15631104]
[-151.91073608 658.47930908]
[-166.77468872 656.37994385]
[-181.37178040 652.87707520]
[-195.56979370 648.00256348]
[-209.24015808 641.80047607]
[-222.25907898 634.32702637]
[-234.50863647 625.64984131]
[-245.87789917 615.84759521]
[-256.26391602 605.00897217]
[-265.57260132 593.23217773]
[-273.71966553 580.62384033]
[-280.63131714 567.29815674]
[-286.24499512 553.37579346]
[-290.50979614 538.98291016]
[-293.38717651 524.24975586]
[-294.85101318 509.30981445]
[-294.88809204 494.29837036]
[-293.49804688 479.35137939]
[-290.69348145 464.60421753]
[-286.49978638 450.19039917]
[-280.95495605 436.24050903]
[-274.10919189 422.88085938]
[-266.02447510 410.23245239]
[-256.77407837 398.40982056]
[-246.44172668 387.52001953]
[-235.12100220 377.66171265]
[-222.91445923 368.92416382]
[-209.93260193 361.38650513]
[-196.29302979 355.11700439]
[-182.11926270 350.17239380]
[-167.53965759 346.59753418]
[-152.68624878 344.42471313]
[-137.69355774 343.67370605]
[-122.69737244 344.35122681]
[-107.83348846 346.45117188]
[-93.23652649 349.95452881]
[-79.03868866 354.82958984]
[-65.36854553 361.03216553]
[-57.90080643 348.02319336]
[-58.27481842 333.13330078]
[-44.69413376 325.01693726]
[-37.22639084 312.00796509]
[-29.75864983 298.99902344]
[-22.29090881 285.99008179]
[-14.82316780 272.98110962]
[-14.21938992 265.61517334]
[-7.14616346 259.83526611]
[0.51443386 246.93893433]
[-9.89266682 237.47151184]
[-18.24367714 226.14253235]
[-24.21252823 213.39094543]
[-27.56548882 199.71125793]
[-28.17033005 185.63449097]
[-26.00152779 171.70741272]
[-21.14134026 158.47143555]
[-13.77668571 146.44146729]
[-4.19195652 136.08593750]
[7.24196196 127.80854797]
[20.08204460 121.93251038]
[33.83029175 118.68795013]
[47.95304489 118.20291138]
[61.90169144 120.49823761]
[75.13399506 125.48677826]
[83.17517090 112.82424927]
[91.21634674 100.16172791]
[90.80686951 97.14148712]
[91.48728943 93.90550995]
[93.33962250 90.85717773]
[96.29571533 88.42453766]
[100.13203430 87.00479889]
[108.91263580 74.84334564]
[117.69323730 62.68188858]
[126.47383881 50.52043152]
[135.25444031 38.35897446]
[144.03504944 26.19751930]
[152.63360596 13.90668201]
[161.04823303 1.48918676]
[169.46284485 -10.92830849]
[175.43441772 -24.68841171]
[178.75666809 -39.31587219]
[182.07893372 -53.94333267]
[185.40118408 -68.57079315]
[188.72344971 -83.19824982]
[192.04571533 -97.82571411]
[195.14982605 -112.50101471]
[190.21148682 -127.53176880]
[200.25241089 -138.53308105]
[203.13768005 -153.25297546]
[189.52017212 -159.73480225]
[177.94296265 -169.40016174]
[169.13381958 -181.64147949]
[163.64649963 -195.68925476]
[161.82592773 -210.66044617]
[163.78654480 -225.61393738]
[169.40512085 -239.60974121]
[178.32846069 -251.76806641]
[189.99562073 -261.32464600]
[203.67320251 -267.67871094]
[218.50143433 -270.43087769]
[233.54818726 -269.40814209]
[247.86761475 -264.67477417]
[260.55960083 -256.52832031]
[270.82626343 -245.48088074]
[278.02230835 -232.22689819]
[281.69531250 -217.59953308]
[281.61444092 -202.51828003]
[277.78475952 -187.93115234]
[270.44699097 -174.75509644]
[260.06240845 -163.81840515]
[247.28379822 -155.80854797]
[232.91442871 -151.22901917]
[217.85757446 -150.36770630]
[214.97230530 -135.64781189]
[220.11700439 -121.66992950]
[209.86970520 -109.61574554]
[211.74337769 -105.22274780]
[210.87730408 -99.60608673]
[206.67317200 -94.50345612]
[203.35090637 -79.87599182]
[200.02865601 -65.24853516]
[196.70639038 -50.62107086]
[193.38412476 -35.99361420]
[190.06187439 -21.36615181]
[199.51440430 -33.01302719]
[211.36901855 -42.20367813]
[225.00384521 -48.45598602]
[239.70364380 -51.44195938]
[254.69728088 -51.00497055]
[269.19821167 -47.16793442]
[282.44577026 -40.13213730]
[293.74499512 -30.26666260]
[302.50314331 -18.08903503]
[308.26080322 -4.23806763]
[310.71594238 10.55964565]
[309.73974609 25.52784729]
[305.38345337 39.88133240]
[297.87554932 52.86715317]
[287.60989380 63.80408859]
[275.12503052 72.11841583]
[261.07586670 77.37398529]
[246.19940186 79.29508972]
[231.27601624 77.78096008]
[217.08856201 72.91101837]
[204.38130188 64.94074249]
[193.82080078 54.28822708]
[185.96107483 41.51228714]
[181.21441650 27.28311729]
[179.82981873 12.34715843]
[181.88034058 -2.51368999]
[173.46572876 9.90380573]
[165.05110168 22.32130051]
[165.05659485 27.09717941]
[162.06195068 31.92720604]
[156.19650269 34.97812271]
[147.41589355 47.13957977]
[138.63529968 59.30103683]
[129.85469055 71.46249390]
[121.07408905 83.62394714]
[112.29348755 95.78540039]
[103.87886810 108.20289612]
[95.83769989 120.86542511]
[87.79652405 133.52795410]
[99.11292267 144.81231689]
[107.64696503 158.31613159]
[112.97770691 173.36773682]
[114.84346008 189.21929932]
[113.15459442 205.08389282]
[107.99788666 220.17466736]
[99.63202667 233.74375916]
[88.47466278 245.11947632]
[75.08155060 253.73942566]
[60.11885834 259.17840576]
[44.33005142 261.16931152]
[28.49893951 259.61636353]
[13.41076088 254.59953308]
[5.75016356 267.49584961]
[-1.81421554 280.44885254]
[-9.28195667 293.45779419]
[-16.74969864 306.46676636]
[-24.21743965 319.47570801]
[-31.68518066 332.48468018]
[-31.84531021 348.30505371]
[-44.89185333 355.49093628]
[-52.35959244 368.49990845]
[-40.10972214 377.17660522]
[-28.74010086 386.97848511]
[-18.35370064 397.81671143]
[-9.04458427 409.59317017]
[-0.89705926 422.20123291]
[6.01508904 435.52664185]
[11.62926006 449.44879150]
[15.89461231 463.84155273]
[18.77251434 478.57458496]
[20.23690414 493.51446533]
[20.27452087 508.52590942]
[18.88502121 523.47296143]
[16.08099174 538.22021484]
[11.88782406 552.63415527]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[50 196]
[51 195]
[53 193]
[54 192]
[55 191]
[56 190]
[57 189]
[59 188]
[60 187]
[75 174]
[76 173]
[77 172]
[82 171]
[83 170]
[84 169]
[85 168]
[86 167]
[87 166]
[88 163]
[89 162]
[90 161]
[91 135]
[92 134]
[93 133]
[94 132]
[95 131]
[96 130]
[97 127]
[99 125]
[100 124]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
