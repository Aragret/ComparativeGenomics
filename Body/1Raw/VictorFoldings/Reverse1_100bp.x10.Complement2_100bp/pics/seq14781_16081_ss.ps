%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Jun 17 13:34:58 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
CUAAACCUCCUAGUCCGUCCGCGGUUCCUCACUCGGCUUCAAAGUAGUACGCCUCUACAACCUACCCCACCCCUCCAGCUACUUACUCACCAAUUAAUUAxxxxxxxxxxGGCGAUACAUAAAGCAUGUAAUGACGGUCGGUGGUACUUAUAACAUGCCAUGGUAUUUAUGAACUGGUGGACAUCAUGUAUUUUUGGGUUAGGUGUAGUU\
) } def
/len { sequence length } bind def

/coor [
[-6.72976303 299.04962158]
[-2.80990267 313.54330444]
[-0.45285845 328.37155151]
[0.31466228 343.36630249]
[-0.51603711 358.35769653]
[-2.93554401 373.17587280]
[-6.91644382 387.65292358]
[-12.41362953 401.62478638]
[-19.36481476 414.93316650]
[-27.69123459 427.42727661]
[-37.29854965 438.96554565]
[-48.07789612 449.41723633]
[-59.90713501 458.66390991]
[-72.65223694 466.60083008]
[-86.16879272 473.13800049]
[-100.30363464 478.20141602]
[-114.89662170 481.73370361]
[-129.78239441 483.69479370]
[-144.79228210 484.06246948]
[-159.75622559 482.83261108]
[-174.50466919 480.01910400]
[-188.87048340 475.65383911]
[-202.69090271 469.78631592]
[-215.80934143 462.48297119]
[-228.07714844 453.82659912]
[-239.35531616 443.91522217]
[-249.51606750 432.86120605]
[-258.44424438 420.78976440]
[-266.03872681 407.83770752]
[-272.21343994 394.15176392]
[-276.89840698 379.88702393]
[-280.04055786 365.20507812]
[-281.60430908 350.27233887]
[-281.57189941 335.25799561]
[-279.94372559 320.33212280]
[-276.73822021 305.66390991]
[-271.99172974 291.41949463]
[-265.75802612 277.76034546]
[-258.10769653 264.84115601]
[-249.12750244 252.80838013]
[-238.91914368 241.79832458]
[-227.59829712 231.93572998]
[-215.29324341 223.33236694]
[-202.14341736 216.08572388]
[-188.29779053 210.27789307]
[-173.91326904 205.97468567]
[-159.15283203 203.22486877]
[-144.18371582 202.05958557]
[-129.17555237 202.49206543]
[-114.29837799 204.51737976]
[-99.72077942 208.11259460]
[-85.60791779 213.23696899]
[-72.11970520 219.83244324]
[-59.40897751 227.82427979]
[-47.61975479 237.12193298]
[-37.13225174 226.39755249]
[-26.64475250 215.67317200]
[-16.15725136 204.94879150]
[-5.66975021 194.22441101]
[-3.24062848 187.24435425]
[5.05462933 183.41989136]
[15.70063782 172.85284424]
[26.34664726 162.28579712]
[36.99265671 151.71875000]
[40.57493591 137.26135254]
[55.82008362 133.03096008]
[66.46609497 122.46392059]
[77.11209869 111.89687347]
[87.75811005 101.32982635]
[88.53239441 94.25944519]
[93.20893860 88.52438354]
[100.52553558 86.16521454]
[109.12409973 73.87438202]
[110.69501495 58.13135529]
[124.33062744 52.13808060]
[132.92918396 39.84724045]
[141.52775574 27.55640221]
[150.12631226 15.26556492]
[140.92388916 4.11857128]
[134.92927551 -9.02123165]
[132.54629517 -23.25361252]
[133.93153381 -37.60528183]
[138.98408508 -51.09643555]
[147.35290527 -62.80766296]
[158.46118164 -71.94258881]
[171.54609680 -77.88203430]
[185.71116638 -80.22599030]
[199.98771667 -78.82053375]
[213.40107727 -73.76794434]
[222.18168640 -85.92939758]
[230.96228027 -98.09085083]
[239.74288940 -110.25231171]
[228.40948486 -120.09406281]
[218.00392151 -130.91212463]
[208.60998535 -142.61940002]
[200.30329895 -155.12161255]
[193.15075684 -168.31809998]
[187.20994568 -182.10261536]
[182.52870178 -196.36418152]
[179.14471436 -210.98796082]
[177.08522034 -225.85620117]
[176.36682129 -240.84921265]
[176.99526978 -255.84625244]
[178.96554565 -270.72659302]
[182.26174927 -285.37039185]
[186.85737610 -299.65979004]
[192.71539307 -313.47967529]
[199.78865051 -326.71884155]
[208.02018738 -339.27066040]
[217.34373474 -351.03405762]
[227.68421936 -361.91433716]
[238.95838928 -371.82391357]
[251.07546997 -380.68295288]
[263.93789673 -388.42016602]
[277.44207764 -394.97323608]
[291.47933960 -400.28939819]
[305.93664551 -404.32586670]
[320.69754028 -407.05010986]
[335.64324951 -408.44024658]
[350.65338135 -408.48501587]
[365.60711670 -407.18411255]
[380.38403320 -404.54800415]
[394.86514282 -400.59790039]
[408.93386841 -395.36560059]
[422.47695923 -388.89321899]
[435.38531494 -381.23291016]
[447.55505371 -372.44635010]
[458.88815308 -362.60424805]
[469.29339600 -351.78585815]
[478.68698120 -340.07830811]
[486.99325562 -327.57583618]
[494.14541626 -314.37911987]
[500.08578491 -300.59442139]
[504.76660156 -286.33273315]
[508.15014648 -271.70883179]
[510.20919800 -256.84054565]
[510.92712402 -241.84751892]
[510.29821777 -226.85049438]
[508.32748413 -211.97021484]
[505.03082275 -197.32650757]
[500.43478394 -183.03726196]
[494.57635498 -169.21752930]
[487.50268555 -155.97859192]
[479.27075195 -143.42703247]
[469.94686890 -131.66390991]
[459.60604858 -120.78393555]
[448.33157349 -110.87472534]
[436.21420288 -102.01604462]
[423.35156250 -94.27923584]
[409.84716797 -87.72657776]
[395.80972290 -82.41084290]
[381.35232544 -78.37481689]
[366.59130859 -75.65100861]
[351.64556885 -74.26134491]
[336.63543701 -74.21701813]
[321.68176270 -75.51837158]
[306.90493774 -78.15494537]
[292.42391968 -82.10549927]
[278.35534668 -87.33823395]
[264.81246948 -93.81100464]
[251.90434265 -101.47170258]
[243.12374878 -89.31024933]
[234.34313965 -77.14879608]
[225.56253052 -64.98733521]
[235.23263550 -52.75074387]
[241.07260132 -38.27341843]
[242.60255432 -22.72313881]
[239.69061279 -7.35672951]
[232.56425476 6.58154535]
[221.79254150 17.96071434]
[208.24069214 25.85487747]
[193.00056458 29.61853600]
[177.30276489 28.93936539]
[162.41716003 23.86413002]
[153.81858826 36.15496826]
[145.22003174 48.44580460]
[136.62145996 60.73664474]
[135.66557312 75.60054016]
[121.41493988 82.47294617]
[112.81637573 94.76377869]
[126.67213440 89.01766968]
[141.67094421 88.82873535]
[155.66705322 94.22399902]
[166.65815735 104.43162537]
[173.07186890 117.99128723]
[173.99061584 132.96311951]
[169.28297424 147.20524597]
[159.62242126 158.68016052]
[146.39100647 165.74626160]
[131.48162842 167.39263916]
[117.02725220 163.38378906]
[105.09573364 154.29319763]
[97.39399719 141.42140198]
[95.02388000 126.60983276]
[98.32515717 111.97583008]
[87.67914581 122.54287720]
[77.03314209 133.10992432]
[66.38713074 143.67697144]
[62.04337311 158.89019775]
[47.55970383 162.36476135]
[36.91369629 172.93180847]
[26.26768684 183.49885559]
[15.62167740 194.06590271]
[5.05462933 204.71191406]
[-5.43287134 215.43629456]
[-15.92037296 226.16067505]
[-26.40787315 236.88505554]
[-36.89537430 247.60943604]
[-27.33676720 259.18807983]
[-19.06306839 271.71716309]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[55 208]
[56 207]
[57 206]
[58 205]
[59 204]
[61 203]
[62 202]
[63 201]
[64 200]
[66 198]
[67 197]
[68 196]
[69 195]
[72 180]
[73 179]
[75 177]
[76 176]
[77 175]
[78 174]
[89 164]
[90 163]
[91 162]
[92 161]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
