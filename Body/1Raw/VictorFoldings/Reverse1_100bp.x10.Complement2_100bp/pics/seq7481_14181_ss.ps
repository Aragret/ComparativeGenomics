%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Jun 17 13:31:17 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
UAUAUAUCCUAAAUCGGAUAUUAAAUUGAAACUGUUUCAAUACUUUACCAAAAAGAUUAUGGAAAAACUUUUUCAGUACCUCCGGUACCCCAACCGAACUxxxxxxxxxxAUGUGGUUGUUUGUUACAAGUUGGUCAUUGAUGAUGAUUAGUUGCGGGUAUUAGUAUGUUUCGGGGGCGUGGUUAUCCUAGGAGGGCUUAGUUGGGACUG\
) } def
/len { sequence length } bind def

/coor [
[29.47984314 378.64285278]
[29.95402718 393.65194702]
[28.71417618 408.61727905]
[25.77645683 423.34368896]
[21.17916870 437.63925171]
[14.98224354 451.31753540]
[7.26647472 464.20025635]
[-1.86754847 476.11947632]
[-12.30074501 486.91976929]
[-23.89709663 496.46032715]
[-36.50542450 504.61679077]
[-49.96134567 511.28280640]
[-64.08943939 516.37152100]
[-78.70552063 519.81646729]
[-93.61903381 521.57287598]
[-108.63554382 521.61779785]
[-123.55929565 519.95062256]
[-138.19570923 516.59307861]
[-152.35398865 511.58901978]
[-165.84954834 505.00357056]
[-178.50642395 496.92266846]
[-190.15963745 487.45162964]
[-200.65724182 476.71392822]
[-209.86238098 464.84957886]
[-217.65505981 452.01324463]
[-223.93368530 438.37225342]
[-228.61639404 424.10443115]
[-231.64213562 409.39584351]
[-232.97146606 394.43823242]
[-232.58706665 379.42657471]
[-230.49392700 364.55657959]
[-226.71934509 350.02212524]
[-221.31254578 336.01269531]
[-214.34399414 322.71090698]
[-205.90454102 310.29022217]
[-196.10423279 298.91253662]
[-185.07083130 288.72619629]
[-172.94815063 279.86401367]
[-159.89427185 272.44146729]
[-146.07936096 266.55538940]
[-131.68353271 262.28247070]
[-116.89444733 259.67846680]
[-101.90493011 258.77728271]
[-86.91039276 259.59069824]
[-72.10632324 262.10809326]
[-57.68571472 266.29663086]
[-43.83657837 272.10174561]
[-30.73946571 279.44772339]
[-21.95886230 267.28625488]
[-13.17825890 255.12480164]
[-4.39765596 242.96334839]
[-3.55860639 225.43443298]
[13.30334187 218.03468323]
[21.90190506 205.74385071]
[30.50046921 193.45300293]
[31.45635986 178.58911133]
[45.70699692 171.71670532]
[53.93580627 159.17530823]
[61.78756332 146.39445496]
[62.61038208 139.04975891]
[69.85256195 133.48300171]
[77.89373779 120.82048035]
[85.93490601 108.15795898]
[84.08722687 96.65894318]
[90.40368652 86.87407684]
[101.64359283 83.82354736]
[109.87239838 71.28214264]
[118.10120392 58.74074554]
[103.10786438 59.18764877]
[93.29424286 47.84336090]
[95.89457703 33.07047272]
[108.99200439 25.75900269]
[122.93157959 31.29870033]
[127.43779755 45.60426331]
[136.57659912 33.70963287]
[133.30113220 20.64495277]
[138.07846069 8.25998306]
[148.95549011 0.99552304]
[161.83671570 1.31740475]
[171.15159607 -10.43984699]
[180.46647644 -22.19709778]
[189.78137207 -33.95434952]
[199.09625244 -45.71160126]
[208.41113281 -57.46885300]
[217.72601318 -69.22610474]
[226.14062500 -81.64360046]
[233.60836792 -94.65254974]
[241.07611084 -107.66150665]
[248.54385376 -120.67045593]
[256.01159668 -133.67941284]
[263.38229370 -146.74359131]
[270.65551758 -159.86228943]
[277.92874146 -172.98098755]
[285.20196533 -186.09967041]
[272.93392944 -194.75660706]
[261.67379761 -204.68920898]
[251.55360413 -215.78105164]
[242.69200134 -227.90206909]
[235.19287109 -240.91015625]
[229.14414978 -254.65280151]
[224.61676025 -268.96887207]
[221.66377258 -283.69052124]
[220.31980896 -298.64517212]
[220.60064697 -313.65744019]
[222.50296021 -328.55133057]
[226.00448608 -343.15225220]
[231.06413269 -357.28897095]
[237.62258911 -370.79577637]
[245.60298157 -383.51431274]
[254.91171265 -395.29541016]
[265.43966675 -406.00100708]
[277.06338501 -415.50552368]
[289.64663696 -423.69757080]
[303.04180908 -430.48107910]
[317.09191895 -435.77651978]
[331.63220215 -439.52182007]
[346.49221802 -441.67306519]
[361.49768066 -442.20498657]
[376.47271729 -441.11141968]
[391.24169922 -438.40512085]
[405.63153076 -434.11788940]
[419.47341919 -428.29992676]
[432.60516357 -421.01947021]
[444.87274170 -412.36187744]
[456.13232422 -402.42864990]
[466.25192261 -391.33627319]
[475.11288452 -379.21478271]
[482.61129761 -366.20629883]
[488.65930176 -352.46331787]
[493.18591309 -338.14700317]
[496.13812256 -323.42520142]
[497.48126221 -308.47048950]
[497.19961548 -293.45822144]
[495.29650879 -278.56442261]
[491.79418945 -263.96368408]
[486.73379517 -249.82723999]
[480.17459106 -236.32078552]
[472.19354248 -223.60269165]
[462.88415527 -211.82208252]
[452.35562134 -201.11706543]
[440.73138428 -191.61315918]
[428.14773560 -183.42179871]
[414.75216675 -176.63900757]
[400.70178223 -171.34431458]
[386.16128540 -167.59980774]
[371.30117798 -165.44937134]
[356.29565430 -164.91824341]
[341.32070923 -166.01263428]
[326.55184937 -168.71971130]
[312.16226196 -173.00773621]
[298.32067871 -178.82644653]
[291.04742432 -165.70774841]
[283.77420044 -152.58905029]
[276.50097656 -139.47036743]
[276.00692749 -132.09623718]
[269.02053833 -126.21166992]
[261.55279541 -113.20271301]
[254.08506775 -100.19376373]
[246.61732483 -87.18480682]
[239.14958191 -74.17585754]
[252.85401917 -80.27409363]
[267.78155518 -78.80142975]
[280.03015137 -70.14282227]
[286.39810181 -56.56160355]
[285.22079468 -41.60787582]
[276.80596924 -29.19050980]
[263.35327148 -22.55536842]
[248.37921143 -23.43686867]
[235.79794312 -31.60458374]
[228.89817810 -44.92349243]
[229.48326111 -59.91122055]
[220.16838074 -48.15396881]
[210.85350037 -36.39671707]
[201.53862000 -24.63946724]
[192.22373962 -12.88221455]
[182.90884399 -1.12496376]
[173.59396362 10.63228798]
[176.24232483 27.24026489]
[165.85510254 40.89384842]
[148.47123718 42.84843445]
[139.33242798 54.74306870]
[130.64260864 66.96955109]
[122.41379547 79.51095581]
[114.18498993 92.05235291]
[113.66068268 108.81842804]
[98.59743500 116.19913483]
[90.55625916 128.86166382]
[82.51509094 141.52418518]
[74.56840515 154.24621582]
[66.71665192 167.02705383]
[66.75276184 171.36901855]
[65.52845001 175.11943054]
[63.38445663 177.95469666]
[60.73161316 179.69511414]
[57.99783707 180.31526184]
[56.42691803 196.05828857]
[42.79130936 202.05157471]
[34.19274521 214.34240723]
[25.59417915 226.63323975]
[27.06654358 239.44709778]
[19.65174866 249.50715637]
[7.76380014 251.74394226]
[-1.01680326 263.90539551]
[-9.79740620 276.06686401]
[-18.57801056 288.22830200]
[-7.48387241 298.34848022]
[2.38431191 309.66735840]
[10.89789104 322.03735352]
[17.94587326 335.29721069]
[23.43637276 349.27404785]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[48 205]
[49 204]
[50 203]
[51 202]
[53 199]
[54 198]
[55 197]
[57 195]
[58 190]
[59 189]
[61 188]
[62 187]
[63 186]
[66 184]
[67 183]
[68 182]
[74 181]
[75 180]
[79 177]
[80 176]
[81 175]
[82 174]
[83 173]
[84 172]
[85 171]
[86 160]
[87 159]
[88 158]
[89 157]
[90 156]
[91 154]
[92 153]
[93 152]
[94 151]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
