%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Jun 17 13:36:04 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
UGACGACACUAAUCCUGCCUAGUCUGCUUCUCCCCGCAAACCAUAACCCAAUACCGUCCCCCAAAAUAUAACUAUUAACAACACUACUUUAACUACCGGGxxxxxxxxxxUCGAUAGGUAACCAGAAUCCGGGGUUUUUAAAACCACGUUGAGGUUUAUUUUCAUUAUUGGUACGUGUGAUGAUAUUGGUGGGAUUGGGACUGAAGGGAU\
) } def
/len { sequence length } bind def

/coor [
[21.67732239 451.56033325]
[27.53593254 465.41641235]
[30.74850655 480.11315918]
[31.20562172 495.14996338]
[28.89171219 510.01470947]
[23.88558960 524.20111084]
[16.35775566 537.22595215]
[6.56461096 548.64562988]
[-5.16029644 558.07116699]
[-18.41761971 565.18157959]
[-32.75582123 569.73468018]
[-47.68654251 571.57537842]
[-62.70125580 570.64099121]
[-77.28855896 566.96331787]
[-90.95161438 560.66760254]
[-103.22506714 551.96838379]
[-113.69088745 541.16186523]
[-121.99261475 528.61608887]
[-127.84748840 514.75842285]
[-131.05610657 500.06082153]
[-131.50917053 485.02386475]
[-129.19125366 470.15975952]
[-124.18129730 455.97473145]
[-116.64995575 442.95193481]
[-106.85372925 431.53488159]
[-95.12628174 422.11248779]
[-81.86704254 415.00564575]
[-67.52761841 410.45642090]
[-52.59640121 408.61975098]
[-37.58193970 409.55819702]
[-22.99563026 413.23980713]
[-16.71826935 399.61648560]
[-10.44090843 385.99316406]
[-4.16354752 372.36984253]
[1.49923933 358.47982788]
[-1.51505017 343.89340210]
[10.40700722 333.49267578]
[15.44392300 319.36364746]
[20.48083878 305.23461914]
[16.39361954 288.16824341]
[30.51982117 276.35586548]
[35.34581757 262.15341187]
[40.17181778 247.95095825]
[39.05516434 245.37973022]
[38.88973236 242.21125793]
[39.90809631 238.80561829]
[42.20832062 235.60038757]
[45.73096466 233.06170654]
[51.39374924 219.17167664]
[57.05653763 205.28164673]
[62.71932220 191.39161682]
[68.38211060 177.50158691]
[73.41902924 163.37255859]
[77.82002258 149.03271484]
[82.11415100 134.66050720]
[86.30116272 120.25672150]
[90.48816681 105.85293579]
[94.56784058 91.41838837]
[98.53993225 76.95386505]
[85.24636841 62.01993942]
[83.68349457 42.23237228]
[94.31211853 25.63978958]
[112.66959381 18.88572693]
[115.77370453 4.21042442]
[118.87781525 -10.46487808]
[121.98192596 -25.14018059]
[125.08603668 -39.81548309]
[128.19013977 -54.49078369]
[123.47614288 -69.59339142]
[133.67974854 -80.44400024]
[128.96575928 -95.54660797]
[139.16935730 -106.39721680]
[142.27346802 -121.07252502]
[128.46940613 -115.20329285]
[115.20201874 -122.20159912]
[112.25151825 -136.90855408]
[121.79291534 -148.48274231]
[136.79264832 -148.39208984]
[146.19306946 -136.70504761]
[150.38008118 -151.10882568]
[154.56709290 -165.51260376]
[158.75410461 -179.91639709]
[147.48164368 -190.14834595]
[141.79269409 -204.20262146]
[142.76600647 -219.27156067]
[150.15504456 -232.36976624]
[162.44760132 -240.92561340]
[177.17492676 -243.28602600]
[181.36193848 -257.68981934]
[185.54895020 -272.09359741]
[189.41325378 -286.58728027]
[192.95292664 -301.16366577]
[196.49259949 -315.74005127]
[190.46078491 -327.14093018]
[193.70907593 -339.20874023]
[203.96942139 -345.61590576]
[207.72572327 -360.13793945]
[211.48202515 -374.66000366]
[215.23832703 -389.18206787]
[201.72010803 -395.80346680]
[189.81170654 -405.01077271]
[180.00074768 -416.42700195]
[172.68898010 -429.58459473]
[168.17582703 -443.94485474]
[166.64610291 -458.91964722]
[168.16244507 -473.89581299]
[172.66275024 -488.26007080]
[179.96275330 -501.42422485]
[189.76350403 -512.84924316]
[201.66366577 -522.06719971]
[215.17596436 -528.70062256]
[229.74705505 -532.47796631]
[244.78025818 -533.24450684]
[259.65997314 -530.96887207]
[273.77691650 -525.74420166]
[286.55297852 -517.78448486]
[297.46496582 -507.41561890]
[306.06610107 -495.06225586]
[312.00411987 -481.23025513]
[315.03588867 -466.48599243]
[315.03726196 -451.43325806]
[312.00817871 -436.68844604]
[306.07266235 -422.85534668]
[297.47378540 -410.50042725]
[286.56362915 -400.12960815]
[273.78903198 -392.16754150]
[259.67303467 -386.94030762]
[244.79373169 -384.66195679]
[229.76039124 -385.42578125]
[226.00408936 -370.90371704]
[222.24778748 -356.38165283]
[218.49148560 -341.85958862]
[224.08499146 -325.22589111]
[211.06896973 -312.20037842]
[207.52929688 -297.62399292]
[203.98962402 -283.04760742]
[205.50198364 -279.86248779]
[205.54672241 -275.78656006]
[203.72198486 -271.51763916]
[199.95272827 -267.90658569]
[195.76571655 -253.50280762]
[191.57870483 -239.09901428]
[202.74566650 -229.21142578]
[208.53607178 -215.39909363]
[207.75199890 -200.38088989]
[200.49549866 -187.13841248]
[188.15887451 -178.32394409]
[173.15789795 -175.72938538]
[168.97088623 -161.32559204]
[164.78387451 -146.92181396]
[160.59686279 -132.51803589]
[156.94877625 -117.96841431]
[153.84466553 -103.29311371]
[158.78068542 -89.24018097]
[148.35505676 -77.33988953]
[153.29107666 -63.28696060]
[142.86544800 -51.38667679]
[139.76133728 -36.71137238]
[136.65722656 -22.03606987]
[133.55311584 -7.36076784]
[130.44900513 7.31453466]
[127.34489441 21.98983765]
[135.79214478 27.95630455]
[141.79531860 36.42440414]
[144.64973450 46.44408798]
[144.00575256 56.88080597]
[139.91134644 66.54395294]
[132.80955505 74.32271576]
[123.49070740 79.31372833]
[113.00445557 80.92595673]
[109.03236389 95.39048004]
[110.10429382 103.37944031]
[104.89195251 110.03994751]
[100.70494080 124.44373322]
[96.51792908 138.84751892]
[97.12752533 147.96157837]
[92.15987396 153.43371582]
[87.75887299 167.77355957]
[101.48352051 161.72096252]
[115.51743317 167.01712036]
[121.82134247 180.62817383]
[116.78408813 194.75708008]
[103.29123688 201.31016541]
[89.07210541 196.53352356]
[82.27214050 183.16438293]
[76.60935211 197.05441284]
[70.94656372 210.94442749]
[65.28377533 224.83445740]
[59.62099075 238.72448730]
[54.37427139 252.77696228]
[49.54827499 266.97940063]
[44.72227859 281.18188477]
[49.71290207 293.07540894]
[45.40093231 304.80532837]
[34.60986710 310.27154541]
[29.57295227 324.40057373]
[24.53603554 338.52960205]
[27.19005203 354.12661743]
[15.62826920 363.51672363]
[29.60949135 358.08300781]
[43.39291763 364.00054932]
[49.08277512 377.87948608]
[43.41965485 391.76937866]
[29.64765167 397.71343994]
[15.65599060 392.30664062]
[9.45976925 378.64721680]
[3.18240809 392.27050781]
[-3.09495258 405.89382935]
[-9.37231350 419.51715088]
[2.90348482 428.21310425]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[31 209]
[32 208]
[33 207]
[34 206]
[35 199]
[37 197]
[38 196]
[39 195]
[41 192]
[42 191]
[43 190]
[48 189]
[49 188]
[50 187]
[51 186]
[52 185]
[53 178]
[54 177]
[55 175]
[56 174]
[57 173]
[58 171]
[59 170]
[63 162]
[64 161]
[65 160]
[66 159]
[67 158]
[68 157]
[70 155]
[72 153]
[73 152]
[79 151]
[80 150]
[81 149]
[82 148]
[88 142]
[89 141]
[90 140]
[91 136]
[92 135]
[93 134]
[96 132]
[97 131]
[98 130]
[99 129]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
