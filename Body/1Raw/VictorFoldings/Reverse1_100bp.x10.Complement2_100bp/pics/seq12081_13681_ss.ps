%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Jun 17 13:30:04 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
CAACAGUCUAAGUGUUAGACUACAAAACCAAUUUGAUAUAAAUGUUCUCCUUUUGGGCCAUUACUACAGCCCCAACUCCCUAUCCUCCUCUUACCCCCUAxxxxxxxxxxGGGAUGAUUUGGGGUAAUUUGCGGACCGUCGGCCUUCGGAUAAGCGUCCUAAAGAGUAAUGAUUGUUGUAAAGGGGGCGUAGGGGGAAGGUUUGUUGUUA\
) } def
/len { sequence length } bind def

/coor [
[29.32537651 412.13546753]
[28.82966614 427.22378540]
[24.28046417 441.61846924]
[16.01535034 454.25137329]
[4.64765167 464.18505859]
[-8.97907257 470.68237305]
[-23.85363007 473.26116943]
[-38.87223053 471.73004150]
[-52.92039108 466.20269775]
[-64.95564270 457.08923340]
[-74.08489990 445.06594849]
[-79.63070679 431.02505493]
[-81.18151855 416.00848389]
[-78.62226868 401.13055420]
[-72.14286041 387.49530029]
[-62.22411346 376.11456299]
[-49.60206223 367.83288574]
[-35.21334839 363.26480103]
[-20.12571144 362.74926758]
[-16.58603859 348.17288208]
[-21.10146713 333.97921753]
[-10.32614040 322.39462280]
[-6.78646851 307.81823730]
[-3.24679589 293.24188232]
[0.29287651 278.66549683]
[3.83254886 264.08911133]
[2.35623956 256.84741211]
[7.53495264 249.32287598]
[11.29125309 234.80081177]
[0.84068722 245.56118774]
[-12.76070118 251.88592529]
[-27.72341728 252.94288635]
[-42.07885361 248.59301758]
[-53.93831253 239.40861511]
[-61.74147415 226.59803772]
[-64.46169281 211.84675598]
[-61.74109268 197.09553528]
[-53.93759918 184.28517151]
[-42.07790375 175.10107422]
[-27.72235298 170.75157166]
[-12.75966644 171.80892944]
[0.84155917 178.13400269]
[11.29184723 188.89465332]
[17.21628189 202.67510986]
[17.83506966 217.66468811]
[24.71448135 204.33525085]
[31.59389496 191.00582886]
[38.47330856 177.67639160]
[45.35271835 164.34696960]
[52.23213196 151.01753235]
[39.39283752 158.77334595]
[24.51932907 160.71722412]
[10.11804962 156.52162170]
[-1.38413012 146.89353943]
[-8.04889107 133.45550537]
[-8.75310326 118.47203827]
[-3.37809587 104.46813965]
[7.17034912 93.80369568]
[21.11463165 88.27586365]
[36.10489655 88.81616974]
[49.61502457 95.33357239]
[59.36831284 106.72977448]
[63.72116852 121.08430481]
[61.93952560 135.97975159]
[71.25440979 124.22250366]
[80.56929016 112.46525574]
[89.88417053 100.70800018]
[92.02349091 92.93652344]
[99.42631531 88.84640503]
[108.91521454 77.22914124]
[118.40411377 65.61187744]
[127.89300537 53.99461365]
[137.38191223 42.37734985]
[122.38788605 42.80075836]
[111.39186096 32.59843063]
[110.69286346 17.61472511]
[120.69129944 6.43299055]
[135.65962219 5.45863056]
[147.02328491 15.24980354]
[148.27296448 30.19677353]
[158.76046753 19.47239494]
[166.61221313 6.69155169]
[171.43821716 -7.51090384]
[176.26422119 -21.71335983]
[181.09020996 -35.91581345]
[184.62988281 -50.49219131]
[186.85499573 -65.32623291]
[189.08012390 -80.16027832]
[183.47555542 -94.95552826]
[193.01522827 -106.39422607]
[194.90852356 -121.27426147]
[196.46903992 -136.19287109]
[198.02957153 -151.11148071]
[199.59008789 -166.03007507]
[201.15061951 -180.94868469]
[202.71113586 -195.86729431]
[204.27166748 -210.78588867]
[190.13017273 -216.02697754]
[177.73683167 -224.62092590]
[167.87069702 -236.02751160]
[161.15197754 -249.52972412]
[158.00300598 -264.27877808]
[158.62171936 -279.34756470]
[162.96923828 -293.78881836]
[170.77227783 -306.69476318]
[181.54031372 -317.25411987]
[194.59648132 -324.80313110]
[209.12004089 -328.86721802]
[224.19804382 -329.19094849]
[238.88265991 -325.75396729]
[252.25080872 -318.77233887]
[263.46215820 -308.68490601]
[271.81195068 -296.12576294]
[276.77529907 -281.88442993]
[278.04025269 -266.85607910]
[275.52722168 -251.98545837]
[269.39422607 -238.20732117]
[260.02679443 -226.38775635]
[248.01374817 -217.26979065]
[234.11024475 -211.42655945]
[219.19026184 -209.22537231]
[217.62974548 -194.30676270]
[216.06921387 -179.38815308]
[214.50869751 -164.46955872]
[212.94816589 -149.55094910]
[211.38764954 -134.63233948]
[209.82713318 -119.71373749]
[211.75146484 -116.75920868]
[212.34034729 -112.72581482]
[211.10229492 -108.25138092]
[207.84927368 -104.16911316]
[213.61299133 -90.43489075]
[203.91416931 -77.93515778]
[201.68904114 -63.10111618]
[199.46392822 -48.26707458]
[209.37309265 -59.52800369]
[223.15289307 -65.45394897]
[238.14268494 -64.90071106]
[251.44818115 -57.97509766]
[260.50027466 -46.01434326]
[263.55114746 -31.32788467]
[260.01174927 -16.75144386]
[250.56547546 -5.09950256]
[237.03623962 1.37813079]
[222.03633118 1.43072665]
[208.46199036 -4.95186996]
[198.93423462 -16.53728104]
[195.29266357 -31.08981705]
[190.46667480 -16.88736153]
[185.64067078 -2.68490624]
[180.81468201 11.51754951]
[191.44546509 0.93519700]
[203.91409302 -7.40346336]
[217.75440979 -13.18668556]
[232.44898987 -16.19825745]
[247.44844055 -16.32559204]
[262.19201660 -13.56392670]
[276.12854004 -8.01651001]
[288.73693848 0.10926561]
[299.54586792 10.50961113]
[308.15121460 22.79570198]
[314.23126221 36.50821304]
[317.55871582 51.13449478]
[318.00915527 66.12773132]
[315.56576538 80.92738342]
[310.31988525 94.98017120]
[302.46762085 107.76070404]
[292.30255127 118.79117584]
[280.20471191 127.65921021]
[266.62634277 134.03326416]
[252.07514954 137.67504883]
[237.09510803 138.44841003]
[222.24624634 136.32441711]
[208.08370972 131.38249207]
[195.13697815 123.80740356]
[183.89006042 113.88233185]
[174.76345825 101.97834015]
[168.09834290 88.54047394]
[164.14392090 74.07110596]
[163.04801941 59.11119080]
[164.85162354 44.22002029]
[169.48484802 29.95989609]
[158.99734497 40.68427658]
[148.99917603 51.86624908]
[139.51026917 63.48351288]
[130.02137756 75.10077667]
[120.53247833 86.71804047]
[111.04357910 98.33530426]
[101.64142609 110.02288055]
[92.32654572 121.78013611]
[83.01165771 133.53738403]
[73.69677734 145.29463196]
[65.56156158 157.89695740]
[58.68214798 171.22637939]
[51.80273438 184.55580139]
[44.92332458 197.88523865]
[38.04391098 211.21466064]
[31.16449928 224.54409790]
[25.81331253 238.55711365]
[22.05701256 253.07917786]
[18.40892410 267.62878418]
[14.86925220 282.20516968]
[11.32957935 296.78155518]
[7.78990698 311.35791016]
[4.25023460 325.93429565]
[8.51248169 341.17056274]
[-2.00966287 351.71255493]
[-5.54933548 366.28894043]
[7.62154007 373.66665649]
[18.31270790 384.32504272]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[19 208]
[20 207]
[22 205]
[23 204]
[24 203]
[25 202]
[26 201]
[28 200]
[29 199]
[45 198]
[46 197]
[47 196]
[48 195]
[49 194]
[50 193]
[64 192]
[65 191]
[66 190]
[67 189]
[69 188]
[70 187]
[71 186]
[72 185]
[73 184]
[80 183]
[81 182]
[82 151]
[83 150]
[84 149]
[85 148]
[86 135]
[87 134]
[88 133]
[90 131]
[91 127]
[92 126]
[93 125]
[94 124]
[95 123]
[96 122]
[97 121]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
