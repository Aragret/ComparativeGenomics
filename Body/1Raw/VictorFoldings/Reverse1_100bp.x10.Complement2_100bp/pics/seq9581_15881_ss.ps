%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Jun 17 13:32:02 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
AAACCAAAGCCAACAAAAGAUAAUCUGAUACCACUCGAGUCCACUAACUAUGAGGACUACGCUCAUUAUGCCUACACAAAUCCUCACCCUGAAGAUCCCCxxxxxxxxxxCCCGGACAGGAACAUCAUAUUUGAUUAUGUGGUCAGAACAUUUGGCCUCUACUUUUGGAAAAAGGUUCCUGUUUAGUCUCUUUUUCAGAAAUUGAGGUGG\
) } def
/len { sequence length } bind def

/coor [
[171.73341370 286.43673706]
[180.18443298 274.01760864]
[190.18421936 262.80780029]
[201.56167603 252.99922180]
[193.33287048 240.45780945]
[185.10404968 227.91641235]
[176.87524414 215.37501526]
[168.64643860 202.83361816]
[159.77554321 190.73786926]
[150.28665161 179.12060547]
[140.79774475 167.50334167]
[131.30885315 155.88607788]
[121.81995392 144.26881409]
[119.24124908 159.04548645]
[107.04895020 167.78321838]
[92.22736359 165.47662354]
[83.26695251 153.44703674]
[85.30065918 138.58554077]
[97.16348267 129.40547180]
[112.05902100 131.16514587]
[103.64440155 118.74765778]
[89.43536377 115.91052246]
[81.30710602 103.91561890]
[83.93810272 89.66696167]
[75.52348328 77.24946594]
[67.10886383 64.83197021]
[58.69424438 52.41447830]
[52.92223740 49.19027710]
[50.07273483 44.27322769]
[50.22040939 39.49962997]
[42.17923355 26.83710670]
[34.13806152 14.17458057]
[26.09688950 1.51205599]
[18.05571556 -11.15046883]
[8.48059559 -22.69676971]
[-2.47531343 -32.94216156]
[-18.04814529 -32.58906174]
[-29.01304436 -43.13541794]
[-29.25370216 -57.98390579]
[-40.20961380 -68.22930145]
[-51.16552353 -78.47469330]
[-62.12142944 -88.72008514]
[-73.27742767 -78.67890930]
[-85.25531769 -69.63393402]
[-97.96642303 -61.65213013]
[-111.31663513 -54.79259109]
[-125.20711517 -49.10610199]
[-139.53500366 -44.63476944]
[-154.19424438 -41.41169357]
[-169.07629395 -39.46073532]
[-184.07095337 -38.79634476]
[-199.06723022 -39.42343903]
[-213.95408630 -41.33737183]
[-228.62129211 -44.52397537]
[-242.96026611 -48.95965958]
[-256.86483765 -54.61157990]
[-270.23205566 -61.43788910]
[-282.96298218 -69.38805389]
[-294.96334839 -78.40320587]
[-306.14428711 -88.41660309]
[-316.42303467 -99.35410309]
[-325.72344971 -111.13473511]
[-333.97674561 -123.67127228]
[-341.12176514 -136.87089539]
[-347.10562134 -150.63587952]
[-351.88400269 -164.86431885]
[-355.42156982 -179.45086670]
[-357.69207764 -194.28752136]
[-358.67874146 -209.26443481]
[-358.37423706 -224.27072144]
[-356.78088379 -239.19528198]
[-353.91040039 -253.92761230]
[-349.78405762 -268.35864258]
[-344.43243408 -282.38156128]
[-337.89514160 -295.89248657]
[-330.22055054 -308.79141235]
[-321.46554565 -320.98284912]
[-311.69488525 -332.37649536]
[-300.98092651 -342.88806152]
[-289.40301514 -352.43966675]
[-277.04684448 -360.96060181]
[-264.00390625 -368.38781738]
[-250.37075806 -374.66625977]
[-236.24836731 -379.74951172]
[-221.74125671 -383.59988403]
[-206.95686340 -386.18890381]
[-192.00462341 -387.49737549]
[-176.99525452 -387.51565552]
[-162.03988647 -386.24356079]
[-147.24923706 -383.69052124]
[-132.73280334 -379.87545776]
[-118.59807587 -374.82659912]
[-104.94969940 -368.58132935]
[-91.88873291 -361.18591309]
[-79.51186371 -352.69503784]
[-67.91073608 -343.17163086]
[-57.17123413 -332.68618774]
[-47.37287521 -321.31634521]
[-38.58820724 -309.14624023]
[-30.88226700 -296.26602173]
[-24.31210899 -282.77105713]
[-18.92637444 -268.76123047]
[-14.76494026 -254.34027100]
[-11.85861588 -239.61495972]
[-10.22891998 -224.69432068]
[-9.88791752 -209.68882751]
[-10.83813381 -194.70954895]
[-13.07253265 -179.86741638]
[-16.57457352 -165.27230835]
[-21.31832504 -151.03228760]
[-27.26866722 -137.25277710]
[-34.38154602 -124.03580475]
[-42.60429382 -111.47921753]
[-51.87603760 -99.67599487]
[-40.92013168 -89.43060303]
[-29.96422005 -79.18521118]
[-19.00831223 -68.93981934]
[-4.17702436 -69.69381714]
[7.07977533 -59.45960236]
[7.77007818 -43.89807129]
[18.72598839 -33.65267944]
[13.94591045 -47.87065506]
[13.97554016 -62.87062836]
[18.81174850 -77.06961060]
[27.94416046 -88.96914673]
[40.40900803 -97.31346130]
[54.89085007 -101.22195435]
[69.86138153 -100.28214264]
[83.74072266 -94.59322357]
[95.06415558 -84.75555420]
[102.63669586 -71.80731964]
[105.65919495 -57.11499405]
[103.81267548 -42.22908401]
[97.29200745 -28.72053337]
[86.78533173 -18.01493645]
[73.40145111 -11.24207878]
[58.55278397 -9.11671638]
[43.80635834 -11.86314297]
[30.71824074 -19.19164276]
[38.75941467 -6.52911711]
[46.80058670 6.13340807]
[54.84175873 18.79593277]
[62.88293076 31.45845795]
[71.11174011 43.99985886]
[79.52635956 56.41735458]
[87.94097900 68.83484650]
[96.35559845 81.25234222]
[110.56463623 84.08947754]
[118.69289398 96.08438110]
[116.06189728 110.33303833]
[124.47651672 122.75053406]
[133.43721008 134.77990723]
[142.92611694 146.39717102]
[152.41500854 158.01443481]
[161.90391541 169.63169861]
[171.39280701 181.24896240]
[172.81042480 166.31610107]
[183.40640259 155.69888306]
[198.33639526 154.25135803]
[210.77461243 162.63531494]
[215.03446960 177.01773071]
[209.16841125 190.82313538]
[195.85833740 197.73991394]
[181.18783569 194.60481262]
[189.41664124 207.14620972]
[197.64546204 219.68760681]
[205.87426758 232.22900391]
[214.10307312 244.77040100]
[227.63031006 238.23826599]
[241.89443970 233.52770996]
[256.65142822 230.71936035]
[271.64871216 229.86126709]
[286.62969971 230.96812439]
[301.33804321 234.02096558]
[315.52203369 238.96757507]
[328.93899536 245.72331238]
[341.35937500 254.17256165]
[352.57055664 264.17074585]
[362.38079834 275.54678345]
[370.62216187 288.10604858]
[377.15368652 301.63360596]
[381.86355591 315.89794922]
[384.67120361 330.65505981]
[385.52856445 345.65240479]
[384.42102051 360.63333130]
[381.36746216 375.34152222]
[376.42016602 389.52529907]
[369.66378784 402.94192505]
[361.21395874 415.36187744]
[351.21524048 426.57263184]
[339.83871460 436.38229370]
[327.27908325 444.62307739]
[313.75122070 451.15393066]
[299.48663330 455.86312866]
[284.72940063 458.67007446]
[269.73202515 459.52673340]
[254.75114441 458.41845703]
[240.04310608 455.36422729]
[225.85955811 450.41625977]
[212.44323730 443.65924072]
[200.02368164 435.20883179]
[188.81343079 425.20956421]
[179.00428772 413.83258057]
[170.76411438 401.27255249]
[164.23388672 387.74438477]
[159.52537537 373.47955322]
[156.71913147 358.72219849]
[155.86318970 343.72479248]
[156.97218323 328.74395752]
[160.02713013 314.03604126]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[4 168]
[5 167]
[6 166]
[7 165]
[8 164]
[9 156]
[10 155]
[11 154]
[12 153]
[13 152]
[20 151]
[21 150]
[24 147]
[25 146]
[26 145]
[27 144]
[30 143]
[31 142]
[32 141]
[33 140]
[34 139]
[35 121]
[36 120]
[39 117]
[40 116]
[41 115]
[42 114]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
