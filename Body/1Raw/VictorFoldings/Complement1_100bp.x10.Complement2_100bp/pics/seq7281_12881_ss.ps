%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Jun 17 13:29:50 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
AAAGAGAUUGUCGUCAUUAUAAUUAUUAAAAGUACUAAACUCUUCGGAAGCGAAGCUUCGCUUUUCAGGAUUAUCAUCUUCUUGGGAGGUAUUUGGACCUxxxxxxxxxxGUAGGAGCGGAAUCGUACUAAAUAGGAUGUGAGGUUGAGUACUCUGGGUGUUGUUUAUCGGGAAGAUUUGCGAUUAGGUUCGGAGUGGGGUGAUGAUCCG\
) } def
/len { sequence length } bind def

/coor [
[90.86683655 446.76498413]
[80.86849213 457.96902466]
[69.65813446 467.96029663]
[57.38190079 476.60855103]
[44.19985199 483.80099487]
[30.28383636 489.44387817]
[15.81527710 493.46365356]
[0.98280311 495.80789185]
[-14.02021408 496.44604492]
[-28.99817848 495.36981201]
[-43.75582504 492.59317017]
[-58.10075378 488.15237427]
[-71.84594727 482.10525513]
[-84.81221771 474.53073120]
[-96.83051300 465.52749634]
[-107.74415588 455.21292114]
[-117.41085815 443.72152710]
[-125.70460510 431.20306396]
[-132.51727295 417.82077026]
[-137.76002502 403.74914551]
[-141.36451721 389.17156982]
[-143.28376770 374.27813721]
[-143.49275208 359.26300049]
[-141.98875427 344.32192993]
[-138.79136658 329.64971924]
[-133.94227600 315.43759155]
[-127.50469971 301.87088013]
[-119.56256866 289.12646484]
[-110.21942902 277.37048340]
[-99.59708405 266.75616455]
[-87.83401489 257.42193604]
[-75.08358002 249.48945618]
[-61.51200867 243.06214905]
[-47.29623032 238.22381592]
[-32.62157822 235.03753662]
[-17.67936897 233.54484558]
[-2.66440320 233.76519775]
[12.22756863 235.69573975]
[26.80239868 239.31126404]
[32.04911804 225.25880432]
[37.29583359 211.20632935]
[42.54255295 197.15385437]
[29.34197426 204.27738953]
[14.46046638 202.39570618]
[3.44846463 192.21063232]
[0.41317359 177.52093506]
[6.48668146 163.80552673]
[19.40371895 156.17990112]
[34.34655380 157.48823547]
[45.74187469 167.24255371]
[49.33942795 181.80589294]
[56.21884155 168.47647095]
[63.09825516 155.14703369]
[69.97766876 141.81761169]
[68.93915558 126.95925140]
[82.14388275 118.24456024]
[89.02329254 104.91513062]
[95.70349121 91.48475647]
[102.18298340 77.95641327]
[108.66248322 64.42806244]
[115.14197540 50.89971924]
[102.16265106 58.41883469]
[87.17985535 59.13709259]
[73.54078674 52.89403152]
[64.29244995 41.08436584]
[61.50094223 26.34640312]
[65.78989410 11.97264671]
[76.20114899 1.17422795]
[90.40879822 -3.63645864]
[105.23881531 -1.38469362]
[117.37815094 7.42647314]
[124.11483002 20.82860565]
[123.94386292 35.82765198]
[122.47149658 23.01379395]
[129.88629150 12.95374584]
[141.77424622 10.71695137]
[150.55484009 -1.44450414]
[159.33544922 -13.60595989]
[168.11605835 -25.76741600]
[176.89665222 -37.92887115]
[185.67726135 -50.09032822]
[194.45785522 -62.25178146]
[203.23846436 -74.41323853]
[212.01907349 -86.57469177]
[200.52568054 -96.22375488]
[189.76728821 -106.68604279]
[179.80130005 -117.90573883]
[170.68089294 -129.82296753]
[162.45472717 -142.37416077]
[155.16667175 -155.49235535]
[148.85565186 -169.10754395]
[143.55529785 -183.14707947]
[139.29393005 -197.53607178]
[136.09425354 -212.19773865]
[133.97334290 -227.05386353]
[132.94253540 -242.02516174]
[133.00732422 -257.03176880]
[134.16734314 -271.99362183]
[136.41642761 -286.83087158]
[139.74255371 -301.46435547]
[144.12800598 -315.81600952]
[149.54936218 -329.80926514]
[155.97770691 -343.36947632]
[163.37872314 -356.42425537]
[171.71295166 -368.90396118]
[180.93591309 -380.74200439]
[190.99838257 -391.87524414]
[201.84671021 -402.24426270]
[213.42297363 -411.79373169]
[225.66542053 -420.47271729]
[238.50874329 -428.23489380]
[251.88441467 -435.03887939]
[265.72106934 -440.84832764]
[279.94485474 -445.63226318]
[294.47991943 -449.36514282]
[309.24868774 -452.02709961]
[324.17236328 -453.60388184]
[339.17132568 -454.08709717]
[354.16552734 -453.47415161]
[369.07501221 -451.76834106]
[383.82022095 -448.97875977]
[398.32241821 -445.12026978]
[412.50430298 -440.21347046]
[426.29019165 -434.28454590]
[439.60650635 -427.36514282]
[452.38220215 -419.49215698]
[464.54913330 -410.70761108]
[476.04235840 -401.05838013]
[486.80056763 -390.59588623]
[496.76638794 -379.37603760]
[505.88659668 -367.45864868]
[514.11254883 -354.90731812]
[521.40039062 -341.78903198]
[527.71118164 -328.17373657]
[533.01129150 -314.13409424]
[537.27246094 -299.74502563]
[540.47186279 -285.08331299]
[542.59252930 -270.22717285]
[543.62310791 -255.25585938]
[543.55810547 -240.24925232]
[542.39782715 -225.28742981]
[540.14849854 -210.45021057]
[536.82208252 -195.81677246]
[532.43640137 -181.46517944]
[527.01483154 -167.47200012]
[520.58630371 -153.91191101]
[513.18505859 -140.85725403]
[504.85061646 -128.37768555]
[495.62744141 -116.53978729]
[485.56478882 -105.40672302]
[474.71630859 -95.03787994]
[463.13989258 -85.48860168]
[450.89727783 -76.80981445]
[438.05383301 -69.04784393]
[424.67807007 -62.24409866]
[410.84130859 -56.43487930]
[396.61746216 -51.65117645]
[382.08233643 -47.91851807]
[367.31350708 -45.25681686]
[352.38983154 -43.68027878]
[337.39083862 -43.19730759]
[322.39663696 -43.81048965]
[307.48718262 -45.51654816]
[292.74203491 -48.30638123]
[278.23986816 -52.16510391]
[264.05807495 -57.07212830]
[250.27229309 -63.00127029]
[236.95610046 -69.92089844]
[224.18052673 -77.79409027]
[215.39991760 -65.63263702]
[206.61932373 -53.47117996]
[197.83871460 -41.30972290]
[189.05810547 -29.14826775]
[180.27751160 -16.98681259]
[171.49690247 -4.82535648]
[162.71630859 7.33609915]
[153.93569946 19.49755478]
[153.09664917 37.02647018]
[136.23469543 44.42621613]
[128.67031860 57.37921524]
[122.19082642 70.90756226]
[115.71133423 84.43590546]
[109.23183441 97.96424866]
[109.80952454 103.17771912]
[107.42508698 108.34374237]
[102.35272217 111.79454041]
[95.47331238 125.12397003]
[96.01976013 140.93574524]
[83.30709839 148.69702148]
[76.42768097 162.02644348]
[69.54827118 175.35588074]
[62.66885757 188.68530273]
[56.59502411 202.40057373]
[51.34830475 216.45304871]
[46.10158920 230.50552368]
[40.85486984 244.55798340]
[54.23284912 251.37908936]
[66.74606323 259.68072510]
[78.23137665 269.35467529]
[88.53904724 280.27484131]
[97.53470612 292.29879761]
[105.10106659 305.26983643]
[111.13948822 319.01885986]
[115.57124329 333.36657715]
[118.33856964 348.12597656]
[119.40537262 363.10461426]
[118.75775146 378.10723877]
[116.40415192 392.93823242]
[112.37525177 407.40423584]
[106.72357941 421.31668091]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[39 196]
[40 195]
[41 194]
[42 193]
[51 192]
[52 191]
[53 190]
[54 189]
[56 187]
[57 186]
[58 183]
[59 182]
[60 181]
[61 180]
[73 179]
[76 177]
[77 176]
[78 175]
[79 174]
[80 173]
[81 172]
[82 171]
[83 170]
[84 169]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
