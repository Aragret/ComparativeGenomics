%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Jun 17 13:35:52 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
UUAGUUGUGGGAGGAUCGGAAUGAUGAUUAUUAAUAAUGUAAAACUGAUGGUGUUGAGUUGCCGAUGUAUCUUUUUAGGUGGGGAAUGCUCACGCCGAAGxxxxxxxxxxGGUGAUACGUGUAAAAUAAAGAGGUUGUAUGAGCCUAAGAUGGGAUCGUAGUGUGUGGCGUGUUAGGGGAUAGAUCCGGAAGAAUGCUCGGUUUUGGACG\
) } def
/len { sequence length } bind def

/coor [
[12.98191452 425.80007935]
[13.02014542 440.82183838]
[11.09725475 455.72009277]
[7.24614716 470.23986816]
[1.53271949 484.13275146]
[-5.94526386 497.16098022]
[-15.05984402 509.10162354]
[-25.65505981 519.75042725]
[-37.54961395 528.92510986]
[-50.53997040 536.46868896]
[-64.40385437 542.25207520]
[-78.90402985 546.17633057]
[-93.79238129 548.17431641]
[-108.81415558 548.21185303]
[-123.71230316 546.28826904]
[-138.23188782 542.43646240]
[-152.12449646 536.72235107]
[-165.15235901 529.24377441]
[-177.09259033 520.12860107]
[-187.74085999 509.53286743]
[-196.91497803 497.63787842]
[-204.45793152 484.64718628]
[-210.24067688 470.78302002]
[-214.16426086 456.28265381]
[-216.16154480 441.39419556]
[-216.19834900 426.37243652]
[-214.27403259 411.47436523]
[-210.42153931 396.95495605]
[-204.70680237 383.06265259]
[-197.22756958 370.03512573]
[-188.11186218 358.09533691]
[-177.51562500 347.44757080]
[-165.62019348 338.27401733]
[-152.62911987 330.73168945]
[-138.76469421 324.94958496]
[-124.26414490 321.02670288]
[-109.37559509 319.03012085]
[-94.35382080 318.99404907]
[-79.45585632 320.91906738]
[-64.93663025 324.77224731]
[-51.04457855 330.48764038]
[-43.57683945 317.47869873]
[-36.10909653 304.46975708]
[-28.64135551 291.46078491]
[-21.17361450 278.45184326]
[-13.70587349 265.44290161]
[-6.23813248 252.43394470]
[1.22960877 239.42498779]
[0.86892980 234.66275024]
[3.49603462 229.62336731]
[9.11831570 226.14463806]
[16.97007179 213.36380005]
[24.82182693 200.58296204]
[32.67358398 187.80212402]
[40.52533722 175.02127075]
[40.06605911 171.52536011]
[41.27724075 167.63330078]
[44.32662964 164.13265991]
[49.02389908 161.85609436]
[57.43851852 149.43859863]
[58.17300415 134.56211853]
[72.31974030 127.47830963]
[80.73435974 115.06081390]
[89.14897919 102.64331818]
[97.47092438 90.16352081]
[105.69972992 77.62212372]
[106.80122375 61.83930969]
[120.25234985 55.44270325]
[128.48115540 42.90130234]
[136.70996094 30.35990334]
[144.93876648 17.81850243]
[131.58189392 24.64445877]
[116.66880035 26.25688934]
[102.16159058 22.44364929]
[89.96892548 13.70643711]
[81.69495392 1.19478345]
[78.42827606 -13.44518852]
[80.59866333 -28.28733826]
[87.92056274 -41.37892532]
[99.43067169 -50.99752808]
[113.61461639 -55.87765503]
[128.60626221 -55.37723541]
[142.43321228 -49.56211472]
[153.27627563 -39.19736862]
[159.70886230 -25.64665985]
[160.88467407 -10.69281483]
[156.64791870 3.69885302]
[161.21769714 -11.44801807]
[175.75149536 -14.70654774]
[186.55364990 -25.11392021]
[197.19966125 -35.68096924]
[207.68714905 -46.40534973]
[218.17465210 -57.12972641]
[228.66215515 -67.85411072]
[239.14965820 -78.57849121]
[249.63716125 -89.30286407]
[260.12466431 -100.02724457]
[250.37658691 -111.44132233]
[241.69090271 -123.68327332]
[234.13757324 -136.65452576]
[227.77737427 -150.25064087]
[222.66156006 -164.36213684]
[218.83128357 -178.87542725]
[216.31741333 -193.67361450]
[215.14016724 -208.63758850]
[215.30903625 -223.64683533]
[216.82266235 -238.58053589]
[219.66883850 -253.31842041]
[223.82467651 -267.74185181]
[229.25669861 -281.73468018]
[235.92117310 -295.18426514]
[243.76445007 -307.98226929]
[252.72335815 -320.02572632]
[262.72576904 -331.21759033]
[273.69116211 -341.46777344]
[285.53125000 -350.69375610]
[298.15066528 -358.82125854]
[311.44784546 -365.78482056]
[325.31570435 -371.52841187]
[339.64257812 -376.00573730]
[354.31314087 -379.18078613]
[369.20925903 -381.02798462]
[384.21099854 -381.53244019]
[399.19754028 -380.69012451]
[414.04824829 -378.50781250]
[428.64355469 -375.00305176]
[442.86593628 -370.20407104]
[456.60089111 -364.14950562]
[469.73779297 -356.88812256]
[482.17089844 -348.47836304]
[493.80010986 -338.98797607]
[504.53179932 -328.49334717]
[514.27954102 -317.07897949]
[522.96484375 -304.83676147]
[530.51776123 -291.86526489]
[536.87756348 -278.26895142]
[541.99291992 -264.15731812]
[545.82275391 -249.64390564]
[548.33618164 -234.84562683]
[549.51300049 -219.88162231]
[549.34362793 -204.87237549]
[547.82958984 -189.93873596]
[544.98291016 -175.20092773]
[540.82666016 -160.77761841]
[535.39422607 -146.78495789]
[528.72930908 -133.33558655]
[520.88568115 -120.53780365]
[511.92639160 -108.49465179]
[501.92364502 -97.30308533]
[490.95791626 -87.05323029]
[479.11755371 -77.82760620]
[466.49789429 -69.70049286]
[453.20050049 -62.73732758]
[439.33245850 -56.99417496]
[425.00543213 -52.51727295]
[410.33477783 -49.34267426]
[395.43862915 -47.49593735]
[380.43688965 -46.99192810]
[365.45034790 -47.83470535]
[350.59970093 -50.01748657]
[336.00451660 -53.52269363]
[321.78228760 -58.32210922]
[308.04751587 -64.37708282]
[294.91082764 -71.63887024]
[282.47796631 -80.04899597]
[270.84902954 -89.53974915]
[260.36154175 -78.81536865]
[249.87403870 -68.09098816]
[239.38653564 -57.36660767]
[228.89903259 -46.64222717]
[218.41152954 -35.91784668]
[207.92404175 -25.19346809]
[207.08065796 -20.49264145]
[203.27529907 -16.27171135]
[196.96101379 -14.31176472]
[186.15885925 -3.90439129]
[182.36172485 10.49807549]
[167.05528259 14.50100994]
[157.48016357 26.04731178]
[149.25135803 38.58871078]
[141.02255249 51.13011169]
[132.79374695 63.67151260]
[132.28083801 78.55728149]
[118.24112701 85.85092926]
[110.01232147 98.39233398]
[108.57487488 106.32367706]
[101.56647491 111.05793762]
[93.15185547 123.47543335]
[84.73723602 135.89292908]
[83.40088654 151.65759277]
[69.85601807 157.85322571]
[61.44139481 170.27072144]
[53.30617905 182.87303162]
[45.45442581 195.65386963]
[37.60266876 208.43470764]
[29.75091362 221.21556091]
[21.89915848 233.99639893]
[14.23856163 246.89273071]
[6.77082014 259.90167236]
[-0.69692117 272.91064453]
[-8.16466236 285.91958618]
[-15.63240337 298.92852783]
[-23.10014534 311.93750000]
[-30.56788635 324.94644165]
[-38.03562546 337.95538330]
[-26.09453011 347.06939697]
[-15.44525051 357.66412354]
[-6.27001047 369.55822754]
[1.27418864 382.54821777]
[7.05825615 396.41183472]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[41 205]
[42 204]
[43 203]
[44 202]
[45 201]
[46 200]
[47 199]
[48 198]
[51 197]
[52 196]
[53 195]
[54 194]
[55 193]
[59 192]
[60 191]
[62 189]
[63 188]
[64 187]
[65 185]
[66 184]
[68 182]
[69 181]
[70 180]
[71 179]
[87 178]
[89 176]
[90 175]
[91 172]
[92 171]
[93 170]
[94 169]
[95 168]
[96 167]
[97 166]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
