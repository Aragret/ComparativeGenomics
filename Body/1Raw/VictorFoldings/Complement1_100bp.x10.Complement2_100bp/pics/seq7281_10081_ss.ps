%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Jun 17 13:35:02 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
AAAGAGAUUGUCGUCAUUAUAAUUAUUAAAAGUACUAAACUCUUCGGAAGCGAAGCUUCGCUUUUCAGGAUUAUCAUCUUCUUGGGAGGUAUUUGGACCUxxxxxxxxxxUUAGUUGUGGGAGGAUCGGAAUGAUGAUUAUUAAUAAUGUAAAACUGAUGGUGUUGAGUUGCCGAUGUAUCUUUUUAGGUGGGGAAUGCUCACGCCGAAG\
) } def
/len { sequence length } bind def

/coor [
[-26.99536705 336.60153198]
[-19.37262726 349.55044556]
[-13.67037773 363.45242310]
[-10.00470924 378.02444458]
[-8.45024967 392.96981812]
[-9.03864670 407.98431396]
[-11.75792122 422.76220703]
[-16.55271149 437.00265503]
[-23.32540131 450.41577148]
[-31.93811035 462.72845459]
[-42.21549225 473.69003296]
[-53.94831085 483.07733154]
[-66.89770508 490.69927979]
[-80.80004120 496.40066528]
[-95.37228394 500.06542969]
[-110.31776428 501.61895752]
[-125.33219910 501.02963257]
[-140.10993958 498.30944824]
[-154.35009766 493.51379395]
[-167.76278687 486.74026489]
[-180.07493591 478.12680054]
[-191.03587341 467.84872437]
[-200.42245483 456.11532593]
[-208.04359436 443.16546631]
[-213.74412537 429.26278687]
[-217.40798950 414.69030762]
[-218.96060181 399.74472046]
[-218.37034607 384.73031616]
[-215.64924622 369.95275879]
[-210.85269165 355.71289062]
[-204.07833862 342.30062866]
[-195.46411133 329.98901367]
[-185.18536377 319.02871704]
[-173.45138550 309.64285278]
[-160.50105286 302.02252197]
[-146.59800720 296.32284546]
[-132.02531433 292.65988159]
[-117.07964325 291.10818481]
[-102.06527710 291.69937134]
[-87.28787994 294.42138672]
[-73.04830933 299.21884155]
[-59.63645935 305.99401855]
[-51.03789520 293.70318604]
[-42.43933105 281.41235352]
[-33.84076691 269.12149048]
[-25.24220467 256.83065796]
[-25.49258804 253.31361389]
[-24.05189323 249.50054932]
[-20.79955101 246.18760681]
[-15.97510433 244.19467163]
[-6.83630180 232.30003357]
[2.30250049 220.40541077]
[3.66307926 202.90924072]
[20.73786926 196.01481628]
[29.69856644 183.98544312]
[38.65926361 171.95606995]
[47.53015900 159.86032104]
[56.31076050 147.69885254]
[65.09136200 135.53739929]
[66.26844788 120.68938446]
[80.61982727 114.02991486]
[89.40042877 101.86845398]
[95.26939392 88.06427765]
[90.10782623 73.10871887]
[99.98384094 61.95912170]
[102.64963531 47.19790649]
[105.31542969 32.43668747]
[107.98123169 17.67547226]
[99.23867798 4.78339624]
[102.15245056 -10.14860153]
[114.49695587 -18.40383720]
[117.16275024 -33.16505432]
[118.50098419 -48.10523987]
[118.50098419 -63.10523987]
[118.50098419 -78.10523987]
[118.50098419 -93.10523987]
[118.50098419 -108.10523987]
[118.50098419 -123.10523987]
[118.38932037 -138.10482788]
[118.16599274 -153.10316467]
[117.94266510 -168.10150146]
[103.01795959 -169.79904175]
[88.43288422 -173.39122009]
[74.42692566 -178.81906128]
[61.23007584 -185.99342346]
[49.05904388 -194.79650879]
[38.11368942 -205.08375549]
[28.57374001 -216.68624878]
[20.59585381 -229.41345215]
[14.31103516 -243.05638123]
[9.82248592 -257.39099121]
[7.20391083 -272.18191528]
[6.49831009 -287.18624878]
[7.71727085 -302.15765381]
[10.84077644 -316.85021973]
[15.81753540 -331.02273560]
[22.56582451 -344.44247437]
[30.97483253 -356.88903809]
[40.90647507 -368.15805054]
[52.19766617 -378.06448364]
[64.66299438 -386.44564819]
[78.09776306 -393.16394043]
[92.28136444 -398.10900879]
[106.98089600 -401.19964600]
[121.95497131 -402.38516235]
[136.95770264 -401.64602661]
[151.74273682 -398.99438477]
[166.06729126 -394.47381592]
[179.69612122 -388.15850830]
[192.40547180 -380.15219116]
[203.98660278 -370.58633423]
[214.24935913 -359.61801147]
[223.02522278 -347.42733765]
[230.17007446 -334.21450806]
[235.56660461 -320.19644165]
[239.12617493 -305.60336304]
[240.79034424 -290.67489624]
[240.53179932 -275.65621948]
[238.35476685 -260.79388428]
[234.29499817 -246.33197021]
[228.41915894 -232.50798035]
[220.82374573 -219.54888916]
[211.63348389 -207.66749573]
[200.99926758 -197.05892944]
[189.09573364 -187.89736938]
[176.11834717 -180.33325195]
[162.28019714 -174.49081421]
[147.80854797 -170.46597290]
[132.94099426 -168.32482910]
[133.16432190 -153.32649231]
[133.38764954 -138.32815552]
[136.63038635 -131.68688965]
[133.50099182 -123.10523987]
[133.50099182 -108.10523987]
[133.50099182 -93.10523987]
[133.50099182 -78.10523987]
[133.50099182 -63.10523987]
[133.50099182 -48.10523987]
[141.63005066 -60.71151733]
[154.37834167 -68.61601257]
[169.28436279 -70.29249573]
[183.46998596 -65.41725922]
[194.19621277 -54.93163300]
[199.39193726 -40.86023331]
[198.05398560 -25.92002296]
[190.44067383 -12.99572468]
[178.02201843 -4.58281565]
[163.19587708 -2.30569792]
[148.82492065 -6.60404778]
[137.68397522 -16.64792061]
[131.92396545 -30.49925804]
[129.25817871 -15.73804092]
[137.93536377 -3.68640327]
[135.44213867 11.32154560]
[122.74244690 20.34126663]
[120.07665253 35.10248566]
[117.41085052 49.86370087]
[114.74505615 64.62491608]
[120.09730530 78.52465820]
[110.03060913 90.73007965]
[118.97399139 78.68782043]
[130.06770325 68.59180450]
[142.89700317 60.81948090]
[156.98225403 55.66141510]
[171.79687500 53.31045532]
[186.78701782 53.85448456]
[201.39224243 57.27317047]
[215.06652832 63.43869781]
[227.29866028 72.12056732]
[237.63133240 82.99420166]
[245.67823792 95.65308380]
[251.13856506 109.62394714]
[253.80813599 124.38447571]
[253.58717346 139.38284302]
[250.48393250 154.05833435]
[244.61442566 167.86227417]
[236.19810486 180.27861023]
[225.54959106 190.84315491]
[213.06701660 199.16091919]
[199.21702576 204.92094421]
[184.51744080 207.90789795]
[169.51777649 208.01010132]
[154.77885437 205.22375488]
[140.85165405 199.65299988]
[128.25688171 191.50611877]
[117.46539307 181.08767700]
[108.88063812 168.78718567]
[102.82357025 155.06451416]
[99.52062225 140.43267822]
[99.09529114 125.43871307]
[101.56188965 110.64906311]
[92.78128052 122.81051636]
[90.97615051 138.52841187]
[77.25282288 144.31800842]
[68.47221375 156.47946167]
[59.69161224 168.64091492]
[57.20535660 177.43048096]
[50.68864059 180.91676331]
[41.72794342 192.94613647]
[32.76724625 204.97552490]
[33.85744095 217.82752991]
[26.14640808 227.66235352]
[14.19713306 229.54420471]
[5.05833101 241.43884277]
[-4.08047152 253.33348083]
[-12.95136642 265.42922974]
[-21.54993057 277.72006226]
[-30.14849472 290.01089478]
[-38.74705887 302.30172729]
[-47.34562302 314.59259033]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[42 210]
[43 209]
[44 208]
[45 207]
[46 206]
[50 205]
[51 204]
[52 203]
[54 200]
[55 199]
[56 198]
[57 196]
[58 195]
[59 194]
[61 192]
[62 191]
[63 160]
[65 158]
[66 157]
[67 156]
[68 155]
[71 152]
[72 151]
[73 138]
[74 137]
[75 136]
[76 135]
[77 134]
[78 133]
[79 131]
[80 130]
[81 129]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
