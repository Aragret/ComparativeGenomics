%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Jun 17 13:30:28 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
UUUCGGGUAUUUUUAUUUUUUAAUAUUGUUUGGGACUCUUGGUUUUACUUGCUUUUAGACAAGCGAAGUAAGUAACGGGGGUGUUAGGAUCCGGAUGGGCxxxxxxxxxxGAGGGUAAGGCUAUUUUAGUGGAAGGUGGGAAUGAUGUGUUAGUUUCUGCGGGAGCCGAAUGAAGAGAAGGAAGAGAGGAAUUACUGUAAUUGUGAUAAG\
) } def
/len { sequence length } bind def

/coor [
[47.83156586 712.94360352]
[33.62800217 717.80944824]
[18.99362373 721.16394043]
[4.08876848 722.97033691]
[-10.92325401 723.20886230]
[-25.87796593 721.87683105]
[-40.61151505 718.98883057]
[-54.96247101 714.57659912]
[-68.77359772 708.68847656]
[-81.89357758 701.38885498]
[-94.17864990 692.75787354]
[-105.49422455 682.88995361]
[-115.71631622 671.89331055]
[-124.73292542 659.88836670]
[-132.44526672 647.00665283]
[-138.76882935 633.38940430]
[-143.63432312 619.18572998]
[-146.98846436 604.55126953]
[-148.79449463 589.64636230]
[-149.03260803 574.63433838]
[-147.70022583 559.67962646]
[-144.81192017 544.94616699]
[-140.39933777 530.59533691]
[-134.51083374 516.78436279]
[-127.21093750 503.66455078]
[-118.57961273 491.37966919]
[-108.71143341 480.06433105]
[-97.71452332 469.84252930]
[-85.70936584 460.82620239]
[-72.82750702 453.11416626]
[-59.21007538 446.79095459]
[-45.00627518 441.92578125]
[-30.37173271 438.57199097]
[-15.46679020 436.76632690]
[-0.45475566 436.52856445]
[14.49989128 437.86132812]
[17.38516426 423.14144897]
[20.27043724 408.42153931]
[23.15571022 393.70166016]
[26.04098129 378.98178101]
[24.59082222 376.58276367]
[24.00355911 373.46481323]
[24.55780029 369.95364380]
[26.40917969 366.46984863]
[29.56107330 363.48327637]
[33.31737518 348.96121216]
[29.01376915 334.70190430]
[39.96037674 323.27902222]
[43.71667862 308.75695801]
[47.47298050 294.23489380]
[41.87947083 277.60119629]
[54.89549255 264.57565308]
[58.43516541 249.99929810]
[61.97483826 235.42291260]
[47.85491943 227.52976990]
[36.51265335 215.97647095]
[28.86794662 201.68884277]
[25.54396057 185.81491089]
[26.81632805 169.63267517]
[32.59030533 154.44721985]
[42.40777969 141.48542786]
[55.48361969 131.79689026]
[70.76844025 126.16893768]
[87.03283691 125.06258392]
[90.13694763 110.38728333]
[85.98612213 97.03578949]
[95.18775177 86.50860596]
[98.29186249 71.83330536]
[93.57785797 56.73069763]
[103.78146362 45.88008881]
[106.88557434 31.20478630]
[102.17157745 16.10217667]
[112.37518311 5.25156832]
[115.47929382 -9.42373371]
[118.58340454 -24.09903717]
[121.68751526 -38.77433777]
[124.79162598 -53.44964218]
[110.24300385 -60.06293106]
[97.52466583 -69.72868347]
[87.26588440 -81.96490479]
[79.97341919 -96.16253662]
[76.00646210 -111.61572266]
[75.55895996 -127.55694580]
[78.65014648 -143.19512939]
[85.12370300 -157.75488281]
[94.65570068 -170.51498413]
[106.77076721 -180.84405518]
[120.86582947 -188.23184204]
[136.24011230 -192.31439209]
[152.12997437 -192.89204407]
[154.79577637 -207.65325928]
[157.46156311 -222.41447449]
[160.12736511 -237.17570496]
[162.35247803 -252.00973511]
[164.13494873 -266.90347290]
[165.91741943 -281.79718018]
[167.69987488 -296.69088745]
[169.48234558 -311.58462524]
[163.43975830 -326.20642090]
[172.63462830 -337.92410278]
[158.89689636 -344.25888062]
[147.79045105 -354.53033447]
[140.40342712 -367.73211670]
[137.45950317 -382.57086182]
[139.24711609 -397.59283447]
[145.59111023 -411.32632446]
[155.86997986 -422.42587280]
[169.07672119 -429.80404663]
[183.91743469 -432.73803711]
[198.93820190 -430.94033813]
[212.66744995 -424.58715820]
[223.76010132 -414.30084229]
[231.12944031 -401.08917236]
[234.05346680 -386.24649048]
[232.24572754 -371.22692871]
[225.88333130 -357.50195312]
[215.58958435 -346.41619873]
[202.37298584 -339.05572510]
[187.52835083 -336.14163208]
[193.69842529 -322.58511353]
[184.37606812 -309.80215454]
[182.59359741 -294.90841675]
[180.81112671 -280.01470947]
[179.02867126 -265.12100220]
[177.24620056 -250.22727966]
[178.87077332 -247.94277954]
[179.68830872 -244.87712097]
[179.39675903 -241.33447266]
[177.80961609 -237.72261047]
[174.88858032 -234.50990295]
[172.22279358 -219.74868774]
[169.55699158 -204.98747253]
[166.89118958 -190.22625732]
[179.95242310 -184.99708557]
[191.73857117 -177.30476379]
[201.79064941 -167.44645691]
[209.71670532 -155.80371094]
[215.20712280 -142.82771301]
[218.04675293 -129.02178955]
[218.12327576 -114.92189789]
[215.43168640 -101.07582855]
[210.07458496 -88.02188873]
[202.25820923 -76.26799774]
[192.28454590 -66.27191925]
[180.53964233 -58.42344284]
[167.47865295 -53.02916336]
[153.60826111 -50.30052567]
[139.46693420 -50.34553146]
[136.36282349 -35.67022705]
[133.25871277 -20.99492645]
[130.15460205 -6.31962395]
[127.05048370 8.35567856]
[131.98651123 22.40861130]
[121.56088257 34.30889511]
[118.45677185 48.98419952]
[123.39279175 63.03713226]
[112.96716309 74.93741608]
[109.86305237 89.61271667]
[114.01387787 102.96421051]
[104.81224823 113.49139404]
[101.70813751 128.16668701]
[114.12636566 134.37347412]
[124.68447113 143.37280273]
[132.76840210 154.63497925]
[137.90946960 167.49894714]
[139.81156921 181.21096802]
[138.36825562 194.96888733]
[133.66857910 207.96899414]
[125.99177551 219.45298767]
[115.79049683 228.75224304]
[103.66427612 235.32669067]
[90.32418823 238.79620361]
[76.55121613 238.96258545]
[73.01154327 253.53897095]
[69.47187042 268.11532593]
[75.50368500 279.51620483]
[72.25539398 291.58404541]
[61.99503708 297.99118042]
[58.23873901 312.51324463]
[54.48243713 327.03530884]
[58.51736450 342.33334351]
[47.83943176 352.71752930]
[44.08313370 367.23959351]
[40.76087189 381.86703491]
[37.87559891 396.58694458]
[34.99032974 411.30682373]
[32.10505676 426.02670288]
[29.21978378 440.74661255]
[43.57095337 445.15814209]
[57.38236618 451.04562378]
[70.50270081 458.34457397]
[82.78819275 466.97500610]
[94.10424805 476.84234619]
[104.32687378 487.83853149]
[113.34406281 499.84301758]
[121.05702209 512.72430420]
[127.38124847 526.34130859]
[132.24745178 540.54473877]
[135.60229492 555.17901611]
[137.40904236 570.08386230]
[137.64788818 585.09588623]
[136.31622314 600.05059814]
[133.42863464 614.78424072]
[129.01675415 629.13531494]
[123.12892914 642.94653320]
[115.82966614 656.06671143]
[107.19893646 668.35198975]
[97.33130646 679.66778564]
[86.33489227 689.89019775]
[74.33017731 698.90704346]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[36 188]
[37 187]
[38 186]
[39 185]
[40 184]
[45 183]
[46 182]
[48 180]
[49 179]
[50 178]
[52 175]
[53 174]
[54 173]
[64 161]
[65 160]
[67 158]
[68 157]
[70 155]
[71 154]
[73 152]
[74 151]
[75 150]
[76 149]
[77 148]
[90 133]
[91 132]
[92 131]
[93 130]
[94 125]
[95 124]
[96 123]
[97 122]
[98 121]
[100 119]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
