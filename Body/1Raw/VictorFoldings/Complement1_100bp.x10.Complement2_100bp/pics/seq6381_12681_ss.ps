%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Jun 17 13:35:16 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
CCCGGUAGUUAAAGUAGUGUUGUUAAUAGUUAUAUUUUGGGGGACGGUAUUGGGUUAUGGUUUGCGGGGAGAAGCAGACUAGGCAGGAUUAGUGUCGUCAxxxxxxxxxxGUCAAGAAGUUUAUAGAUGAGUAGAAGGAUUAAUGGUAUGAUUAGAAUCAAUGGCGAUUGUUGGAUAAGGUUGACAAGUAGCCGACUCUCCCGCAUCCUU\
) } def
/len { sequence length } bind def

/coor [
[-85.65097046 355.76113892]
[-82.10608673 370.34921265]
[-80.03133392 385.21777344]
[-79.44734955 400.21902466]
[-80.35992432 415.20388794]
[-82.75999451 430.02340698]
[-86.62371063 444.53030396]
[-91.91265869 458.58041382]
[-98.57428741 472.03408813]
[-106.54238129 484.75762939]
[-115.73774719 496.62454224]
[-126.06900024 507.51690674]
[-137.43345642 517.32647705]
[-149.71817017 525.95574951]
[-162.80105591 533.31896973]
[-176.55206299 539.34295654]
[-190.83454895 543.96783447]
[-205.50654602 547.14758301]
[-220.42225647 548.85070801]
[-235.43339539 549.06018066]
[-250.39082336 547.77398682]
[-265.14584351 545.00488281]
[-279.55181885 540.78039551]
[-293.46557617 535.14251709]
[-306.74884033 528.14727783]
[-319.26959229 519.86419678]
[-330.90338135 510.37557983]
[-341.53457642 499.77575684]
[-351.05752563 488.17007446]
[-359.37759399 475.67385864]
[-366.41207886 462.41131592]
[-372.09103394 448.51428223]
[-376.35809326 434.12084961]
[-379.17077637 419.37408447]
[-380.50119019 404.42053223]
[-380.33605957 389.40881348]
[-378.67703247 374.48815918]
[-375.54064941 359.80682373]
[-370.95800781 345.51071167]
[-364.97470093 331.74197388]
[-357.65017700 318.63739014]
[-349.05725098 306.32720947]
[-339.28131104 294.93380737]
[-328.41952515 284.57040405]
[-316.57983398 275.34002686]
[-303.87991333 267.33435059]
[-290.44598389 260.63299561]
[-276.41156006 255.30253601]
[-261.91613770 251.39596558]
[-247.10379028 248.95210266]
[-232.12168884 247.99523926]
[-217.11878967 248.53489685]
[-202.24415588 250.56568909]
[-187.64566040 254.06744385]
[-173.46836853 259.00537109]
[-159.85317993 265.33035278]
[-146.93544006 272.97958374]
[-134.84352112 281.87698364]
[-123.69760132 291.93417358]
[-112.59036255 281.85305786]
[-111.69224548 269.78988647]
[-102.52113342 261.30020142]
[-89.62300873 261.33547974]
[-78.36691284 251.42083740]
[-67.11081696 241.50617981]
[-55.85472488 231.59152222]
[-44.59862900 221.67687988]
[-33.34253311 211.76222229]
[-22.16055679 201.76405334]
[-11.05332375 191.68292236]
[0.05390980 181.60177612]
[0.14889219 164.78424072]
[12.62331486 153.00698853]
[30.09324646 153.91296387]
[41.04915619 143.66757202]
[41.76757050 131.59237671]
[50.81127167 122.96710968]
[63.70848846 122.81034088]
[74.81571960 112.72920227]
[85.92295837 102.64806366]
[90.37322235 89.39337158]
[103.99590302 86.24470520]
[109.01463318 71.24060822]
[123.63900757 68.41625214]
[134.74624634 58.33510971]
[145.85346985 48.25397110]
[146.77539062 32.70444107]
[158.18331909 22.63896179]
[173.00172424 23.61369133]
[184.10896301 13.53255367]
[195.21620178 3.45141459]
[200.23492432 -11.55268192]
[214.85929871 -14.37704182]
[225.58367920 -24.86454201]
[235.91035461 -35.74387741]
[246.23701477 -46.62321091]
[256.56369019 -57.50254440]
[266.89035034 -68.38188171]
[277.21701050 -79.26121521]
[287.54370117 -90.14054871]
[277.73791504 -101.50828552]
[269.11276245 -113.79589081]
[261.75390625 -126.88123322]
[255.73454285 -140.63426208]
[251.11447144 -154.91828918]
[247.93959045 -169.59135437]
[246.24148560 -184.50761414]
[246.03700256 -199.51884460]
[247.32820129 -214.47583008]
[250.10223389 -229.22991943]
[254.33154297 -243.63449097]
[259.97409058 -257.54635620]
[266.97378540 -270.82730103]
[275.26104736 -283.34527588]
[284.75357056 -294.97586060]
[295.35693359 -305.60351562]
[306.96582031 -315.12258911]
[319.46481323 -323.43847656]
[332.72967529 -330.46850586]
[346.62863159 -336.14285278]
[361.02349854 -340.40505981]
[375.77120972 -343.21282959]
[390.72518921 -344.53823853]
[405.73684692 -344.36807251]
[420.65695190 -342.70407104]
[435.33724976 -339.56274414]
[449.63180542 -334.97534180]
[463.39855957 -328.98742676]
[476.50067139 -321.65853882]
[488.80798340 -313.06149292]
[500.19808960 -303.28173828]
[510.55786133 -292.41647339]
[519.78430176 -280.57369995]
[527.78570557 -267.87109375]
[534.48260498 -254.43493652]
[539.80834961 -240.39874268]
[543.71008301 -225.90200806]
[546.14898682 -211.08882141]
[547.10083008 -196.10641479]
[546.55615234 -181.10368347]
[544.52038574 -166.22973633]
[541.01373291 -151.63241577]
[536.07110596 -137.45677185]
[529.74151611 -123.84371185]
[522.08801270 -110.92852783]
[513.18652344 -98.83958435]
[503.12561035 -87.69702148]
[492.00524902 -77.61159515]
[479.93594360 -68.68352509]
[467.03762817 -61.00155640]
[453.43856812 -54.64203644]
[439.27383423 -49.66816711]
[424.68426514 -46.12938309]
[409.81484985 -44.06085587]
[394.81335449 -43.48314285]
[379.82888794 -44.40198898]
[365.01034546 -46.80826187]
[350.50506592 -50.67804337]
[336.45718384 -55.97287369]
[323.00628662 -62.64012909]
[310.28610229 -70.61354828]
[298.42303467 -79.81388092]
[288.09634399 -68.93454742]
[277.76968384 -58.05521011]
[267.44302368 -47.17587662]
[257.11636353 -36.29654312]
[246.78968811 -25.41720963]
[236.46301270 -14.53787422]
[251.29710388 -12.31304932]
[258.93838501 0.59472281]
[253.75402832 14.67031384]
[239.56570435 19.53772163]
[226.83255005 11.60887337]
[224.94044495 -3.26980805]
[220.71617126 11.01321793]
[205.29733276 14.55864811]
[194.19010925 24.63978767]
[183.08287048 34.72092438]
[182.62117004 49.56418610]
[171.50045776 59.94612122]
[155.93461609 59.36120605]
[144.82737732 69.44234467]
[133.72013855 79.52348328]
[129.49588013 93.80651093]
[114.07704163 97.35193634]
[109.62677765 110.60662842]
[96.00409698 113.75529480]
[84.89685822 123.83643341]
[73.78962708 133.91757202]
[68.57736969 151.57865906]
[51.29454803 154.62348938]
[40.33863831 164.86888123]
[41.44010544 178.29278564]
[34.70734406 189.73307800]
[22.79141235 195.12684631]
[10.13504887 192.70901489]
[-0.97218513 202.79014587]
[-12.07941914 212.87129211]
[-16.33077431 220.95606995]
[-23.42788124 223.01832581]
[-34.68397522 232.93296814]
[-45.94007111 242.84762573]
[-57.19616699 252.76228333]
[-68.45226288 262.67694092]
[-79.70835876 272.59158325]
[-85.18298340 290.17309570]
[-102.50922394 292.96026611]
[-113.61646271 303.04141235]
[-104.68334198 315.10699463]
[-96.99597931 328.00207520]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[59 208]
[60 207]
[63 205]
[64 204]
[65 203]
[66 202]
[67 201]
[68 200]
[69 198]
[70 197]
[71 196]
[74 192]
[75 191]
[78 189]
[79 188]
[80 187]
[82 185]
[84 183]
[85 182]
[86 181]
[89 178]
[90 177]
[91 176]
[93 174]
[94 168]
[95 167]
[96 166]
[97 165]
[98 164]
[99 163]
[100 162]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
