%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Jun 17 13:36:15 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
AGUUCGGUUGGGGUACCGGAGGUACUGAAAAAGUUUUUCCAUAAUCUUUUUGGUAAAGUAUUGAAACAGUUUCAAUUUAAUAUCCGAUUUAGGAUAUAUAxxxxxxxxxxGGGGGAGAUGGAUUUUGAGUGUCGGGAGCGACAGUGAAAGGAUCCUGAAGAUUGUCGGGAUCUGGAGUUGAUGGAUUGGUUGUUUGAAUUUUAUUUUAGG\
) } def
/len { sequence length } bind def

/coor [
[204.28038025 232.49629211]
[211.34405518 219.25094604]
[219.61701965 206.72526550]
[207.92942810 197.32312012]
[196.24185181 187.92097473]
[184.55427551 178.51881409]
[172.49838257 179.50987244]
[162.68432617 171.77244568]
[160.71093750 159.02612305]
[149.16462708 149.45100403]
[131.73121643 147.44026184]
[125.47699738 130.12074280]
[110.71044159 128.17184448]
[104.80754852 113.49306488]
[91.02160645 111.16082001]
[85.79029846 98.19451141]
[74.10271454 88.79236603]
[62.41513443 79.39021301]
[50.72755432 69.98806000]
[45.56906891 69.18987274]
[41.62679672 66.73797607]
[39.32699203 63.37257385]
[38.74035645 59.89576340]
[27.48425865 49.98111343]
[16.22816277 40.06646347]
[4.97206736 30.15181160]
[-10.49784565 26.83633804]
[-14.93429565 12.61778736]
[-26.19039154 2.70313644]
[-37.44648743 -7.21151495]
[-48.70258331 -17.12616539]
[-48.83745956 -2.12677240]
[-59.44192505 8.48196316]
[-74.44126129 8.62287617]
[-85.24317169 -1.78475618]
[-85.65982819 -16.77896881]
[-75.45254517 -27.77039528]
[-60.46942139 -28.46296692]
[-70.79608917 -39.34230042]
[-81.12275696 -50.22163391]
[-91.44943237 -61.10097122]
[-101.77610016 -71.98030090]
[-113.46730042 -62.56922150]
[-125.88670349 -54.14239883]
[-138.95164490 -46.75592422]
[-152.57519531 -40.45894623]
[-166.66667175 -35.29337692]
[-181.13229370 -31.29359055]
[-195.87582397 -28.48620415]
[-210.79910278 -26.88990211]
[-225.80285645 -26.51530647]
[-240.78721619 -27.36491203]
[-255.65246582 -29.43306351]
[-270.29968262 -32.70599747]
[-284.63134766 -37.16193390]
[-298.55215454 -42.77121735]
[-311.96942139 -49.49651718]
[-324.79388428 -57.29307938]
[-336.94015503 -66.10901642]
[-348.32742310 -75.88566589]
[-358.87991333 -86.55795288]
[-368.52740479 -98.05486298]
[-377.20565796 -110.29988098]
[-384.85696411 -123.21152496]
[-391.43038940 -136.70385742]
[-396.88217163 -150.68708801]
[-401.17602539 -165.06817627]
[-404.28341675 -179.75138855]
[-406.18362427 -194.63903809]
[-406.86401367 -209.63203430]
[-406.32009888 -224.63059998]
[-404.55541992 -239.53491211]
[-401.58178711 -254.24580383]
[-397.41897583 -268.66537476]
[-392.09466553 -282.69763184]
[-385.64428711 -296.24923706]
[-378.11080933 -309.22994995]
[-369.54431152 -321.55343628]
[-360.00186157 -333.13766479]
[-349.54693604 -343.90554810]
[-338.24908447 -353.78540039]
[-326.18356323 -362.71151733]
[-313.43057251 -370.62445068]
[-300.07507324 -377.47155762]
[-286.20587158 -383.20730591]
[-271.91534424 -387.79345703]
[-257.29852295 -391.19955444]
[-242.45269775 -393.40289307]
[-227.47669983 -394.38882446]
[-212.47016907 -394.15075684]
[-197.53295898 -392.69033813]
[-182.76451111 -390.01721191]
[-168.26307678 -386.14923096]
[-154.12518311 -381.11212158]
[-140.44490051 -374.93936157]
[-127.31327820 -367.67208862]
[-114.81771088 -359.35864258]
[-103.04134369 -350.05432129]
[-92.06256104 -339.82110596]
[-81.95442200 -328.72702026]
[-72.78418732 -316.84597778]
[-64.61289215 -304.25698853]
[-57.49491882 -291.04382324]
[-51.47762680 -277.29446411]
[-46.60106659 -263.10037231]
[-42.89768982 -248.55604553]
[-40.39214706 -233.75823975]
[-39.10110474 -218.80545044]
[-39.03316116 -203.79718018]
[-40.18876648 -188.83331299]
[-42.56022644 -174.01342773]
[-46.13176346 -159.43615723]
[-50.87960815 -145.19850159]
[-56.77216721 -131.39521790]
[-63.77021790 -118.11816406]
[-71.82719421 -105.45570374]
[-80.88948059 -93.49210358]
[-90.89675903 -82.30696869]
[-80.57009125 -71.42763519]
[-70.24342346 -60.54830551]
[-59.91675568 -49.66896820]
[-49.59008789 -38.78963470]
[-38.78793335 -28.38226128]
[-27.53183556 -18.46761131]
[-16.27574158 -8.55295944]
[-5.01964474 1.36169183]
[9.64515686 3.96800303]
[14.88671875 18.89571571]
[26.14281464 28.81036758]
[37.39891052 38.72501755]
[48.65500641 48.63966751]
[60.12970734 58.30047989]
[71.81728363 67.70262909]
[83.50486755 77.10478210]
[95.19245148 86.50693512]
[108.97839355 88.83917999]
[114.20970154 101.80548859]
[129.81222534 104.42688751]
[134.87915039 118.43315887]
[147.76283264 117.82199097]
[157.30387878 125.89367676]
[158.73974609 137.90470886]
[170.28605652 147.47982788]
[188.50555420 150.15025330]
[193.95642090 166.83123779]
[205.64399719 176.23338318]
[217.33158875 185.63554382]
[229.01916504 195.03768921]
[239.48184204 184.27354431]
[250.90653992 174.53646851]
[263.19284058 165.91200256]
[276.23275757 158.47595215]
[289.91171265 152.29367065]
[304.10949707 147.41947937]
[318.70132446 143.89622498]
[333.55892944 141.75486755]
[348.55178833 141.01423645]
[363.54812622 141.68081665]
[378.41616821 143.74876404]
[393.02520752 147.19990540]
[407.24688721 152.00392151]
[420.95620728 158.11856079]
[434.03268433 165.49011230]
[446.36141968 174.05380249]
[457.83407593 183.73434448]
[468.34979248 194.44668579]
[477.81616211 206.09666443]
[486.15002441 218.58190918]
[493.27810669 231.79269409]
[499.13778687 245.61293030]
[503.67755127 259.92114258]
[506.85748291 274.59161377]
[508.64968872 289.49536133]
[509.03839111 304.50149536]
[508.02017212 319.47805786]
[505.60400391 334.29345703]
[501.81106567 348.81753540]
[496.67474365 362.92257690]
[490.24014282 376.48468018]
[482.56384277 389.38464355]
[473.71328735 401.50906372]
[463.76626587 412.75146484]
[452.81018066 423.01296997]
[440.94131470 432.20343018]
[428.26397705 440.24209595]
[414.88961792 447.05828857]
[400.93569946 452.59210205]
[386.52493286 456.79495239]
[371.78390503 459.62985229]
[356.84219360 461.07189941]
[341.83108521 461.10845947]
[326.88253784 459.73916626]
[312.12786865 456.97607422]
[297.69680786 452.84344482]
[283.71612549 447.37762451]
[270.30871582 440.62664795]
[257.59240723 432.64981079]
[245.67892456 423.51724243]
[234.67300415 413.30920410]
[224.67135620 402.11538696]
[215.76185608 390.03417969]
[208.02282715 377.17178345]
[201.52227783 363.64117432]
[196.31733704 349.56127930]
[192.45373535 335.05587769]
[189.96543884 320.25238037]
[188.87431335 305.28094482]
[189.18994141 290.27313232]
[190.90954590 275.36080933]
[194.01803589 260.67504883]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[3 148]
[4 147]
[5 146]
[6 145]
[9 143]
[10 142]
[12 139]
[14 137]
[16 135]
[17 134]
[18 133]
[19 132]
[23 131]
[24 130]
[25 129]
[26 128]
[28 126]
[29 125]
[30 124]
[31 123]
[38 122]
[39 121]
[40 120]
[41 119]
[42 118]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
