%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Jun 17 13:32:43 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
CAAAGGGGCGUAUUUGUUGUAUUCGAAGACUGAGAAUGGAGGGAGAGAGGAUGAGGACGAGCGUAGACGAUAUCACCUCCGGCCUCGUCCUUGUCCAACUxxxxxxxxxxAUAGCGACAAGUAAUAUCGAUGAGAGUAUUGGGAGUUGUGGGUGAGGGAGAAUCGGUUAUAACACGGAUAACGGUAUGAUCAGAAACGGCGGACGCUUCG\
) } def
/len { sequence length } bind def

/coor [
[-33.76537323 281.16519165]
[-27.80817986 294.94668579]
[-23.32420158 309.27539062]
[-20.36256981 323.99432373]
[-18.95573044 338.94216919]
[-19.11910057 353.95520020]
[-20.85088730 368.86889648]
[-24.13211823 383.51989746]
[-28.92684174 397.74761963]
[-35.18252563 411.39620972]
[-42.83062363 424.31613159]
[-51.78734589 436.36581421]
[-61.95455551 447.41323853]
[-73.22085571 457.33737183]
[-85.46279907 466.02944946]
[-98.54627228 473.39425659]
[-112.32791138 479.35113525]
[-126.65671539 483.83474731]
[-141.37570190 486.79602051]
[-156.32359314 488.20251465]
[-171.33662415 488.03875732]
[-186.25028992 486.30661011]
[-200.90118408 483.02502441]
[-215.12879944 478.22998047]
[-228.77725220 471.97393799]
[-241.69697571 464.32553101]
[-253.74644470 455.36853027]
[-264.79360962 445.20104980]
[-274.71746826 433.93450928]
[-283.40927124 421.69235229]
[-290.77377319 408.60870361]
[-296.73028564 394.82690430]
[-301.21356201 380.49798584]
[-304.17449951 365.77893066]
[-305.58059692 350.83102417]
[-305.41650391 335.81799316]
[-303.68399048 320.90435791]
[-300.40203857 306.25354004]
[-295.60662842 292.02606201]
[-289.35028076 278.37774658]
[-281.70156860 265.45822144]
[-272.74426270 253.40896606]
[-262.57650757 242.36204529]
[-251.30972290 232.43846130]
[-239.06735229 223.74696350]
[-225.98352051 216.38278198]
[-212.20159912 210.42658997]
[-197.87257385 205.94366455]
[-183.15344238 202.98309326]
[-168.20547485 201.57734680]
[-153.19245911 201.74182129]
[-138.27888489 203.47468567]
[-123.62814331 206.75698853]
[-109.40075684 211.55274963]
[-95.75261688 217.80941772]
[-82.83325958 225.45846558]
[-70.78423309 234.41606140]
[-59.73754883 244.58407593]
[-48.48145294 234.66943359]
[-37.22535706 224.75477600]
[-26.04338264 214.75660706]
[-14.93614864 204.67546082]
[-3.82891464 194.59432983]
[7.27831888 184.51318359]
[11.72665215 167.53735352]
[29.75490570 163.78720093]
[33.76605225 149.44287109]
[49.13039017 145.66825867]
[60.08629990 135.42288208]
[70.33169556 124.46696472]
[79.82058716 112.84970093]
[89.30948639 101.23243713]
[96.08947754 87.85216522]
[99.84577942 73.33010864]
[103.60208130 58.80804825]
[107.35838318 44.28598785]
[111.11468506 29.76392746]
[114.87098694 15.24186897]
[117.86576080 0.54386461]
[120.09087372 -14.29017925]
[122.31599426 -29.12422371]
[124.32000732 -43.98974991]
[126.10247040 -58.88346863]
[127.77400970 -73.79003906]
[129.33453369 -88.70864868]
[130.89506531 -103.62725067]
[132.45558167 -118.54586029]
[134.01609802 -133.46446228]
[135.57662964 -148.38307190]
[136.35795593 -163.36270142]
[136.35795593 -178.36270142]
[136.35795593 -193.36270142]
[136.35795593 -208.36270142]
[136.35795593 -223.36270142]
[136.35795593 -238.36270142]
[121.86042786 -242.60517883]
[109.14614868 -250.76139832]
[99.24580383 -262.17016602]
[92.96195984 -275.90658569]
[90.80403137 -290.85717773]
[92.94693756 -305.80993652]
[99.21697998 -319.55267334]
[109.10586548 -330.97137451]
[121.81194305 -339.14035034]
[136.30519104 -343.39739990]
[151.41070557 -343.39739990]
[165.90396118 -339.14035034]
[178.61003113 -330.97137451]
[188.49891663 -319.55267334]
[194.76896667 -305.80993652]
[196.91186523 -290.85717773]
[194.75393677 -275.90658569]
[188.47009277 -262.17016602]
[178.56974792 -250.76139832]
[165.85546875 -242.60517883]
[151.35795593 -238.36270142]
[151.35795593 -223.36270142]
[151.35795593 -208.36270142]
[151.35795593 -193.36270142]
[151.35795593 -178.36270142]
[151.35795593 -163.36270142]
[161.90229797 -174.03118896]
[176.82510376 -175.55111694]
[189.30383301 -167.22758484]
[193.63340759 -152.86601257]
[187.83438110 -139.03230286]
[174.55799866 -132.05105591]
[159.87405396 -135.11399841]
[150.49523926 -146.82254028]
[148.93470764 -131.90394592]
[147.37419128 -116.98533630]
[145.81365967 -102.06672668]
[144.25314331 -87.14812469]
[142.69261169 -72.22952271]
[145.12318420 -65.24996948]
[140.99618530 -57.10100174]
[139.21372986 -42.20728683]
[141.40893555 -37.96581650]
[140.96299744 -32.30029297]
[137.15003967 -26.89910507]
[134.92491150 -12.06506157]
[132.69979858 2.76898170]
[144.71006775 -6.21730995]
[159.69323730 -5.50675201]
[170.79917908 4.57579708]
[172.95043945 19.42073250]
[165.16346741 32.24114990]
[150.99836731 37.17572403]
[136.93124390 31.96843910]
[129.39303589 18.99816895]
[125.63674164 33.52022934]
[121.88043976 48.04228973]
[118.12413788 62.56434631]
[114.36784363 77.08640289]
[110.61154175 91.60846710]
[120.41160583 80.25246429]
[132.27154541 71.06869507]
[145.71899414 64.42293549]
[160.21833801 60.57987976]
[175.19207764 59.69260406]
[190.04380798 61.79644394]
[204.18199158 66.80760193]
[217.04351807 74.52649689]
[228.11610413 84.64567566]
[236.95874023 96.76210022]
[243.21923828 110.39317322]
[246.64822388 124.99598694]
[247.10913086 139.98890686]
[244.58361816 154.77476501]
[239.17224121 168.76466370]
[231.09057617 181.40136719]
[220.66047668 192.18157959]
[208.29737854 200.67593384]
[194.49371338 206.54608154]
[179.79925537 209.55822754]
[164.79928589 209.59240723]
[150.09126282 206.64724731]
[136.26098633 200.84005737]
[123.85931396 192.40214539]
[113.38020325 181.66957092]
[105.24102783 169.06980896]
[99.76596832 155.10472107]
[97.17309570 140.33052063]
[97.56568146 125.33566284]
[100.92675018 110.72133636]
[91.43785095 122.33860016]
[81.94895172 133.95585632]
[96.60115051 130.74443054]
[110.70027924 135.86444092]
[119.87757874 147.72940063]
[121.28936768 162.66281128]
[114.49818420 176.03739929]
[101.60834503 183.70890808]
[86.61391449 183.30024719]
[74.16107178 174.93801880]
[68.10847473 161.21336365]
[70.33169556 146.37878418]
[59.37578201 156.62417603]
[54.58099747 171.70132446]
[40.00029755 174.74311829]
[38.78908157 187.58428955]
[29.45295715 195.89215088]
[17.35945702 195.62042236]
[6.25222397 205.70156860]
[-4.85500956 215.78269958]
[-15.96224308 225.86384583]
[-20.21359825 233.94862366]
[-27.31070518 236.01087952]
[-38.56680298 245.92552185]
[-49.82289886 255.84017944]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[58 210]
[59 209]
[60 208]
[61 206]
[62 205]
[63 204]
[64 203]
[66 200]
[68 198]
[69 197]
[70 187]
[71 186]
[72 185]
[73 155]
[74 154]
[75 153]
[76 152]
[77 151]
[78 150]
[79 142]
[80 141]
[81 140]
[82 137]
[83 136]
[84 134]
[85 133]
[86 132]
[87 131]
[88 130]
[89 129]
[90 121]
[91 120]
[92 119]
[93 118]
[94 117]
[95 116]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
