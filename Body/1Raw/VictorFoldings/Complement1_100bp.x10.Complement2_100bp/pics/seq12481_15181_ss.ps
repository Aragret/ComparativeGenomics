%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Jun 17 13:34:28 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
AGGGGUGUUGUUAUAAGUACACGGAUCUGGUUCUUCAAUAAUAGAGCUUGACUGUGACUCGGUGUUGGGUUUGUUGGGUCGAGAGGGAUUCGAAGUUUGAxxxxxxxxxxUAAUGUUUGAAUGAUAGGCGGUAGGGUAUGUAACCCUGUCUGGAUCAAGUUACUUAGACUCCUCCGAUGAGUCAUCUGUCAGGGUGGGAGUGUGCUAAGA\
) } def
/len { sequence length } bind def

/coor [
[57.17246628 543.11474609]
[47.67274857 554.73999023]
[37.04564667 565.34448242]
[25.40021896 574.81945801]
[12.85595989 583.06768799]
[-0.45840314 590.00445557]
[-14.40624332 595.55859375]
[-28.84443474 599.67315674]
[-43.62481308 602.30590820]
[-58.59571457 603.42980957]
[-73.60350800 603.03338623]
[-88.49418640 601.12060547]
[-103.11495209 597.71118164]
[-117.31577301 592.84008789]
[-130.95092773 586.55725098]
[-143.88047791 578.92724609]
[-155.97177124 570.02825928]
[-167.10070801 559.95166016]
[-177.15310669 548.80090332]
[-186.02581787 536.69030762]
[-193.62776184 523.74420166]
[-199.88095093 510.09542847]
[-204.72122192 495.88406372]
[-208.09889221 481.25595093]
[-209.97930908 466.36114502]
[-210.34318542 451.35250854]
[-209.18676758 436.38409424]
[-206.52192688 421.60946655]
[-202.37602234 407.18023682]
[-196.79158020 393.24450684]
[-189.82592773 379.94522095]
[-181.55052185 367.41891479]
[-172.05029297 355.79406738]
[-161.42272949 345.19003296]
[-149.77688599 335.71557617]
[-137.23225403 327.46795654]
[-123.91758728 320.53176880]
[-109.96950531 314.97821045]
[-95.53113556 310.86428833]
[-80.75063324 308.23217773]
[-65.77968597 307.10891724]
[-50.77191162 307.50604248]
[-35.88131714 309.41943359]
[-21.26069832 312.82952881]
[-7.06009388 317.70126343]
[-8.76102829 302.90408325]
[4.04139519 293.60845947]
[10.31875610 279.98513794]
[16.59611702 266.36184692]
[22.87347794 252.73852539]
[29.15083885 239.11520386]
[35.42819977 225.49188232]
[33.72726440 210.69471741]
[46.52968597 201.39910889]
[52.70545578 187.72943115]
[58.77928925 174.01416016]
[64.85312653 160.29890442]
[70.92695618 146.58363342]
[77.00079346 132.86836243]
[83.07462311 119.15309906]
[89.14846039 105.43783569]
[77.29243469 114.62666321]
[63.11658478 119.53026581]
[48.11692429 119.63114929]
[33.87640381 114.91866302]
[21.89785385 105.89013672]
[13.44540405 93.49835968]
[9.41106129 79.05107117]
[10.22057819 64.07292938]
[15.78852463 50.14461517]
[25.52730179 38.73601532]
[38.40915680 31.05110168]
[53.07463074 27.90088654]
[67.97604370 29.61781883]
[81.54081726 36.02070618]
[92.33742523 46.43383789]
[99.22647095 59.75828552]
[101.48094940 74.58789825]
[98.86286926 89.35784149]
[108.17774963 77.60059357]
[117.49263000 65.84333801]
[120.36888123 57.17356491]
[127.03477478 53.98174286]
[136.52366638 42.36448288]
[146.01257324 30.74721718]
[155.50146484 19.12995529]
[164.99037170 7.51269102]
[164.47512817 -5.37518454]
[172.61761475 -14.85588169]
[184.63900757 -16.20229530]
[194.29981995 -27.67699623]
[197.26899719 -43.21709061]
[211.38491821 -47.96995926]
[221.04573059 -59.44466019]
[230.70654297 -70.91935730]
[240.36735535 -82.39405823]
[249.76950073 -94.08164215]
[258.90829468 -105.97627258]
[268.04711914 -117.87091064]
[277.18591309 -129.76553345]
[266.37716675 -140.18913269]
[256.80349731 -151.75740051]
[248.58529663 -164.32485962]
[241.82589722 -177.73345947]
[236.61030579 -191.81457520]
[233.00413513 -206.39111328]
[231.05271912 -221.27976990]
[230.78062439 -236.29328918]
[232.19123840 -251.24287415]
[235.26683044 -265.94052124]
[239.96873474 -280.20138550]
[246.23782349 -293.84609985]
[253.99522400 -306.70312500]
[263.14343262 -318.61068726]
[273.56732178 -329.41912842]
[285.13589478 -338.99246216]
[297.70358276 -347.21029663]
[311.11239624 -353.96929932]
[325.19366455 -359.18444824]
[339.77029419 -362.79019165]
[354.65902710 -364.74114990]
[369.67254639 -365.01281738]
[384.62210083 -363.60174561]
[399.31964111 -360.52569580]
[413.58038330 -355.82336426]
[427.22491455 -349.55389404]
[440.08169556 -341.79608154]
[451.98898315 -332.64755249]
[462.79711914 -322.22329712]
[472.37008667 -310.65447998]
[480.58755493 -298.08651733]
[487.34616089 -284.67752075]
[492.56088257 -270.59609985]
[496.16619873 -256.01934814]
[498.11669922 -241.13056946]
[498.38790894 -226.11701965]
[496.97640991 -211.16752625]
[493.89993286 -196.47006226]
[489.19717407 -182.20948792]
[482.92727661 -168.56512451]
[475.16909790 -155.70858765]
[466.02020264 -143.80154419]
[455.59564209 -132.99375916]
[444.02651978 -123.42111969]
[431.45831299 -115.20403290]
[418.04910278 -108.44583130]
[403.96752930 -103.23151398]
[389.39065552 -99.62664795]
[374.50183105 -97.67657471]
[359.48828125 -97.40580750]
[344.53881836 -98.81776428]
[329.84146118 -101.89468384]
[315.58102417 -106.59786987]
[301.93685913 -112.86817169]
[289.08053589 -120.62673950]
[279.94174194 -108.73210907]
[270.80294800 -96.83747101]
[261.66415405 -84.94284058]
[261.75723267 -81.41811371]
[260.14770508 -77.67318726]
[256.75067139 -74.50877380]
[251.84205627 -72.73325348]
[242.18124390 -61.25854874]
[232.52043152 -49.78385162]
[222.85961914 -38.30915070]
[220.58145142 -23.58980179]
[205.77452087 -18.01618576]
[196.11370850 -6.54148531]
[193.97323608 10.87647438]
[176.60763550 17.00158882]
[167.11872864 28.61885262]
[157.62983704 40.23611450]
[148.14093018 51.85337830]
[138.65203857 63.47064209]
[129.24987793 75.15822601]
[119.93499756 86.91547394]
[110.62011719 98.67272949]
[102.86372375 111.51166534]
[96.78989410 125.22693634]
[90.71605682 138.94219971]
[84.64222717 152.65747070]
[78.56838989 166.37272644]
[72.49456024 180.08799744]
[66.42072296 193.80326843]
[65.80720520 202.91706848]
[60.15300369 207.67646790]
[61.40493774 223.44805908]
[49.05151367 231.76924133]
[42.77415466 245.39256287]
[36.49679184 259.01586914]
[30.21943283 272.63919067]
[23.94207191 286.26251221]
[17.66471100 299.88583374]
[18.91664696 315.65740967]
[6.56322241 323.97860718]
[19.49311638 331.60809326]
[31.58479881 340.50653076]
[42.71418762 350.58261108]
[52.76707458 361.73297119]
[61.64030838 373.84317017]
[69.24282837 386.78894043]
[75.49662018 400.43740845]
[80.33751678 414.64855957]
[83.71582794 429.27655029]
[85.59690094 444.17126465]
[85.96143341 459.17987061]
[84.80567169 474.14834595]
[82.14148712 488.92309570]
[77.99621582 503.35247803]
[72.41239166 517.28851318]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[45 195]
[47 193]
[48 192]
[49 191]
[50 190]
[51 189]
[52 188]
[54 186]
[55 184]
[56 183]
[57 182]
[58 181]
[59 180]
[60 179]
[61 178]
[79 177]
[80 176]
[81 175]
[83 174]
[84 173]
[85 172]
[86 171]
[87 170]
[90 168]
[91 167]
[93 165]
[94 164]
[95 163]
[96 162]
[97 158]
[98 157]
[99 156]
[100 155]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
