%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Jun 17 13:34:45 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
UCGCCACCCGGAUCGGGAUGAUCAGAGUUAGAGGUUGUGUAUACCGGAUCUGAUGCAUGUAUUGGAUUUGGAUGAGGUUACGAUUUUGAUUAGCAGGGUUxxxxxxxxxxGGGAUGAUUUGGGGUAAUUUGCGGACCGUCGGCCUUCGGAUAAGCGUCCUAAAGAGUAAUGAUUGUUGUAAAGGGGGCGUAGGGGGAAGGUUUGUUGUUA\
) } def
/len { sequence length } bind def

/coor [
[163.81660461 283.00106812]
[176.68589783 275.13772583]
[172.28489685 260.79788208]
[167.88389587 246.45803833]
[163.48289490 232.11817932]
[158.51524353 226.64605713]
[159.12484741 217.53198242]
[154.93783569 203.12820435]
[150.75082397 188.72442627]
[144.17079163 175.24468994]
[135.39018250 163.08323669]
[126.60958099 150.92176819]
[120.14549255 147.33885193]
[117.79037476 138.51324463]
[109.19181061 126.22241211]
[97.21733093 127.64707947]
[85.76694489 123.86470795]
[76.99720001 115.58766937]
[72.55979156 104.37485504]
[73.29046631 92.33808136]
[79.05159760 81.74434662]
[70.82279205 69.20294952]
[62.59398651 56.66154480]
[48.55428314 49.36789703]
[48.04137039 34.48212814]
[39.81256104 21.94072723]
[34.25360870 35.87263489]
[19.94019508 40.35885620]
[7.42363501 32.09231567]
[5.93067026 17.16679764]
[16.56185913 6.58484030]
[31.47887611 8.14620781]
[24.20564651 -4.97248650]
[16.93241692 -18.09118080]
[9.65918732 -31.20987511]
[2.38595819 -44.32856750]
[-4.88727140 -57.44726181]
[-18.95588303 -56.09787750]
[-32.43535233 -60.20008469]
[-43.30017853 -69.10295105]
[-49.93092728 -81.43679810]
[-51.35557175 -95.32383728]
[-47.39186859 -108.66403961]
[-38.66990280 -119.45271301]
[-45.74700928 -132.67823792]
[-52.82411575 -145.90376282]
[-66.15712738 -154.42089844]
[-65.33995056 -169.29306030]
[-79.06935120 -163.23329163]
[-93.21772766 -158.22921753]
[-107.70404053 -154.30949402]
[-122.44530487 -151.49659729]
[-137.35710144 -149.80661011]
[-152.35398865 -149.24925232]
[-167.35008240 -149.82766724]
[-182.25947571 -151.53858948]
[-196.99678040 -154.37219238]
[-211.47756958 -158.31224060]
[-225.61891174 -163.33618164]
[-239.33978271 -169.41523743]
[-252.56161499 -176.51457214]
[-265.20864868 -184.59353638]
[-277.20846558 -193.60585022]
[-288.49234009 -203.49987793]
[-298.99560547 -214.21897888]
[-308.65811157 -225.70172119]
[-317.42449951 -237.88233948]
[-325.24459839 -250.69107056]
[-332.07357788 -264.05453491]
[-337.87231445 -277.89620972]
[-342.60760498 -292.13681030]
[-346.25234985 -306.69473267]
[-348.78564453 -321.48663330]
[-350.19299316 -336.42773438]
[-350.46633911 -351.43249512]
[-349.60406494 -366.41494751]
[-347.61117554 -381.28927612]
[-344.49905396 -395.97027588]
[-340.28555298 -410.37387085]
[-334.99475098 -424.41757202]
[-328.65701294 -438.02087402]
[-321.30862427 -451.10592651]
[-312.99163818 -463.59774780]
[-303.75375366 -475.42477417]
[-293.64785767 -486.51928711]
[-282.73181152 -496.81771851]
[-271.06820679 -506.26107788]
[-258.72378540 -514.79528809]
[-245.76927185 -522.37145996]
[-232.27890015 -528.94616699]
[-218.32992554 -534.48181152]
[-204.00222778 -538.94665527]
[-189.37789917 -542.31512451]
[-174.54071045 -544.56793213]
[-159.57563782 -545.69213867]
[-144.56838989 -545.68127441]
[-129.60494995 -544.53552246]
[-114.77101898 -542.26135254]
[-100.15155792 -538.87182617]
[-85.83032227 -534.38635254]
[-71.88932800 -528.83062744]
[-58.40843964 -522.23651123]
[-45.46487045 -514.64166260]
[-33.13275909 -506.08966064]
[-21.48274994 -496.62951660]
[-10.58157063 -486.31536865]
[-0.49166289 -475.20629883]
[8.72917938 -463.36596680]
[17.02813721 -450.86218262]
[24.35767746 -437.76657104]
[30.67581367 -424.15411377]
[35.94635773 -410.10284424]
[40.13912201 -395.69317627]
[43.23008347 -381.00769043]
[45.20154190 -366.13052368]
[46.04220581 -351.14682007]
[45.74726105 -336.14248657]
[44.31838989 -321.20343018]
[41.76378632 -306.41519165]
[38.09807587 -291.86254883]
[33.34225845 -277.62878418]
[27.52357292 -263.79550171]
[20.67535210 -250.44186401]
[12.83682060 -237.64440918]
[4.05287790 -225.47644043]
[-5.62616205 -214.00762939]
[-16.14485741 -203.30368042]
[-27.44295883 -193.42591858]
[-39.45574951 -184.43090820]
[-52.11442184 -176.37017822]
[-39.28761292 -168.79902649]
[-39.59858704 -152.98088074]
[-32.52148438 -139.75534058]
[-25.44437790 -126.52982330]
[-9.49508381 -127.51502991]
[5.34114218 -121.42404175]
[16.07477570 -109.42934418]
[20.51910019 -93.89846802]
[17.73555756 -77.92675018]
[8.23142242 -64.72048950]
[15.50465202 -51.60179901]
[22.77788162 -38.48310471]
[30.05111122 -25.36441040]
[37.32434082 -12.24571609]
[44.59756851 0.87297797]
[52.35396194 13.71191883]
[60.58276749 26.25331879]
[74.03388977 32.64992142]
[75.13538361 48.43273926]
[83.36419678 60.97414017]
[91.59300232 73.51554108]
[109.10738373 73.74814606]
[123.00279999 84.41233063]
[127.75770569 101.27052307]
[121.48265076 117.62384796]
[130.08122253 129.91468811]
[138.77104187 142.14117432]
[147.55163574 154.30262756]
[156.33224487 166.46408081]
[153.88903809 151.66439819]
[155.15220642 136.71768188]
[160.04449463 122.53792572]
[168.26676941 109.99223328]
[179.31620789 99.84777832]
[192.51713562 92.72489929]
[207.06231689 89.05915833]
[222.06230164 89.07471466]
[236.59985352 92.77062988]
[249.78598022 99.92088318]
[260.81433105 110.08824921]
[269.01055908 122.65097046]
[273.87341309 136.84085083]
[275.10556030 151.79016113]
[272.63165283 166.58473206]
[266.60296631 180.31990051]
[257.38815308 192.15574646]
[245.55068970 201.36849976]
[231.81446838 207.39479065]
[217.01945496 209.86610413]
[202.07035828 208.63133240]
[187.88133240 203.76599121]
[175.32003784 195.56758118]
[165.15460205 184.53741455]
[169.34161377 198.94119263]
[173.52862549 213.34497070]
[177.82273865 227.71719360]
[182.22373962 242.05703735]
[186.62474060 256.39688110]
[191.02574158 270.73672485]
[206.09049988 270.02691650]
[220.85832214 273.08666992]
[234.40089417 279.72366333]
[245.86692810 289.52066040]
[254.53564453 301.86181641]
[259.86212158 315.97137451]
[261.51153564 330.96237183]
[259.38018799 345.89248657]
[253.60209656 359.82318115]
[244.54043579 371.87878418]
[232.76486206 381.30142212]
[219.01556396 387.49884033]
[204.15686035 390.08142090]
[189.12277222 388.88684082]
[174.85835266 383.99017334]
[162.26028442 375.69924927]
[152.12048340 364.53524780]
[145.07635498 351.19992065]
[141.57067871 336.53155518]
[141.82385254 321.45217896]
[145.81994629 306.90975952]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[2 189]
[3 188]
[4 187]
[5 186]
[7 185]
[8 184]
[9 183]
[10 159]
[11 158]
[12 157]
[14 156]
[15 155]
[21 151]
[22 150]
[23 149]
[25 147]
[26 146]
[32 145]
[33 144]
[34 143]
[35 142]
[36 141]
[37 140]
[44 134]
[45 133]
[46 132]
[48 130]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
